(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"1SN4":function(t,e,a){"use strict";var n=a("lwsE"),r=a.n(n),i=a("II3V"),s=a("tOq/");e.a=new function t(){r()(this,t),this.submit=i.a.makeJPost("/api/air/order/submit",{successW:!1,clearCaches:["/api/air/order/queryPage"]}),this.queryPage=i.a.makeGet("/api/air/order/queryPage",{expire:s.a._2S,extra:{sidx:"create_time",sord:"desc"}}),this.getInsurance=i.a.makeGet("/api/air/order/getInsurance",{expire:s.a._20S}),this.detail=i.a.makeGet("/api/air/order/detail",{failedW:!1}),this.cancel=i.a.makePost("/api/air/order/cancel",{clearCaches:["/api/air/order/queryPage"]}),this.queryIssueBillDetail=i.a.makeGet("/api/air/order/queryIssueBillDetail"),this.queryOrderStatusNum=i.a.makeGet("/api/air/order/queryOrderStatusNum")}},"3nWA":function(t,e,a){"use strict";var n={name:"TrainChangeRegulation",props:{visible:Boolean},data:function(){return{}},computed:{show:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},created:function(){},methods:{}},r=a("KHd+"),i=Object(r.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"退票规则说明",width:"850px",visible:e.show},on:{close:function(t){return e.$emit("close")},"update:visible":function(t){e.show=t}}},[a("el-card",{staticClass:"margin-bottom"},[a("div",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[e._v("退票规则说明")]),e._v(" "),a("div",{staticClass:"font-size13"},[a("div",{staticClass:"margin-bottom-xxs"},[e._v("1.在线申请退票，不得晚于开车前35分钟,已经取票时，请持相关证件到车站办理退票。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("2.开车前15天（不含）以上退票的，不收取退票费；票面乘车站开车时间前48小时以上的按票价5%计，24小时以上、不足48小时的按票价10%计，不足24小时的按票价20%计。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("3.开车前48小时～15天期间内，改签或变更到站至距开车15天以上的其他列车，又在距开车15天前退票的，仍核收5%的退票费。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("4.上述计算的尾数以5角为单位，尾数小于2.5角的舍去、2.5角及以上且小于7.5角的计为5角、7.5角及以上的进为1元。退票费最低按2元计收。")]),e._v(" "),a("div",{staticClass:"margin-bottom"},[e._v("5.改签或变更到站后的车票乘车日期在春运期间的，退票时一律按开车时间前不足24小时标准核收退票费。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs font-bold"},[e._v("广深港跨境列车退票规则：")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("1.办理退票应不晚于票面指定的日期、车次开车前30分钟，但发站为香港西九龙站的车票应不晚于60分钟。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("2.退票费核收标准：在票面开车时间前48小时内办理退票的，按票面票价的50%计算；在票面开车时间前48小时至第14天的，按票面票价的30%计算；在票面开车时间前15天及以上的，按票面票价的5%计算。退票费按元计算，不足一元的部分舍去免收。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("3.改签后的车票不得退票。")])])]),e._v(" "),a("el-card",[a("div",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[e._v("改签规则说明")]),e._v(" "),a("div",{staticClass:"font-size13"},[a("div",{staticClass:"margin-bottom-xxs"},[e._v("1.在线改签必须不晚于原票开车前35分钟方可进行。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("2.只能对未换取纸质车票的车票进行改签。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("3.同一订单中相同日期、车次、发站、到站、席别的车票方可批量改签。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("4.批量改签时，选择的新票座位席别必须一致，并且不能是卧铺。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("5.一张车票只能办理一次改签。改签后若要退票，未换取纸质车票且在发车前35分钟以上，可在系统在线提交退票。")]),e._v(" "),a("div",{staticClass:"margin-bottom"},[e._v("6.开车前48小时（不含）以上，可改签预售期内的其他列车；开车前48小时以内，可改签从办理改签之时至票面日期当日24：00之间的其他车次，不办理票面日期次日及以后的改签。新车票票价高于原车票的，补收差额；新车票票价低于原车票的，退还差额，同样对差额部分核收退票费并执行现行退票费标准。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs font-bold"},[e._v("广深港跨境列车改签规则：")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("1.在车票预售期内，旅客仅可办理一次变更乘车日期、车次、席别的改签手续。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("2.办理改签应不晚于票面指定的日期、车次开车前30分钟，但发站为香港西九龙站的车票应不晚于60分钟。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("3.跨境高铁不办理变更到站业务。")]),e._v(" "),a("div",{staticClass:"margin-bottom-xxs"},[e._v("4.列车不办理至香港西九龙站的越站。")])])]),e._v(" "),a("div",{staticClass:"center-box"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.show=!1}}},[e._v("关 闭")])],1)],1)},[],!1,null,null,null);e.a=i.exports},AvL4:function(t,e,a){"use strict";var n=a("QXkC");a.n(n).a},GjQu:function(t,e,a){},JL01:function(t,e,a){"use strict";a.r(e);var n=a("lSNA"),v=a.n(n),r=a("o0o1"),m=a.n(r),i=a("yXPU"),p=a.n(i),f=a("1m11"),g=a("6q8y"),_=a("eyQo"),h=a("CPkA"),s=a("kz0y"),b=a("ynVR"),y=a("fyny"),o=a("oZW5"),c=a("3nWA"),x=a("hqYi"),l=a("RIqP"),d=a.n(l),u=a("zta6"),w=a("zCTp"),C=a.n(w),S=a("Pk/8"),k=a("Cd74"),O=a("xGbm");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var D={name:"TrainChangeSearchList",components:{Timetable:o.a},props:{query:{type:Object,default:function(){return{fromStation:"",toStation:"",trainDate:"",newFromStation:"",newToStation:"",newTrainDate:""}}}},setup:function(r,t){var n=t.emit,c=Object(k.e)({timer:null,loading:!1,list:[],order:{cur:"time1",order:!0},filter:{showOnlyTicket:!1,cur:"train_type",tabList:[{id:"train_type",name:"车次类型"},{id:"from_station",name:"出发车站"},{id:"to_station",name:"到达车站"},{id:"departureTime",name:"出发时间"}],query:{train_type:[],from_station:[],to_station:[],departureTime:[]},show:!1}});c.path=Object(k.a)(function(){var t=r.query.newToStation,e=r.query.newFromStation,a=u.a.getStationNameByCode(t),n=u.a.getStationNameByCode(e);return{title:"去程",aCity:r.query.aCity,dCity:r.query.dCity,aCityName:a,dCityName:n}}),c.tempList=Object(k.a)(function(){var s=Object.keys(b.a.keyMap),o=s.map(function(t){return t+"_price"});return c.list.map(function(e){var t="",a=e.run_time_minute||99;if(a<=60)t=a+"分钟";else{var n=(e.run_time+"").split(":");t="".concat(+n[0],"小时").concat(+n[1],"分钟")}var r=o.map(function(t){return+(e[t]||0)}).filter(function(t){return!!t}),i=[];return s.forEach(function(t){"--"!==e[t+"_num"]&&0<e[t+"_price"]&&i.push({key:t,name:b.a.keyMap[t],num:e[t+"_num"],price:e[t+"_price"]})}),Object.assign(e,{minPrice:Math.min.apply(Math,d()(r)),runTimeStr:t,tickets:i})}).filter(function(t){return(t.note+"").indexOf("停运")<0})}),c.filterList=Object(k.a)(function(){var i={1:[0,6],2:[6,12],3:[12,18],4:[18,24]},t=c.tempList;c.filter.showOnlyTicket&&(t=t.filter(function(t){return 0<t.tickets.filter(function(t){return 0<t.num}).length})),t=t.filter(function(a){var n=+a.start_time.split(":")[0],t=c.filter.query.departureTime,r=c.filter.query,e=r.train_type;return!(0<t.length&&!t.some(function(t){var e=i[t];return n>=e[0]&&n<=e[1]}))&&(!(0<e.length&&!e.some(function(t){return a.train_type===t}))&&["from_station","to_station"].every(function(t){var e=r[t];return!(0<e.length&&e.indexOf(a[t+"_code"])<0)}))});return({time1:function(){t=t.sort(function(t,e){var a=t.start_time>e.start_time?1:-1;return a=t.start_time===e.start_time?0:a,c.order.order?a:-a})},time2:function(){t=t.sort(function(t,e){var a=t.arrive_days+""+t.arrive_time,n=e.arrive_days+""+e.arrive_time,r=n<a?1:-1;return r=a==n?0:r,c.order.order?r:-r})},runtime:function(){t=t.sort(function(t,e){var a=t.run_time_minute-e.run_time_minute;return c.order.order?a:-a})},ticketPrice:function(){t=t.sort(function(t,e){var a=t.minPrice-e.minPrice;return c.order.order?a:-a})}}[c.order.cur]||function(){})(),t}),c.filterOptions=Object(k.a)(function(){var n={train_type:[{id:"G",name:"G-高速动车"},{id:"D",name:"D-动车组"},{id:"Z",name:"Z-直达特快"},{id:"T",name:"T-空调特快"},{id:"K",name:"K-快车"}],from_station:[],to_station:[],departureTime:[{id:1,name:"00:00-06:00"},{id:2,name:"06:00-12:00"},{id:3,name:"12:00-18:00"},{id:4,name:"18:00-24:00"}]},r={from_station:new Set,to_station:new Set};return c.list.forEach(function(a){["from_station","to_station"].forEach(function(t){var e=r[t];e.has(a["".concat(t,"_code")])||(e.add(a["".concat(t,"_code")]),n[t].push({id:a["".concat(t,"_code")],name:a["".concat(t,"_name")]||""}))})}),n}),Object(k.h)(function(){return c.filterList},p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c.loading=!0,t.next=3,Object(k.b)();case 3:c.loading=!1;case 4:case"end":return t.stop()}},t)})));var e=function(){var t=p()(m.a.mark(function t(){var e,a;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(c.loading)return t.abrupt("return");t.next=2;break;case 2:return c.loading=!0,t.prev=3,(e=Object.assign({},r.query)).trainDate=O.a.getFormatDate(r.query.trainDate,"yyyy-MM-dd hh:mm:ss"),e.newTrainDate=O.a.getShortDate(r.query.newTrainDate,"yyyy-MM-dd"),t.next=9,S.a.searchChangeTicket(e);case 9:a=t.sent,c.list=a.data||[],t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),c.list=[];case 16:return t.prev=16,t.next=19,Object(k.b)();case 19:return c.loading=!1,c.filter.query.from_station=[],c.filter.query.to_station=[],t.finish(16);case 23:case"end":return t.stop()}},t,null,[[3,13,16,23]])}));return function(){return t.apply(this,arguments)}}();return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach(function(t){v()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({lowestIcon:C.a},Object(k.g)(c),{getShortDate:O.a.getShortDate,search:function(){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}},t)}))()},onChangeOrder:function(t){c.order.cur!==t?(c.order.cur=t,c.order.order=!0):c.order.order=!c.order.order},onBook:function(e,a){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n("selectTrainSeat",{train:e,ticket:a});case 1:case"end":return t.stop()}},t)}))()}})}},j=(a("NRDl"),a("KHd+"));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var N={name:"TrainChangeDialog",components:{TrainChangeSearchList:Object(j.a)(D,function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{},[r("div",{staticClass:"margin-bottom"},n._l(n.filter.tabList,function(e){return r("div",{key:e.id,staticStyle:{"line-height":"30px",height:"30px"}},[r("span",{staticClass:"margin-right"},[n._v(n._s(e.name))]),n._v(" "),r("a",{staticClass:"margin-right",attrs:{href:"javascript: void(0)"},on:{click:function(t){n.filter.query[e.id]=[]}}},[n._v("不限")]),n._v(" "),r("el-checkbox-group",{staticClass:"inline-block",model:{value:n.filter.query[e.id],callback:function(t){n.$set(n.filter.query,e.id,t)},expression:"filter.query[item.id]"}},n._l(n.filterOptions[e.id],function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id}},[n._v(n._s(t.name))])}),1)],1)}),0),n._v(" "),r("div",{staticClass:"margin-bottom-sm  bg-white z-2"},[r("div",{staticClass:"flex text-bold text-lg align-center bg-gray padding-lr padding-tb-sm"},[r("div",[n._v(n._s(n.path.title)+"：")]),n._v(" "),r("div",[n._v(n._s(n.path.dCityName))]),n._v(" "),r("div",{staticClass:"air-arrow-right margin-lr-sm",staticStyle:{width:"2em"}}),n._v(" "),r("div",[n._v(n._s(n.path.aCityName))]),n._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!n.loading,expression:"!loading"}],staticClass:"margin-left text-df text-gray"},[n._v("("+n._s(n.list.length)+"个车次)")])]),n._v(" "),r("div",{staticClass:"padding-lr-lg padding-tb flex align-center"},[r("div",{staticClass:"w120"},[n._v("车次信息")]),n._v(" "),r("div",{staticClass:"flex-sub flex align-center",staticStyle:{width:"360px"}},[r("div",{staticClass:"margin-left-sm w140 text-right",staticStyle:{"min-width":"140px"}},[r("div",{staticClass:"margin-sm-reverse padding-sm cursor-pointer",class:{"text-blue":"time1"===n.order.cur},on:{click:function(t){return n.onChangeOrder("time1")}}},[n._v("出发站/时间\n                "),"time1"!==n.order.cur||n.order.order?r("i",{staticClass:"iconfont icon-arrow-down"}):r("i",{staticClass:"iconfont icon-arrow-up"})])]),n._v(" "),r("div",{staticClass:"flex-sub"},[r("div",{staticClass:"margin-sm-reverse padding-sm cursor-pointer text-center",class:{"text-blue":"runtime"===n.order.cur},on:{click:function(t){return n.onChangeOrder("runtime")}}},[n._v("运行时长\n                "),"runtime"!==n.order.cur||n.order.order?r("i",{staticClass:"iconfont icon-arrow-down"}):r("i",{staticClass:"iconfont icon-arrow-up"})])]),n._v(" "),r("div",{staticClass:"margin-right-sm w140 text-left",staticStyle:{"min-width":"140px"}},[r("div",{staticClass:"margin-sm-reverse padding-sm cursor-pointer",class:{"text-blue":"time2"===n.order.cur},on:{click:function(t){return n.onChangeOrder("time2")}}},[n._v("到达站/时间\n                "),"time2"!==n.order.cur||n.order.order?r("i",{staticClass:"iconfont icon-arrow-down"}):r("i",{staticClass:"iconfont icon-arrow-up"})])])]),n._v(" "),r("div",{staticClass:"w500 flex padding-right-sm"},[r("div",{staticClass:"w120 text-right"},[n._v("席别")]),n._v(" "),r("div",{staticClass:"margin-left w80 text-left"},[r("div",{staticClass:"margin-sm-reverse padding-sm cursor-pointer",class:{"text-blue":"ticketPrice"===n.order.cur},on:{click:function(t){return n.onChangeOrder("ticketPrice")}}},[n._v("参考价\n                "),"ticketPrice"!==n.order.cur||n.order.order?r("i",{staticClass:"iconfont icon-arrow-down"}):r("i",{staticClass:"iconfont icon-arrow-up"})])]),n._v(" "),r("div",{staticClass:"w80 text-right"}),n._v(" "),r("div",{staticClass:"flex-sub text-right"},[r("el-checkbox",{model:{value:n.filter.showOnlyTicket,callback:function(t){n.$set(n.filter,"showOnlyTicket",t)},expression:"filter.showOnlyTicket"}},[n._v("只显示有票车次")])],1)])])]),n._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{"min-height":"300px"}},[0<n.filterList.length?n._l(n.filterList,function(a,t){return r("div",{key:t,staticClass:"margin-bottom-sm bg-white z-2"},[r("div",{staticClass:"padding-lg flex align-start",staticStyle:{position:"relative"}},[r("div",{staticClass:"w120"},[r("div",{staticClass:"text-black text-bold margin-bottom-sm"},[n._v(n._s(a.train_code))]),n._v(" "),r("timetable",{key:a.train_code,attrs:{"from-station":a.from_station_name,"to-station":a.to_station_name,query:{arriveStation:a.to_station_code,departStation:a.from_station_code,trainCode:a.train_code,trainNo:a.train_no,departTime:n.getShortDate(n.query.departDate)}}},[r("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[n._v("经停站")])],1)],1),n._v(" "),r("div",{staticClass:"flex-sub flex align-center",staticStyle:{width:"360px"}},[r("div",{staticClass:"margin-left-sm w140 text-right",staticStyle:{"min-width":"140px"}},[r("div",{staticClass:"text-xxl text-dark text-bold"},[n._v(n._s(a.start_time))]),n._v(" "),r("div",[r("span",[n._v(n._s(a.from_station_name))]),n._v(" "),a.from_station_name===a.start_station_name?r("span",{staticClass:"font-size13 mark-start"},[n._v("始")]):r("span",{staticClass:"font-size13 mark-pass"},[n._v("过")])])]),n._v(" "),r("div",{staticClass:"padding-tb-sm padding-lr-xl flex-sub"},[r("div",{staticClass:"air-arrow-right"},[r("div",{staticClass:"label text-gray text-center"},[n._v(n._s(a.runTimeStr))]),n._v(" "),r("div",{staticClass:"label-bottom text-gray text-center text-cut"},[r("span")])])]),n._v(" "),r("div",{staticClass:"margin-right-sm w140 text-left",staticStyle:{"min-width":"140px"}},[r("div",{staticClass:"text-xxl text-dark text-bold"},[r("span",[n._v(n._s(a.arrive_time))]),n._v(" "),0<a.arrive_days?r("span",{staticClass:"text-sm"},[n._v("+"+n._s(a.arrive_days))]):n._e()]),n._v(" "),r("div",[r("span",[n._v(n._s(a.to_station_name))]),n._v(" "),a.to_station_name===a.end_station_name?r("span",{staticClass:"font-size13 mark-end"},[n._v("终")]):r("span",{staticClass:"font-size13 mark-pass"},[n._v("过")])])])]),n._v(" "),r("div",{staticClass:"w500 padding-right-sm"},[a.note?r("div",{staticClass:"padding-bottom-xs"},[n._v("\n                  "+n._s(a.note)+"\n                ")]):n._l(a.tickets,function(e){return r("div",{key:e.name,staticClass:"flex align-center",staticStyle:{"line-height":"30px"}},[r("div",{staticClass:"w120 text-right text-dark"},[n._v(n._s(e.name))]),n._v(" "),r("div",{staticClass:"margin-left w80 text-left text-orange"},[r("span",[n._v("¥")]),n._v(" "),r("span",{staticClass:"text-xl text-bold"},[n._v(n._s(e.price))])]),n._v(" "),r("div",{staticClass:"w80 text-right"},[20<e.num?r("span",{staticClass:"text-green"},[n._v("有票")]):e.num<=0?r("span",{staticClass:"text-gray"},[n._v("无票")]):r("span",[n._v("余"),r("span",{staticClass:"text-orange"},[n._v(n._s(e.num))]),n._v("张")])]),n._v(" "),r("div",{staticClass:"flex-sub text-right"},[0<e.num?r("easy-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return n.onBook(a,e)}}},[n._v("改签")]):r("el-button",{attrs:{size:"mini",disabled:""}},[n._v("改签")])],1)])})],2)])])}):n.loading?n._e():r("div",{staticClass:"text-center margin-bottom-sm bg-white z-2",staticStyle:{height:"300px","line-height":"300px"}},[r("div",{staticClass:"text-bold text-gray",staticStyle:{"font-size":"66px"}},[n._v("暂无数据")])])],2)])])],1)},[],!1,null,"11eebcb5",null).exports},props:{visible:Boolean,data:{type:Object,default:function(){return{fromStation:"",toStation:"",trainDate:new Date}}}},setup:function(e,t){var s=t.emit,a={newFromStation:"",newToStation:"",newTrainDate:""},n=Object.assign({fromStation:e.data.departStation,toStation:e.data.arriveStation,trainDate:e.data.trainDate},a),o=Object(k.e)({$list:{},$searchForm:{},loading:!1,searchForm:a,query:n});return Object(k.h)(function(){return e.visible},function(t){t&&(o.searchForm={newFromStation:e.data.fromStation,newToStation:e.data.toStation,newTrainDate:e.data.trainDate},o.query={fromStation:e.data.fromStation,toStation:e.data.toStation,trainDate:e.data.trainDate})}),o.show=Object(k.a)({set:function(t){s("update:visible",t)},get:function(){return e.visible}}),o.disabledToStation=Object(k.a)(function(){return O.a.parseDate(o.query.trainDate).getTime()-Date.now()<1728e5}),o.pickerOptions=Object(k.a)(function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),a=O.a.parseDate(o.query.trainDate),n=(1728e5<a.getTime()-t.getTime()?new Date(t.getFullYear(),t.getMonth()+2,t.getDate()):new Date(a.getFullYear(),a.getMonth(),a.getDate())).getTime();return{disabledDate:function(t){return t.getTime()<e||t.getTime()>n}}}),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach(function(t){v()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(k.g)(o),{onSearch:function(){Object.assign(o.query,o.searchForm),o.$list.search()},onSelectSeat:function(t){var e=t.train,a=t.ticket,n=O.a.parseDate(O.a.getShortDate(o.query.newTrainDate)+" "+e.start_time+":00"),r=O.a.parseDate(o.query.newTrainDate);r&&r.setDate(r.getDate()+ +e.arrive_days);var i=O.a.parseDate(O.a.getFormatDate(r,"yyyy-MM-dd")+" "+e.arrive_time+":00");s("select",{train:{newDepartTime:n,newArriveTime:i,newArriveStation:e.to_station_code,newArriveStationName:e.to_station_name,newDepartStation:e.from_station_code,newDepartStationName:e.from_station_name,newEndStationName:e.end_station_name,newStartStationName:e.start_station_name,newTakeDays:e.arrive_days,newTakeTime:e.run_time_minute,newTrainCode:e.train_code,newTrainNo:e.train_no,newTrainType:e.train_type},ticket:a})}})}},F=Object(j.a)(N,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"改签",visible:e.show,width:"1200px"},on:{"update:visible":function(t){e.show=t}}},[a("el-form",{ref:"$searchForm",staticClass:"margin-bottom",attrs:{model:e.searchForm,inline:"",size:"mini"}},[a("div",[a("el-form-item",{attrs:{prop:"newFromStation"}},[a("div",{staticClass:"w160"},[a("c-select-train-station",{attrs:{disabled:"",placeholder:"出发城市"},model:{value:e.searchForm.newFromStation,callback:function(t){e.$set(e.searchForm,"newFromStation",t)},expression:"searchForm.newFromStation"}})],1)]),e._v(" "),a("el-form-item",[a("i",{staticClass:"iconfont icon-turn_right"})]),e._v(" "),a("el-form-item",{attrs:{prop:"newToStation"}},[a("div",{staticClass:"w160"},[a("c-select-train-station",{attrs:{disabled:e.disabledToStation,placeholder:"到达城市"},model:{value:e.searchForm.newToStation,callback:function(t){e.$set(e.searchForm,"newToStation",t)},expression:"searchForm.newToStation"}})],1)]),e._v(" "),a("el-form-item",{attrs:{prop:"departDate"}},[a("el-date-picker",{staticClass:"w160",attrs:{"popper-class":"disabled-next-year","picker-options":e.pickerOptions,clearable:!1,type:"date",placeholder:"出发日期"},model:{value:e.searchForm.newTrainDate,callback:function(t){e.$set(e.searchForm,"newTrainDate",t)},expression:"searchForm.newTrainDate"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("重新搜索")])],1)],1)]),e._v(" "),e.show?a("train-change-search-list",{ref:"$list",attrs:{query:e.query},on:{selectTrainSeat:e.onSelectSeat}}):e._e()],1)},[],!1,null,null,null).exports,I=a("KxU4"),A=a("Xv+L"),L=a("33P3");function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach(function(t){v()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var R={name:"ConfirmChangeDialog",props:{visible:Boolean,data:{type:Object,default:function(){return{oldTrain:{id:""},newTrain:{},passenger:{id:"",seatClassName:""},ticket:{key:""},contactName:"",contactPhone:"",orderId:""}}}},setup:function(s,t){var a=t.emit,n=Object(k.e)({loading:!1,showOld:!1,flight:{}});return n.show=Object(k.a)({get:function(){return s.visible},set:function(t){a("update:visible",t)}}),n.changeId=function(){return s.data.id},n.newTrain=Object(k.a)(function(){var t=new Date,e=s.data.newTrain;if(!e)return{};var a,n,r=O.a.parseDate(e.newDepartTime),i=O.a.parseDate(e.newArriveTime);return a=r.getFullYear()!==t.getFullYear()?O.a.getFormatDate(r,"yyyy-MM-dd hh:mm"):O.a.getFormatDate(r,"MM-dd hh:mm"),n=r.getFullYear()!==i.getFullYear()?O.a.getFormatDate(i,"yyyy-MM-dd hh:mm"):O.a.getFormatDate(r,"MM-dd")===O.a.getFormatDate(i,"MM-dd")?O.a.getFormatDate(i,"hh:mm"):O.a.getFormatDate(i,"MM-dd hh:mm"),{departStationName:e.newDepartStationName,arriveStationName:e.newArriveStationName,departTimeStr:a,arriveTimeStr:n,takeDays:e.newTakeDays,trainCode:e.newTrainCode}}),n.oldTrain=Object(k.a)(function(){var t=new Date,e=s.data.oldTrain;if(!e)return{};var a,n,r=O.a.parseDate(e.departTime),i=O.a.parseDate(e.arriveTime);return a=r.getFullYear()!==t.getFullYear()?O.a.getFormatDate(r,"yyyy-MM-dd hh:mm"):O.a.getFormatDate(r,"MM-dd hh:mm"),n=r.getFullYear()!==i.getFullYear()?O.a.getFormatDate(i,"yyyy-MM-dd hh:mm"):O.a.getFormatDate(r,"MM-dd")===O.a.getFormatDate(i,"MM-dd")?O.a.getFormatDate(i,"hh:mm"):O.a.getFormatDate(i,"MM-dd hh:mm"),{departStationName:e.departStationName,arriveStationName:e.arriveStationName,departTimeStr:a,arriveTimeStr:n,takeDays:e.takeDays,trainCode:e.trainCode}}),E({},Object(k.g)(n),{toggleShowOld:function(){n.showOld=!n.showOld},onOK:function(){return p()(m.a.mark(function t(){var e;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.a.confirm("确认提交改签？","提示",{confirmButtonText:"确  定",cancelButtonText:"再考虑一下",type:"warning"});case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:return e=[{newSeatClass:(""+s.data.ticket.key).toUpperCase(),orderPassengerId:s.data.passenger.id,newSeatPrice:100*s.data.ticket.price}],t.next=11,A.a.submitChangeApply({orderSource:f.b,contactName:s.data.contactName,contactPhone:s.data.contactPhone,orderId:s.data.orderId,passengerList:e,sectionList:[E({orderSectionId:s.data.oldTrain.id},s.data.newTrain)]});case 11:a("ok"),n.show=!1;case 13:case"end":return t.stop()}},t,null,[[0,5]])}))()}})}},z=(a("AvL4"),Object(j.a)(R,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"提交改签",visible:e.show},on:{close:function(t){return e.$emit("close")},"update:visible":function(t){e.show=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"padding-lr",staticStyle:{"min-height":"400px","overflow-y":"auto"}},[a("div",{staticClass:"padding"},[e.showOld?a("div",{staticClass:"new-flight bg-white padding border-radius-xs z-2 margin-bottom"},[a("div",{staticClass:"new-flight-mark bg-grey padding-lr-sm padding-tb-xs text-sm"},[e._v("\n          旧车票\n        ")]),e._v(" "),a("div",[a("div",{staticClass:"flex align-center text-black text-xl margin-bottom-sm"},[a("div",{staticClass:"text-bold"},[e._v(e._s(e.oldTrain.departStationName))]),e._v(" "),a("div",{staticClass:"iconfont icon-turn_right margin-lr-xs"}),e._v(" "),a("div",{staticClass:"text-bold"},[e._v(e._s(e.oldTrain.arriveStationName))]),e._v(" "),a("div",{staticClass:"margin-left text-bold"},[e._v(e._s(e.oldTrain.trainCode))])]),e._v(" "),a("div",[a("div",{staticClass:"margin-bottom-xs"},[e._v(e._s(e.oldTrain.departTimeStr)+" 至 "+e._s(e.oldTrain.arriveTimeStr))])])]),e._v(" "),a("div",[a("span",[e._v(e._s(e.data.passenger.seatClassName))]),e._v(" "),a("span",{staticClass:"margin-left-sm"},[e._v("¥ "+e._s(e.data.passenger.seatPriceStr))])])]):e._e(),e._v(" "),a("div",{staticClass:"new-flight bg-white padding-top padding-lr border-radius-xs z-2"},[a("div",{staticClass:"new-flight-mark bg-blue padding-lr-sm padding-tb-xs text-sm"},[e._v("\n          新车票\n        ")]),e._v(" "),a("div",[a("div",{staticClass:"flex align-center text-black text-xl margin-bottom-sm"},[a("div",{staticClass:"text-bold"},[e._v(e._s(e.newTrain.departStationName))]),e._v(" "),a("div",{staticClass:"iconfont icon-turn_right margin-lr-xs"}),e._v(" "),a("div",{staticClass:"text-bold"},[e._v(e._s(e.newTrain.arriveStationName))]),e._v(" "),a("div",{staticClass:"margin-left text-bold"},[e._v(e._s(e.newTrain.trainCode))])]),e._v(" "),a("div",{staticClass:"margin-bottom-xs"},[a("div",[e._v(e._s(e.newTrain.departTimeStr)+" 至 "+e._s(e.newTrain.arriveTimeStr))])])]),e._v(" "),a("div",{staticClass:"margin-bottom-xs"},[a("span",[e._v(e._s(e.data.ticket.name))]),e._v(" "),a("span",{staticClass:"margin-left-sm"},[e._v("¥ "+e._s(e.data.ticket.price))])]),e._v(" "),a("div",{staticClass:"flex align-start"},[a("div",{staticClass:"round-icon bg-grey margin-right-sm"},[a("span",{staticClass:"iconfont icon-peoplefill"})]),e._v(" "),a("div",{staticClass:"flex-sub text-lg"},[a("span",[e._v(e._s(e.data.passenger.passengerName))])])]),e._v(" "),a("div",{staticClass:"padding text-center cursor-pointer",on:{click:e.toggleShowOld}},[a("span",{staticClass:"iconfont",class:e.showOld?"icon-fold":"icon-unfold"})])])])]),e._v(" "),a("div",{staticClass:"padding text-center"},[a("el-button",{on:{click:function(t){e.show=!1}}},[e._v("返回")]),e._v(" "),a("easy-button",{attrs:{type:"primary"},on:{click:e.onOK}},[e._v("提交改签")])],1)])},[],!1,null,"03e3a12e",null).exports),q=a("lwsE"),B=a.n(q),$=a("W8MJ"),Z=a.n($),G=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;B()(this,e),this.buffer=t,this.percent=0,this.timer=null,this.count=0,this.progressFuncs=[],this.finishFuncs=[]}return Z()(e,[{key:"start",value:function(){var e=this;this.percent=0,this.count=0,this.doProgress();var a=setInterval(function(){if(null!==e.timer){var t=100*(1-e.buffer/(e.count++/e.buffer+e.buffer));t!==e.percent&&(e.percent=t,e.doProgress())}5400<e.count&&clearInterval(a)},33);this.timer=a}},{key:"stop",value:function(){clearInterval(this.timer)}},{key:"doProgress",value:function(){var e=this;this.progressFuncs.forEach(function(t){try{t(e.percent)}catch(t){console.error(t)}})}},{key:"doFinish",value:function(){var e=this;this.finishFuncs.forEach(function(t){try{t(e.percent)}catch(t){console.error(t)}})}},{key:"finish",value:function(){var e=this;clearInterval(this.timer),this.timer=null;var a=setInterval(function(){var t=Math.ceil((100-e.percent)/5);e.percent+=t,100<e.percent&&(e.percent=100),e.doProgress(),100<=e.percent&&(e.percent=100,clearInterval(a),e.doFinish())},80)}},{key:"addProgressListener",value:function(t){this.progressFuncs.push(t)}},{key:"removeProgressListener",value:function(t){var e=this.progressFuncs.indexOf(t);-1<e&&this.progressFuncs.splice(e,1)}},{key:"addFinishListener",value:function(t){this.finishFuncs.push(t)}},{key:"removeFinishListener",value:function(t){var e=this.finishFuncs.indexOf(t);-1<e&&this.finishFuncs.splice(e,1)}}]),e}(),Q=a("gV3c"),Y=a("Y4yO"),K=a("+n12"),H=a("Lr9c");function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var W={name:"ChangeItem",components:{Timetable:o.a,ChangeDetailDialog:H.a},props:{data:{}},setup:function(t,e){var n=e.emit,a=null,s=Object(k.e)({percent:0,loading:!1,showProgress:!1,dialog:{tag:"",data:{}},detail:t.data});Object(k.h)(function(){return t.data},function(t){s.detail=t});function r(){window.open("#/main/pay?id=".concat(s.detail.changeId,"&redirect=").concat(encodeURIComponent("".concat(g.c,"?id=").concat(s.detail.orderId))))}var i=function(){var t=p()(m.a.mark(function t(){var e,a,n;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.detail.changeId,a=s.detail.seatPriceGap,t.prev=2,n="本次改签费用为0元，是否确认改签?",a<0&&(n="本次改签费用为0元，差额".concat(-y.a.toFixed2(a/100),"元系统将原路退回您原订单支付账户，是否确认改签?")),t.next=7,L.a.confirm(n,e,{confirmButtonText:"确定",cancelButtonText:"再考虑下",type:"warning"});case 7:t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return");case 12:return t.next=14,A.a.customerConfirm({changeId:e});case 14:return t.next=16,l();case 16:case"end":return t.stop()}},t,null,[[2,9]])}));return function(){return t.apply(this,arguments)}}(),o=function(){var e=p()(m.a.mark(function t(e){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s.percent=e;case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}();s.barStyle=Object(k.a)(function(){return"width: ".concat(s.percent,"%")});function c(){s.percent=100,s.showProgress=!1}var l=function(){var t=p()(m.a.mark(function t(){var e;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s.loading=!0,t.prev=1,t.next=4,A.a.detail({changeId:s.detail.changeId});case 4:return e=t.sent,t.next=7,Object(k.b)();case 7:s.detail=e.data,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.error(t.t0);case 13:return t.prev=13,s.loading=!1,t.finish(13);case 16:case"end":return t.stop()}},t,null,[[1,10,13,16]])}));return function(){return t.apply(this,arguments)}}(),d=function(){var t=p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.a.status({id:s.detail.changeId});case 2:if(5!==t.sent.data.orderStatus)return clearInterval(a),a=null,u.finish(),t.next=9,l();t.next=10;break;case 9:20===s.detail.status?r():25===s.detail.status&&i();case 10:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),u=new G;s.change=Object(k.a)(function(){var t=s.detail,e=t.sectionList[0]||{},a=O.a.parseDate(e.newDepartTime),n=O.a.parseDate(e.newArriveTime),r=Math.floor(e.newTakeTime/60),i="耗时";return 0<r&&(i+=r+"小时"),i+=e.newTakeTime%60+"分",Object.assign({},t,{canConfirm:25===t.status,canPay:20===t.status,trans:{trainName:e.newTrainCode+(b.a.trainNameMap[e.newTrainType]||""),train:{trainCode:e.newTrainCode,trainNo:e.newTrainNo,departTime:a,departStationName:e.newDepartStationName,departStation:e.newDepartStation,arriveStationName:e.newArriveStationName,arriveStation:e.newArriveStation,startStationName:e.newStartStationName,endStationName:e.newEndStationName,takeDays:e.newTakeDays,departTimeStr:O.a.getFormatDate(a,"hh:mm"),arriveTimeStr:O.a.getFormatDate(n,"hh:mm"),departDateStr:O.a.getFormatDate(a,"MM-dd 周w"),arriveDateStr:O.a.getFormatDate(n,"MM-dd 周w"),runTimeStr:i},passengerList:t.passengerList.map(function(t){return Object.assign({},t,{seatClassStr:t.newSeatClassName,seatPriceStr:y.a.toFixed2(t.newSeatPrice/100)})})}})});return Object(k.c)(function(){u.removeProgressListener(o),u.removeFinishListener(c),u.stop(),clearInterval(a),a=null}),5===s.detail.status&&(s.showProgress=!0,u.start(),a=setInterval(function(){d()},5e3)),u.addProgressListener(o),u.addFinishListener(c),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach(function(t){v()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(k.g)(s),{getShortDate:O.a.getShortDate,onShowChangeDetail:function(e){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s.dialog.tag="ChangeDetailDialog",s.dialog.data={id:e};case 2:case"end":return t.stop()}},t)}))()},onShowRefundDetail:function(e){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n("refund-detail",e);case 1:case"end":return t.stop()}},t)}))()},onShowRefund:function(e,a){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n("refund",e,a);case 1:case"end":return t.stop()}},t)}))()},onPayChange:r,onConfirmChange:i})}};a("vZeL");function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var V={name:"Detail",components:{ChangeItem:Object(j.a)(W,function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"bg-white train-change z-2 margin-bottom"},[n("div",{staticClass:"change-label",class:{cancel:100===a.change.status||110===a.change.status}},[a._v("改")]),a._v(" "),n("div",{staticClass:"padding flex align-center justify-center"},[n("div",{staticClass:"w180 text-center"},[n("div",{staticClass:"padding-xs"},[n("span",{staticClass:"font-size16 font-bold"},[a._v(a._s(a.change.trans.train.departStationName))]),a._v(" "),a.change.trans.train.departStationName===a.change.trans.train.startStationName?n("span",{staticClass:"font-size13 mark-start"},[a._v("始")]):n("span",{staticClass:"font-size13 mark-pass"},[a._v("过")])]),a._v(" "),n("div",{staticClass:"padding-xs text-xxl"},[a._v(a._s(a.change.trans.train.departTimeStr))]),a._v(" "),n("div",{},[a._v(a._s(a.change.trans.train.departDateStr))])]),a._v(" "),n("div",{staticClass:"w160 text-center"},[n("div",{staticClass:"padding-xs font-size16 font-bold"},[a._v(a._s(a.change.trans.trainName))]),a._v(" "),n("div",{staticClass:"iconfont icon-turn_right text-xxl"}),a._v(" "),n("div",{staticClass:"padding-xs"},[a._v(a._s(a.change.trans.train.runTimeStr))])]),a._v(" "),n("div",{staticClass:"w180 text-center"},[n("div",{staticClass:"padding-xs"},[n("span",{staticClass:"font-size16 font-bold"},[a._v(a._s(a.change.trans.train.arriveStationName))]),a._v(" "),a.change.trans.train.arriveStationName===a.change.trans.train.endStationName?n("span",{staticClass:"font-size13 mark-end"},[a._v("终")]):n("span",{staticClass:"font-size13 mark-pass"},[a._v("过")])]),a._v(" "),n("div",{staticClass:"padding-xs"},[n("span",{staticClass:"text-xxl"},[a._v(a._s(a.change.trans.train.arriveTimeStr))]),a._v(" "),0<a.change.trans.train.takeDays?n("span",{},[a._v("+"+a._s(a.change.trans.train.takeDays))]):a._e()]),a._v(" "),n("div",{},[a._v(a._s(a.change.trans.train.arriveDateStr))])]),a._v(" "),n("div",{staticClass:"w160 text-center"},[5===a.change.status?n("div",{staticClass:"text-xxl margin-bottom-sm"},[a._v(a._s(a.change.statusName))]):a._e(),a._v(" "),n("div",{staticClass:"font-blue"},[n("timetable",{attrs:{"from-station":a.change.trans.train.departStationName,"to-station":a.change.trans.train.arriveStationName,query:{arriveStation:a.change.trans.train.arriveStation,departStation:a.change.trans.train.departStation,trainCode:a.change.trans.train.trainCode,trainNo:a.change.trans.train.trainNo,departTime:a.getShortDate(a.change.trans.train.departTime)}}},[n("a",{attrs:{slot:"reference",href:"javascript: void (0)",type:"text"},slot:"reference"},[a._v("查看经停站点")])])],1)])]),a._v(" "),a.showProgress?n("div",{staticClass:"padding-lr"},[n("div",{staticClass:"seat-progress"},[n("div",{staticClass:"bar",style:a.barStyle}),a._v(" "),n("div",{staticClass:"content text-white flex justify-between align-center"},[n("div"),a._v(" "),n("div",{staticClass:"text-bold text-xl"},[a._v(a._s(Math.ceil(a.percent))+"%")])])])]):a._e(),a._v(" "),n("div",{staticClass:"padding"},[n("div",{staticClass:"solid-border"},a._l(a.change.trans.passengerList,function(e,t){return n("div",{key:t,staticClass:"padding-tb-sm padding-lr"},[n("div",{staticClass:"flex align-end justify-between text-black margin-bottom-xs"},[n("div",[n("span",{staticClass:"margin-right"},[a._v(a._s(e.passengerName))]),a._v(" "),n("span",{staticClass:"text-gray text-sm"},[a._v(a._s(e.ticketTypeName))])]),a._v(" "),n("div",[n("span",{staticClass:"margin-right"},[a._v(a._s(e.seatClassStr))]),a._v(" "),n("span",[a._v("¥"+a._s(e.seatPriceStr))])])]),a._v(" "),n("div",{staticClass:"flex align-end justify-between text-black"},[n("div",{staticClass:"text-gray"},[a._v(a._s(e.cardNo))]),a._v(" "),n("div",{staticClass:"text-gray"},[a._v(a._s(e.newSeatNo||""))])]),a._v(" "),n("div",{staticClass:"flex align-center justify-between margin-top-xs"},[n("div",{staticClass:"text-orange"},[a._v(a._s(e.passengerStatusName))]),a._v(" "),n("div",[n("el-button",{staticClass:"margin-left-sm",attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){return a.onShowChangeDetail(a.change.changeId)}}},[a._v("改签详情")]),a._v(" "),80<=e.passengerStatus&&e.passengerStatus<=100?[n("el-button",{staticClass:"margin-left-sm",attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){return a.onShowRefundDetail(e.refundId)}}},[a._v("退票详情")])]:[60===e.passengerStatus?n("el-button",{staticClass:"margin-left-sm",attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){return a.onShowRefund(a.change.changeId,e.id)}}},[a._v("退票")]):a._e()],a._v(" "),a.change.canConfirm?n("easy-button",{attrs:{type:"primary",size:"mini"},on:{click:a.onConfirmChange}},[a._v("支付")]):a._e(),a._v(" "),a.change.canPay?n("el-button",{staticClass:"margin-left-sm",attrs:{type:"primary",size:"mini"},on:{click:a.onPayChange}},[a._v("支付")]):a._e()],2)])])}),0)]),a._v(" "),n(a.dialog.tag,{tag:"component",attrs:{data:a.dialog.data},on:{close:function(t){a.dialog.tag=""}}})],1)},[],!1,null,"21607b37",null).exports,ConfirmChangeDialog:z,TrainChangeDialog:F,TrainChangeRegulation:c.a,Timetable:o.a,RefundDialog:s.a,RefundDetailDialog:I.a},setup:function(){var t=Object(Q.a)(),e=t.router,a=t.route,n=new G,i=Object(k.e)({showProgress:!1,percent:0,timer:null,showChangeRegulation:!1,showPriceDetail:!1,detail:{orderId:"",contactName:"",contactPhone:"",contactEmail:"",sectionList:[],passengerList:[],total:0,changeList:[],orderStatus:"",orderStatusName:"",remark:"",payStatus:"",bookTime:new Date,orderSource:"",orderType:1},timetable:{show:!1},refund:{show:!1,form:{orderId:"",passengerId:""},detail:{canRefund:!0,reason:null,refundAmount:null,refundFee:null,refundRate:null}},dialog:{tag:"",data:{}},change:{visible:!1,query:{fromStation:"",toStation:"",trainDate:""},confirm:{visible:!1,oldTrain:{},newTrain:{},passenger:{},ticket:{},contactName:"",contactPhone:"",orderId:""}},remainPayTime:0});i.remainPayTimeStr=Object(k.a)(function(){var t=Math.round(i.remainPayTime/1e3),e=Math.floor(t/60),a=t%60;return"剩余支付时间".concat(e,"分").concat(a,"秒,请尽快支付")});function r(){setTimeout(function(){var t=O.a.parseDate(i.detail.bookTime);i.remainPayTime=12e5-(Date.now()-t.getTime()),0<i.remainPayTime&&r()},1e3)}i.trainStyle=Object(k.a)(function(){return"left: ".concat(i.percent,"%")}),i.barStyle=Object(k.a)(function(){return"width: ".concat(i.percent,"%")}),i.train=Object(k.a)(function(){var t=i.detail.sectionList[0]||{},e=O.a.parseDate(t.departTime),a=O.a.parseDate(t.arriveTime),n=Math.floor(t.takeTime/60),r="耗时";return 0<n&&(r+=n+"小时"),r+=t.takeTime%60+"分",Object.assign({},t,{departTimeStr:O.a.getFormatDate(e,"hh:mm"),arriveTimeStr:O.a.getFormatDate(a,"hh:mm"),departDateStr:O.a.getFormatDate(e,"MM-dd 周w"),arriveDateStr:O.a.getFormatDate(a,"MM-dd 周w"),runTimeStr:r})}),i.trainName=Object(k.a)(function(){return i.train.trainCode+(b.a.trainNameMap[i.train.trainType]||"")}),i.passengerList=Object(k.a)(function(){return i.detail.passengerList.map(function(t){return Object.assign({},t,{seatPriceStr:y.a.toFixed2(t.seatPrice/100)})})}),i.timetableQuery=Object(k.a)(function(){return{arriveStation:i.train.arriveStation,departStation:i.train.departStation,trainCode:i.train.trainCode,trainNo:i.train.trainNo,departTime:O.a.getShortDate(i.train.departTime)}}),i.totalPrice=Object(k.a)(function(){return y.a.toFixed2(i.detail.total/100)}),i.priceList=Object(k.a)(function(){var t=i.passengerList.length,e=i.passengerList[0]||{};return[{feeType:"票价",price:y.a.toFixed2(e.seatPrice/100),quantity:t},{feeType:"服务费",price:y.a.toFixed2(e.serviceFee/100),quantity:t}]}),i.showPay=Object(k.a)(function(){return 10===i.detail.orderStatus&&0<i.remainPayTime}),i.canPay=Object(k.a)(function(){var t=i.detail;return-1<[10,30].indexOf(t.orderStatus)&&0===t.payStatus}),i.canCancel=Object(k.a)(function(){return-1<[0,10,20,30].indexOf(i.detail.orderStatus)});function s(){window.open("#/main/pay?id=".concat(i.detail.orderId,"&redirect=").concat(encodeURIComponent("".concat(g.c,"?id=").concat(i.detail.orderId))))}function o(){i.percent=100,i.showProgress=!1}var c=function(){var t=p()(m.a.mark(function t(){var e,a;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i.loading=!0,t.prev=1,t.next=4,Y.a.detail({orderId:i.id});case 4:e=t.sent,Object.assign(i.detail,Object(K.h)(e.data,Object.keys(i.detail))),i.canPay&&(a=O.a.parseDate(i.detail.bookTime),i.remainPayTime=12e5-(Date.now()-a.getTime()),0<i.remainPayTime&&r()),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.error(t.t0);case 12:return t.prev=12,i.loading=!1,t.finish(12);case 15:case"end":return t.stop()}},t,null,[[1,9,12,15]])}));return function(){return t.apply(this,arguments)}}(),l=function(){var t=p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y.a.status({orderId:i.id});case 2:if(5!==t.sent.data.orderStatus)return clearInterval(i.timer),i.timer=null,n.finish(),t.next=9,c();t.next=10;break;case 9:i.canPay&&s();case 10:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),d=function(){var t=p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c();case 2:5===i.detail.orderStatus&&(i.showProgress=!0,n.start(),i.timer=setInterval(function(){l()},5e3));case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),u=function(){var e=p()(m.a.mark(function t(e){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i.percent=e;case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}();i.id=Object(k.a)(function(){return a.query.id}),Object(k.h)(function(){return i.id},function(){d()});return Object(k.c)(function(){n.removeProgressListener(u),n.removeFinishListener(o),n.stop(),clearInterval(i.timer),i.timer=null,_.a.$off(h.a.ORDER_DETAIL_REFRESH,d),_.a.$off(h.a.TRAIN_ORDER_DETAIL_REFRESH,d)}),n.addProgressListener(u),n.addFinishListener(o),_.a.$on(h.a.ORDER_DETAIL_REFRESH,d),_.a.$on(h.a.TRAIN_ORDER_DETAIL_REFRESH,d),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach(function(t){v()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(k.g)(i),{getShortDate:O.a.getShortDate,refresh:d,onChangeRegulation:function(){i.showChangeRegulation=!0},onPay:s,onCancel:function(){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.a.confirm("确认要取消该订单吗？","提示",{confirmButtonText:"取消订单",cancelButtonText:"再考虑一下",type:"warning"});case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:return t.prev=8,t.next=11,Y.a.cancel({orderId:i.id});case 11:return t.prev=11,d(),t.finish(11);case 14:case"end":return t.stop()}},t,null,[[0,5],[8,,11,14]])}))()},onPayRebook:function(t){window.open("#/main/pay?id=".concat(t,"&redirect=").concat(encodeURIComponent("".concat(g.c,"?id=").concat(i.id))))},onChange:function(e){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(2===i.detail.orderType)return t.next=3,L.a.alert("该订单由客服代订，请联系客服进行改签，联系电话".concat(f.c),"提示");t.next=4;break;case 3:return t.abrupt("return");case 4:i.change.confirm.passenger=e,i.change.visible=!0,i.change.query={fromStation:i.train.departStation,toStation:i.train.arriveStation,trainDate:O.a.parseDate(i.train.departTime)};case 7:case"end":return t.stop()}},t)}))()},onShowRefund:function(a,n){return p()(m.a.mark(function t(){var e;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(2===i.detail.orderType)return t.next=3,L.a.alert("该订单由客服代订，请联系客服进行退票，联系电话".concat(f.c),"提示");t.next=4;break;case 3:return t.abrupt("return");case 4:return i.refund.show=!0,i.refund.form.passengerId=n,i.refund.form.orderId=a,t.next=9,x.a.queryRefundFee({orderId:a,passengerId:n});case 9:e=t.sent,i.refund.detail=e.data;case 11:case"end":return t.stop()}},t)}))()},onShowRefundDetail:function(e){return p()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i.dialog.tag="RefundDetailDialog",i.dialog.data={id:e};case 2:case"end":return t.stop()}},t)}))()},onRefund:function(){return p()(m.a.mark(function t(){var e;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={orderSource:f.b,orderId:i.refund.form.orderId,contactName:i.detail.contactName,contactPhone:i.detail.contactPhone,psgIdList:[i.refund.form.passengerId]},t.next=3,x.a.submitRefundApply(e);case 3:return t.next=5,d();case 5:i.refund.show=!1;case 6:case"end":return t.stop()}},t)}))()},onSelectChangeTrain:function(t){var e=t.train,a=t.ticket;i.change.confirm.visible=!0,i.change.confirm.newTrain=e,i.change.confirm.oldTrain=i.train,i.change.confirm.ticket=a,i.change.confirm.contactName=i.detail.contactName,i.change.confirm.contactPhone=i.detail.contactPhone,i.change.confirm.orderId=i.detail.orderId},onChangeOk:function(){i.change.visible=!1,d()},onBack:function(){e.back()}})}},X=(a("QADa"),Object(j.a)(V,function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],ref:"form",staticClass:"air-content padding-top air-book",attrs:{"label-width":"80px",size:"mini"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:17}},[n("div",{staticClass:"bg-white z-2 margin-bottom"},[n("div",{staticClass:"border-bottom"},[90===a.detail.orderStatus?n("el-alert",{attrs:{title:a.detail.remark,type:"error"}}):a._e(),a._v(" "),a.showPay?n("el-alert",{attrs:{title:a.remainPayTimeStr,type:"warning"}}):a._e(),a._v(" "),n("div",{staticClass:"padding flex justify-between align-center"},[n("div",{staticClass:"text-lg"},[a._v("\n              订单号："+a._s(a.detail.orderId)+"\n            ")]),a._v(" "),n("div",{staticClass:"text-xxl text-bold",class:"已出票"===a.detail.orderStatusName?"text-green":"text-orange"},[a._v(a._s(a.detail.orderStatusName))])])],1),a._v(" "),n("div",{staticClass:"padding flex align-center justify-center"},[n("div",{staticClass:"w180 text-center"},[n("div",{staticClass:"padding-xs"},[n("span",{staticClass:"font-size16 font-bold"},[a._v(a._s(a.train.departStationName))]),a._v(" "),a.train.departStationName===a.train.startStationName?n("span",{staticClass:"font-size13 mark-start"},[a._v("始")]):n("span",{staticClass:"font-size13 mark-pass"},[a._v("过")])]),a._v(" "),n("div",{staticClass:"padding-xs text-xxl"},[a._v(a._s(a.train.departTimeStr))]),a._v(" "),n("div",{},[a._v(a._s(a.train.departDateStr))])]),a._v(" "),n("div",{staticClass:"w160 text-center"},[n("div",{staticClass:"padding-xs font-size16 font-bold"},[a._v(a._s(a.trainName))]),a._v(" "),n("div",{staticClass:"iconfont icon-turn_right text-xxl"}),a._v(" "),n("div",{staticClass:"padding-xs"},[a._v(a._s(a.train.runTimeStr))])]),a._v(" "),n("div",{staticClass:"w180 text-center"},[n("div",{staticClass:"padding-xs"},[n("span",{staticClass:"font-size16 font-bold"},[a._v(a._s(a.train.arriveStationName))]),a._v(" "),a.train.arriveStationName===a.train.endStationName?n("span",{staticClass:"font-size13 mark-end"},[a._v("终")]):n("span",{staticClass:"font-size13 mark-pass"},[a._v("过")])]),a._v(" "),n("div",{staticClass:"padding-xs"},[n("span",{staticClass:"text-xxl"},[a._v(a._s(a.train.arriveTimeStr))]),a._v(" "),0<a.train.takeDays?n("span",{},[a._v("+"+a._s(a.train.takeDays))]):a._e()]),a._v(" "),n("div",{},[a._v(a._s(a.train.arriveDateStr))])]),a._v(" "),n("div",{staticClass:"w160 text-center"},[n("div",{staticClass:"font-blue"},[n("div",{staticClass:"font-blue margin-bottom-sm"},[n("a",{attrs:{href:"javascript: void (0)"},on:{click:a.onChangeRegulation}},[a._v("查看退改签")])]),a._v(" "),n("timetable",{attrs:{"from-station":a.train.departStationName,"to-station":a.train.arriveStationName,query:a.timetableQuery}},[n("a",{attrs:{slot:"reference",href:"javascript: void (0)",type:"text"},slot:"reference"},[a._v("查看经停站点")])])],1)])]),a._v(" "),n("div",{staticClass:"padding"},[n("div",{staticClass:"solid-border"},a._l(a.passengerList,function(e,t){return n("div",{key:t,staticClass:"padding-tb-sm padding-lr"},[n("div",{staticClass:"flex align-end justify-between text-black margin-bottom-xs"},[n("div",[n("span",{staticClass:"margin-right"},[a._v(a._s(e.passengerName))]),a._v(" "),n("span",{staticClass:"text-gray text-sm margin-right"},[a._v(a._s(e.ticketTypeName))])]),a._v(" "),n("div",[n("span",{staticClass:"text-sm margin-right"},[a._v(a._s(e.seatClassName))]),a._v(" "),n("span",[a._v("¥"+a._s(e.seatPriceStr))])])]),a._v(" "),n("div",{staticClass:"flex align-end justify-between text-black"},[n("div",{staticClass:"text-gray"},[a._v(a._s(e.cardNo))]),a._v(" "),n("div",{staticClass:"text-gray"},[a._v(a._s(e.seatNo))])]),a._v(" "),n("div",{staticClass:"flex align-center justify-between margin-top-xs"},[n("div",{staticClass:"text-orange"},[a._v(a._s(e.passengerStatusName))]),a._v(" "),n("div",[80<=e.passengerStatus&&e.passengerStatus<=100?[n("el-button",{staticClass:"margin-left-sm",attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){return a.onShowRefundDetail(e.refundId)}}},[a._v("退票详情")])]:[n("el-button",{staticClass:"margin-left-sm",attrs:{type:"primary",plain:"",size:"mini",disabled:20!==e.passengerStatus},on:{click:function(t){return a.onChange(e)}}},[a._v("改签")]),a._v(" "),n("el-button",{staticClass:"margin-left-sm",attrs:{type:"primary",plain:"",size:"mini",disabled:20!==e.passengerStatus},on:{click:function(t){return a.onShowRefund(a.detail.orderId,e.id)}}},[a._v("退票")])]],2)])])}),0)])]),a._v(" "),a._l(a.detail.changeList||[],function(t){return n("change-item",{key:t.id,attrs:{data:t},on:{refund:a.onShowRefund,"refund-detail":a.onShowRefundDetail}})}),a._v(" "),n("div",{staticClass:"bg-white z-2 margin-bottom"},[n("div",{staticClass:"padding border-bottom"},[n("div",{staticClass:"text-lg"},[a._v("联系人")])]),a._v(" "),n("div",{staticClass:"padding"},[n("el-row",{staticClass:"margin-bottom-sm"},[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"姓名",prop:"contactName"}},[a._v("\n                "+a._s(a.detail.contactName)+"\n              ")])],1),a._v(" "),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"手机",prop:"contactPhone"}},[a._v("\n                "+a._s(a.detail.contactPhone)+"\n              ")])],1),a._v(" "),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"邮箱",prop:"contactEmail"}},[a._v("\n                "+a._s(a.detail.contactEmail)+"\n              ")])],1)],1)],1)]),a._v(" "),n("div",{staticClass:"padding text-center margin-bottom"},[n("el-button",{on:{click:a.onBack}},[a._v("返回")]),a._v(" "),a.canCancel?n("easy-button",{attrs:{type:""},on:{click:a.onCancel}},[a._v("取消订单")]):a._e(),a._v(" "),a.canPay&&a.showPay?n("easy-button",{attrs:{type:"primary"},on:{click:a.onPay}},[a._v("去支付")]):a._e()],1)],2),a._v(" "),n("el-col",{attrs:{span:7}},[n("div",{staticClass:"bg-flight-item light text-black margin-bottom-sm padding z-2"},[n("div",{staticClass:"text-black"},[n("div",{staticClass:"flex justify-between align-center margin-bottom"},[n("div",{staticClass:"text-xxl text-bold"},[a._v("应付金额")]),a._v(" "),n("div",{staticClass:"text-orange text-bold"},[n("span",{staticClass:"text-xl"},[a._v("¥")]),n("span",{staticStyle:{"font-size":"30px"}},[a._v(a._s(a.totalPrice))])])]),a._v(" "),a._l(a.priceList,function(t,e){return n("div",{key:e,staticClass:"flex margin-bottom-xs align-center"},[n("div",[a._v(a._s(t.feeType))]),a._v(" "),n("div",{staticClass:"flex-sub dashed-line margin-lr"}),a._v(" "),n("div",[n("span",[a._v("¥ "+a._s(t.price))]),a._v(" "),n("span",[a._v(" x"+a._s(t.quantity))])])])})],2)])])],1),a._v(" "),n(a.dialog.tag,{tag:"component",attrs:{data:a.dialog.data},on:{ok:a.refresh,close:function(t){a.dialog.tag=""}}}),a._v(" "),n("train-change-regulation",{attrs:{visible:a.showChangeRegulation},on:{"update:visible":function(t){a.showChangeRegulation=t}}}),a._v(" "),n("el-dialog",{attrs:{title:"退票费用详情",visible:a.refund.show,width:"500px"},on:{"update:visible":function(t){return a.$set(a.refund,"show",t)}}},[n("div",{staticClass:"padding text-left"},[n("div",{staticClass:"flex align-center margin-bottom"},[n("div",{staticClass:"flex-sub"},[n("div",{staticClass:"margin-bottom-xs"},[a._v("预计应退票款")]),a._v(" "),n("div",[n("span",{staticClass:"text-red"},[a._v("*")]),a._v(" "),n("span",{staticClass:"text-gray text-sm"},[a._v("以铁路部门实际退还为准")])])]),a._v(" "),n("div",{staticClass:"nowrap"},[n("span",{staticClass:"text-xxl text-orange"},[a._v("¥ "+a._s(-a.refund.detail.refundAmount))])])]),a._v(" "),n("div",{staticClass:"flex justify-between margin-bottom-xs"},[n("div",[a._v("票价")]),a._v(" "),n("div",[a._v("¥ "+a._s(a.refund.detail.seatPrice))])]),a._v(" "),n("div",{staticClass:"flex justify-between margin-bottom-xs"},[n("div",[a._v("预计手续费")]),a._v(" "),n("div",[a._v("- ¥ "+a._s(a.refund.detail.refundFee))])])]),a._v(" "),n("div",{staticClass:"center-box"},[n("el-button",{attrs:{type:"default"},on:{click:function(t){a.refund.show=!1}}},[a._v("取消")]),a._v(" "),n("easy-button",{attrs:{type:"primary"},on:{click:a.onRefund}},[a._v("确认退票")])],1)]),a._v(" "),n("train-change-dialog",{attrs:{visible:a.change.visible,data:a.change.query},on:{"update:visible":function(t){return a.$set(a.change,"visible",t)},select:a.onSelectChangeTrain}}),a._v(" "),n("confirm-change-dialog",{attrs:{visible:a.change.confirm.visible,data:a.change.confirm},on:{"update:visible":function(t){return a.$set(a.change.confirm,"visible",t)},ok:a.onChangeOk}}),a._v(" "),n("el-dialog",{attrs:{title:"",visible:a.showProgress,"show-close":!1,width:"600px"}},[n("div",{staticClass:"progress-container"},[n("div",{staticClass:"seat-progress margin-bottom"},[n("div",{staticClass:"progress-train",style:a.trainStyle},[n("i",{staticClass:"iconfont icon-gaotie"})]),a._v(" "),n("div",{staticClass:"bar",style:a.barStyle}),a._v(" "),n("div",{staticClass:"content text-white flex justify-between align-center"},[n("div"),a._v(" "),n("div",{staticClass:"text-bold text-xl"},[a._v(a._s(Math.ceil(a.percent))+"%")])])]),a._v(" "),n("div",[a._v("正在努力为您占座，成功后可支付，请稍候~")])])])],1)},[],!1,null,"a3fad6f6",null));e.default=X.exports},N6Ha:function(t,e,a){},NRDl:function(t,e,a){"use strict";var n=a("heg8");a.n(n).a},"Pk/8":function(t,e,a){"use strict";var n=a("lwsE"),r=a.n(n),i=a("II3V"),s=a("tOq/");e.a=new function t(){r()(this,t),this.searchTicket=i.a.makeGet("/api/train/searchTicket"),this.searchChangeTicket=i.a.makeGet("/api/train/searchChangeTicket"),this.getTrainInfo=i.a.makeGet("/api/train/getTrainInfo",{showLoading:!0,expire:s.a._5M})}},QADa:function(t,e,a){"use strict";var n=a("GjQu");a.n(n).a},QXkC:function(t,e,a){},heg8:function(t,e,a){},kz0y:function(t,e,a){"use strict";var n=a("lSNA"),o=a.n(n),r=a("o0o1"),c=a.n(r),i=a("yXPU"),l=a.n(i),d=a("1m11"),u=a("jxIu"),v=a("+n12"),m=a("1SN4"),p=a("uK3i"),f=a("33P3"),g=a("Cd74");function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var s={name:"RefundDialog",props:{data:{type:Object,default:function(){return{priceList:[]}}}},setup:function(t,e){var a=e.emit,n=e.refs,r=Object(g.e)({$step0Form:{},$step1Form:{},loading:!1,step:0,visible:!0,form:{orderSource:d.b,issueBillId:"",refundType:"1",contactName:"",contactPhone:"",psgIdList:[]},issueDetail:{passengerList:[],flightList:[],contactName:"",contactPhone:""}});r.transPassengerList=Object(g.a)(function(){return r.issueDetail.passengerList.map(function(t){return Object.assign({},t,{disabled:t.passengerStatus+""!="20"})})});var i,s=function(){var t=l()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.queryIssueBillDetail({issueBillId:r.form.issueBillId});case 2:null!==(e=t.sent).data&&(Object.assign(r.issueDetail,Object(v.h)(e.data,Object.keys(r.issueDetail))),r.form.contactName=r.issueDetail.contactName,r.form.contactPhone=r.issueDetail.contactPhone);case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return i=t.data.priceList[0]||{issueBillId:""},r.form.issueBillId=i.issueBillId,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach(function(t){o()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(g.g)(r),{loadIssue:s,rules:{notEmpty:u.a.notEmpty},onBack:function(){r.step--},goStep1:function(){return l()(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(g.b)();case 2:return t.prev=2,t.next=5,n.$step0Form.validate();case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(2),console.error(t.t0),t.abrupt("return");case 11:return r.step=1,r.form.psgIdList=[],t.next=15,s();case 15:case"end":return t.stop()}},t,null,[[2,7]])}))()},onSubmit:function(){return l()(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===r.form.psgIdList.length)return t.next=3,f.a.alert("请选择要退票的乘客","提示");t.next=4;break;case 3:return t.abrupt("return");case 4:return t.prev=4,t.next=7,n.$step1Form.validate();case 7:t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(4),console.error(t.t0),t.abrupt("return");case 13:return t.prev=13,t.next=16,f.a.confirm("确认要提交退票申请吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"暂不提交",type:"warning"});case 16:t.next=21;break;case 18:return t.prev=18,t.t1=t.catch(13),t.abrupt("return");case 21:return t.next=23,p.a.submitRefundApply(r.form);case 23:return r.visible=!1,a("ok"),t.next=27,f.a.alert("退票单已提交成功，请等待客服确认！","提示");case 27:case"end":return t.stop()}},t,null,[[4,9],[13,18]])}))()}})}},h=a("KHd+"),b=Object(h.a)(s,function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("el-dialog",{attrs:{"close-on-click-modal":!1,title:"申请退票",visible:a.visible},on:{close:function(t){return a.$emit("close")},"update:visible":function(t){a.visible=t}}},[n("div",{staticClass:"padding-lr"},[n("el-steps",{attrs:{active:a.step,"finish-status":"success",simple:""}},[n("el-step",{attrs:{title:"选择行程&原因"}}),a._v(" "),n("el-step",{attrs:{title:"选择人员"}})],1),a._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"padding-lr",staticStyle:{height:"400px","overflow-y":"auto"}},[[n("el-form",{ref:"$step0Form",staticClass:"padding-tb",attrs:{size:"mini",model:a.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"选择行程",prop:"issueBillId",rules:a.rules.notEmpty}},a._l(a.data.priceList,function(t,e){return n("div",{key:e},[n("el-radio",{attrs:{label:t.issueBillId},model:{value:a.form.issueBillId,callback:function(t){a.$set(a.form,"issueBillId",t)},expression:"form.issueBillId"}},[a._v(a._s(t.title))])],1)}),0),a._v(" "),n("el-form-item",{attrs:{label:"退票原因",prop:"refundType",rules:a.rules.notEmpty}},[n("div",[n("el-radio",{attrs:{label:"1"},model:{value:a.form.refundType,callback:function(t){a.$set(a.form,"refundType",t)},expression:"form.refundType"}},[n("el-tooltip",{attrs:{effect:"dark",placement:"right",content:"按航空公司退改规则收费"}},[n("span",[a._v("自愿退票")])])],1)],1),a._v(" "),n("div",[n("el-radio",{attrs:{label:"0"},model:{value:a.form.refundType,callback:function(t){a.$set(a.form,"refundType",t)},expression:"form.refundType"}},[n("el-tooltip",{attrs:{effect:"dark",placement:"right",content:"需等待航空公司审核"}},[n("span",[a._v("非自愿退票")])])],1)],1)])],1)],a._v(" "),1===a.step?[n("el-form",{ref:"$step1Form",staticClass:"padding-tb",attrs:{size:"mini",model:a.form}},[n("div",{staticClass:"margin-bottom"},[n("div",{staticClass:"text-lg text-bold margin-bottom-sm"},[a._v("\n              选择乘客\n            ")]),a._v(" "),n("el-form-item",{attrs:{label:"",prop:"psgIdList"}},[n("el-checkbox-group",{model:{value:a.form.psgIdList,callback:function(t){a.$set(a.form,"psgIdList",t)},expression:"form.psgIdList"}},a._l(a.transPassengerList,function(t,e){return n("div",{key:e},[n("el-checkbox",{attrs:{disabled:t.disabled,label:t.id}},[n("span",{staticClass:"margin-right"},[a._v(a._s(t.passengerName))]),a._v(" "),n("el-tag",{attrs:{size:"mini"}},[a._v(a._s(t.passengerStatusName))])],1)],1)}),0)],1)],1),a._v(" "),n("div",{staticClass:"text-lg text-bold margin-bottom-sm"},[a._v("\n            联系人信息\n          ")]),a._v(" "),n("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"姓名",prop:"contactName",rules:a.rules.notEmpty}},[n("el-input",{staticClass:"w200",attrs:{placeholder:"联系人姓名"},model:{value:a.form.contactName,callback:function(t){a.$set(a.form,"contactName",t)},expression:"form.contactName"}})],1),a._v(" "),n("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"电话",prop:"contactPhone",rules:a.rules.notEmpty}},[n("el-input",{staticClass:"w200",attrs:{placeholder:"联系人电话"},model:{value:a.form.contactPhone,callback:function(t){a.$set(a.form,"contactPhone",t)},expression:"form.contactPhone"}})],1)],1)]:a._e()],2)],1),a._v(" "),n("div",{staticClass:"padding text-center"},[0<a.step?n("el-button",{on:{click:a.onBack}},[a._v("上一步")]):a._e(),a._v(" "),0===a.step?n("el-button",{attrs:{type:"primary"},on:{click:a.goStep1}},[a._v("下一步")]):a._e(),a._v(" "),1===a.step?n("easy-button",{attrs:{type:"primary"},on:{click:a.onSubmit}},[a._v("提交申请")]):a._e()],1)])},[],!1,null,null,null);e.a=b.exports},oZW5:function(t,e,a){"use strict";var n=a("lSNA"),r=a.n(n),i=a("o0o1"),s=a.n(i),o=a("yXPU"),c=a.n(o),l=a("Cd74"),d=a("Pk/8");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var v={name:"Timetable",props:{fromStation:String,toStation:String,query:{type:Object,default:function(){return{}}}},setup:function(a){var n=Object(l.e)({visible:!1,loading:!1,list:[]}),e=function(){var t=c()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.loading=!0,t.prev=1,t.next=4,d.a.getTrainInfo(a.query);case 4:(e=t.sent).data&&(n.list=e.data.data||[]);case 6:return t.prev=6,n.loading=!1,t.finish(6);case 9:case"end":return t.stop()}},t,null,[[1,,6,9]])}));return function(){return t.apply(this,arguments)}}();return Object(l.h)(function(){return n.visible},function(t){t&&e()}),n.departIndex=Object(l.a)(function(){return n.list.findIndex(function(t){return t.stationName===a.fromStation})}),n.arriveIndex=Object(l.a)(function(){return n.list.findIndex(function(t){return t.stationName===a.toStation})}),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach(function(t){r()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(l.g)(n),{rowClassName:function(t){t.row;var e=t.rowIndex;return-1!==n.departIndex&&-1!==n.arriveIndex&&e>=n.departIndex&&e<=n.arriveIndex?"current-row":""},getStationNo:function(t){return(Array(2).join("0")+t).slice(-2)}})}},m=a("KHd+"),p=Object(m.a)(v,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{placement:"right",trigger:"click"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",[a("div",[e._v("经停站信息")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"el-easy-ui-table",attrs:{border:"",data:e.list,"max-height":"400px","row-class-name":e.rowClassName}},[a("el-table-column",{attrs:{prop:"stationNo",label:"站序",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stationName",label:"站名","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"arriveTime",label:"到站时间","min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"startTime",label:"出发时间","min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stopoverTime",label:"停留时间","min-width":"60"}})],1)],1),e._v(" "),e._t("reference",null,{slot:"reference"})],2)},[],!1,null,null,null);e.a=p.exports},uK3i:function(t,e,a){"use strict";var n=a("lwsE"),r=a.n(n),i=a("II3V");e.a=new function t(){r()(this,t),this.submitRefundApply=i.a.makeJPost("/api/air/refund/submitRefundApply",{successW:!1}),this.detail=i.a.makeGet("/api/air/refund/detail"),this.query4UserList=i.a.makeGet("/api/air/refund/query4UserList")}},vZeL:function(t,e,a){"use strict";var n=a("N6Ha");a.n(n).a},zCTp:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAMAAABGS8AGAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAFdQTFRFAAAAFZv5FZv5FZv5FZv5FZv5FZv5FZv5FZv5FZv5FZv53ocj/YQC74UR/YwT/+bM/s6a//fu/////r14/+/d/rVn/t68/qVF/Z01/tar/ZQk/q1W/saJMg4sdQAAAB10Uk5TAAEDBgsSGyc0QlDP/7////////////////////8ji8QTAAACv0lEQVR4nO3Y2ZrbIAwG0MzajQJiD/b7P2dlsBNPIjmxjW/acpPl4nyaHySTOZ3Kenl9e//4/Pb9x89fYv36/fnx/vb6cqLWXy7Lg2Sp9CGyVNBeloNrbPOapfMiQFS+uZyMT4Bsc1kDHCLrUnB7WYOF1FpOZ6nNWXjwMOWsITWQswJIWgtrVKw1A+VukKWGKPQZVIwljUC7k0zCTBre2GSUHHN2jDvKNMzl7NAVWhWZmERzmYFpOQEEIaDzRb583VEyB5Nyr3IS2UhR5BpF6p3JhMzCpCxdsNaI1CmQEl/s2RnX37so8zApZ6sMLtARP5R3+MZT27gAMzuYjR3Lj0kNeXgDdh3MyG7aNjm6uoNwF8ciTMs63Lj4V4S7opdhOud6HmbuMKex09fA/Kyb3AJLp3IwcQ3MyZd6E2j8gA0pYloFMxPpmgPKZ7jv78cwKZcRNOULhjjIT8B0D4pkqys67JdtMJ2GM6HcMzL0aSZHuQKma7bYFroTQQ1p1GMsfZj68jmYe6ZEyLYEnLDBfR/w8E1n7kmYe6Y4Cb0Yk8Zlr6fjWZiWrfU4nYuWI146rlv7PMzUjIPD1lTR7X3E5XuH/fI8zEwk4+pkQ1eWWY1TY9jAFTAz+f1Ubw0kZpzYeR28cPsaXT/MDBHNms1blCe39mK3HuZ2sLpTj9sNMN2DanBjqHySG6Lg5BwCmFBmXIJzNKvO8aKsezveX0DJPDxL1sOLd/7BxZC3wQtydcvaArPyzN0Gc7fcmbsRpuUwc7fCzKkT++GHv2E3w4/k7fADeQe8LO+BF+Vd8JK8D16Qd8K8vBdm5d0wJ++HGbkBTMstYFJuAlNyG5iQG8H3civ4Tm4G38rt4Bu5IfxVbgl/kZvCc7ktPJMbw1e5NXyRm8OT3B4e5QPgKh8BF/kQeJCPgVE+CD7R/6P/v/7x9QcodZPByES1ngAAAABJRU5ErkJggg=="}}]);