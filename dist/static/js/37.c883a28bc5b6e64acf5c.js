(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"73it":function(e,t,r){"use strict";var a=r("lwsE"),o=r.n(a),s=r("II3V");t.a=new function e(){o()(this,e),this.queryAirPage=s.a.makeGet("/api/air/report/queryReportPage4User"),this.exportAirReport=s.a.makeJPost("/api/air/report/exportReport4User"),this.queryTrainPage=s.a.makeGet("/api/train/report/queryReportPage4User"),this.exportTrainReport=s.a.makeJPost("/api/train/report/exportReport4User"),this.queryHotelPage=s.a.makeGet("/api/hotel/report/queryReportPage4User"),this.exportHotelReport=s.a.makeJPost("/api/hotel/report/exportReport4User"),this.queryCarPage=s.a.makeGet("/api/car/report/queryReportPage4User"),this.exportCarReport=s.a.makeJPost("/api/car/report/exportReport4User")}},tYRz:function(e,t,r){"use strict";r.r(t);var a=r("lSNA"),i=r.n(a),o=r("o0o1"),c=r.n(o),s=r("yXPU"),p=r.n(s),u=r("Cd74"),m=r("+n12"),d=r("UMJ3"),h=r("73it"),f=r("eFjv"),b=r("38nE"),y=r("33P3");function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}var n={name:"HotelReport",components:{},setup:function(){var e=new Date;e.setDate(e.getDate()-30);var t={statisticalType:"1",dateType:"bookDate",beginTime:e.format("yyyy-MM-dd"),endTime:(new Date).format("yyyy-MM-dd 23:59:59"),orderId:"",orderStatus:"40",orderSource:"",createUser:"",guest:"",hotelName:""},r=Object.assign({page:1,pageSize:20},t),a=Object(u.e)({loading:!1,exporting:!1,exportFile:"",searchForm:t,query:r,options:{orderStatusOptions:[],refundStatusOptions:[],orderSourceOptions:[],departmentEmployeeOptions:[],statisticalType:[{code:"1",cname:"酒店订单明细"},{code:"2",cname:"酒店退单明细"}]},tableData:{records:0,page:1,rows:[]},pickerOptions1:{disabledDate:function(e){return a.searchForm.endTime?e.getTime()>new Date(a.searchForm.endTime).getTime():e.getTime()>Date.now()}},pickerOptions2:{disabledDate:function(e){return a.searchForm.beginTime&&e.getTime()<new Date(a.searchForm.beginTime).getTime()||e.getTime()>Date.now()}}});a.transTableData=Object(u.a)(function(){return a.tableData}),a.fileName=Object(u.a)(function(){var e=a.options.statisticalType.find(function(e){return e.code===a.searchForm.statisticalType});return e?e.cname:""});var o=function(){var e=p()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:f.a.getDicts({types:"HOTEL_ORDER_STATUS,HOTEL_ORDER_SOURCE,HOTEL_REFUND_STATUS"}).then(function(e){a.options.orderStatusOptions=e.data.HOTEL_ORDER_STATUS,a.options.refundStatusOptions=e.data.HOTEL_REFUND_STATUS,a.options.orderSourceOptions=e.data.HOTEL_ORDER_SOURCE}),d.a.getDepartmentEmployeeOptions().then(function(e){a.options.departmentEmployeeOptions=e.data});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),s=function(){var e=p()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.loading=!0,e.prev=1,e.next=4,h.a.queryHotelPage(a.query);case 4:t=e.sent,a.tableData=t?t.data:{records:0,page:1,rows:[]},e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.tableData={records:0,page:1,rows:[]};case 11:return e.prev=11,a.loading=!1,e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])}));return function(){return e.apply(this,arguments)}}(),n=function(){var e=p()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.query.page=1,e.next=3,s();case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=p()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object.assign(a.query,a.searchForm),e.next=3,n();case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return l(),o(),function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach(function(e){i()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},Object(u.g)(a),{firstPage:n,refreshPage:s,onSearch:l,handleSizeChange:function(e){a.query.pageSize=e},handleSortChange:function(e){var t=e.sidx,r=e.sord;a.query.sidx=t,a.query.sord=r,n()},handleCurrentChange:function(e){a.query.page=e,s()},onChangeStatisticalType:function(e){"1"===e?(a.searchForm.dateType="bookDate",a.searchForm.orderStatus="40"):"2"===e&&(a.searchForm.dateType="finishDate",a.searchForm.orderStatus="30"),l()},onDetail:function(e){Object(m.g)("#/hotel/order-detail?id=".concat(e.orderId,"&btm=0"),"/hotel/order-detail?id=".concat(e.orderId))},onExport:function(){return p()(c.a.mark(function e(){var t,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object.assign(a.query,a.searchForm),a.exporting=!0,e.prev=2,e.next=5,h.a.exportHotelReport(a.query);case 5:t=e.sent,a.exportFile=t.data,r='导出成功，请点击 <a class="font-blue" href="'.concat(b.a.getFileUrl(a.exportFile),'" download="').concat(a.fileName,'">这里 </a>下载报表'),y.a.alert(r,"提示",{type:"success",dangerouslyUseHTMLString:!0}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:return e.prev=13,a.exporting=!1,e.finish(13);case 16:case"end":return e.stop()}},e,null,[[2,11,13,16]])}))()},breakfastNumStr:function(e){return 0<e?{1:"单早",2:"双早"}[e]||"".concat(e,"早"):"无早"}})}},l=r("KHd+"),_=Object(l.a)(n,function(){var r=this,e=r.$createElement,a=r._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:r.exporting,expression:"exporting"}],staticStyle:{"min-width":"1060px"}},[a("el-form",{attrs:{model:r.searchForm,inline:"",size:"mini","label-width":"70px",onkeydown:"if(event.keyCode==13){return false;}"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.onSearch(e)}}},[a("el-row",[a("el-form-item",{attrs:{label:"日期条件",prop:"dateType","label-width":"80px"}},[a("template",{slot:"label"},["1"===r.searchForm.statisticalType?a("el-select",{staticClass:"w80",model:{value:r.searchForm.dateType,callback:function(e){r.$set(r.searchForm,"dateType",e)},expression:"searchForm.dateType"}},[a("el-option",{attrs:{value:"bookDate",label:"预订日期"}}),r._v(" "),a("el-option",{attrs:{value:"checkInDate",label:"入住日期"}}),r._v(" "),a("el-option",{attrs:{value:"checkOutDate",label:"离店日期"}})],1):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-select",{staticClass:"w80",model:{value:r.searchForm.dateType,callback:function(e){r.$set(r.searchForm,"dateType",e)},expression:"searchForm.dateType"}},[a("el-option",{attrs:{value:"createDate",label:"申请日期"}}),r._v(" "),a("el-option",{attrs:{value:"confirmDate",label:"确认日期"}}),r._v(" "),a("el-option",{attrs:{value:"finishDate",label:"完成日期"}})],1):r._e()],1),r._v(" "),a("el-date-picker",{staticClass:"w130",attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"起始日期","picker-options":r.pickerOptions1},model:{value:r.searchForm.beginTime,callback:function(e){r.$set(r.searchForm,"beginTime",e)},expression:"searchForm.beginTime"}}),r._v(" "),a("span",{staticClass:"form-label"},[r._v(" 至 ")]),r._v(" "),a("el-date-picker",{staticClass:"w130",attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd 23:59:59",placeholder:"结束日期","picker-options":r.pickerOptions2},model:{value:r.searchForm.endTime,callback:function(e){r.$set(r.searchForm,"endTime",e)},expression:"searchForm.endTime"}})],2),r._v(" "),a("el-form-item",{attrs:{label:"订单号",prop:"orderId"}},[a("el-input",{staticClass:"w130",attrs:{clearable:"",placeholder:"订单号"},model:{value:r.searchForm.orderId,callback:function(e){r.$set(r.searchForm,"orderId",e)},expression:"searchForm.orderId"}})],1),r._v(" "),a("el-form-item",{attrs:{label:"入住人",prop:"guest"}},[a("el-input",{staticClass:"w130",attrs:{clearable:"",placeholder:"所有入住人"},model:{value:r.searchForm.guest,callback:function(e){r.$set(r.searchForm,"guest",e)},expression:"searchForm.guest"}})],1),r._v(" "),a("el-form-item",{attrs:{label:" ","label-width":"15px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:r.loading},on:{click:r.onSearch}},[r._v("查 询")]),r._v(" "),a("c-delay-button",{attrs:{type:"warning",icon:"fa fa-file-excel-o"},on:{click:r.onExport}},[r._v(" 导 出\n        ")])],1)],1),r._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"酒店名称",prop:"hotelName","label-width":"80px"}},[a("el-input",{staticClass:"w282",attrs:{clearable:"",placeholder:"所有酒店"},model:{value:r.searchForm.hotelName,callback:function(e){r.$set(r.searchForm,"hotelName",e)},expression:"searchForm.hotelName"}})],1),r._v(" "),"1"===r.searchForm.statisticalType?a("el-form-item",{attrs:{label:"预订员",prop:"createUser"}},[a("c-cascader",{staticClass:"w130",attrs:{filterable:"",clearable:"",placeholder:"所有预订员",options:r.options.departmentEmployeeOptions},model:{value:r.searchForm.createUser,callback:function(e){r.$set(r.searchForm,"createUser",e)},expression:"searchForm.createUser"}})],1):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-form-item",{attrs:{label:"申请人",prop:"createUser"}},[a("c-cascader",{staticClass:"w130",attrs:{filterable:"",clearable:"",placeholder:"所有申请人",options:r.options.departmentEmployeeOptions},model:{value:r.searchForm.createUser,callback:function(e){r.$set(r.searchForm,"createUser",e)},expression:"searchForm.createUser"}})],1):r._e(),r._v(" "),a("el-form-item",{attrs:{label:"订单来源",prop:"orderSource"}},[a("el-select",{staticClass:"w130",attrs:{clearable:"",placeholder:"所有订单来源"},model:{value:r.searchForm.orderSource,callback:function(e){r.$set(r.searchForm,"orderSource",e)},expression:"searchForm.orderSource"}},r._l(r.options.orderSourceOptions,function(e){return a("el-option",{key:e.code,attrs:{value:e.code,label:e.cname}})}),1)],1),r._v(" "),"1"===r.searchForm.statisticalType?a("el-form-item",{attrs:{label:"订单状态",prop:"orderStatus"}},[a("el-select",{staticClass:"w130",attrs:{clearable:"",placeholder:"所有订单状态"},model:{value:r.searchForm.orderStatus,callback:function(e){r.$set(r.searchForm,"orderStatus",e)},expression:"searchForm.orderStatus"}},r._l(r.options.orderStatusOptions,function(e){return a("el-option",{key:e.code,attrs:{value:e.code,label:e.cname}})}),1)],1):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-form-item",{attrs:{label:"退单状态",prop:"orderStatus"}},[a("el-select",{staticClass:"w130",attrs:{clearable:"",placeholder:"所有退单状态"},model:{value:r.searchForm.orderStatus,callback:function(e){r.$set(r.searchForm,"orderStatus",e)},expression:"searchForm.orderStatus"}},r._l(r.options.refundStatusOptions,function(e){return a("el-option",{key:e.code,attrs:{value:e.code,label:e.cname}})}),1)],1):r._e()],1),r._v(" "),a("el-row",[a("el-form-item",{attrs:{label:" ","label-width":"80px"}},[a("el-radio-group",{attrs:{size:"small"},on:{change:r.onChangeStatisticalType},model:{value:r.searchForm.statisticalType,callback:function(e){r.$set(r.searchForm,"statisticalType",e)},expression:"searchForm.statisticalType"}},[r._l(r.options.statisticalType,function(e){return[a("el-radio-button",{key:e.code,attrs:{label:e.code}},[r._v(r._s(e.cname))])]})],2)],1)],1)],1),r._v(" "),a("c-page-table",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],attrs:{data:r.transTableData},on:{"size-change":r.handleSizeChange,"sort-change":r.handleSortChange,"current-change":r.handleCurrentChange}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"35"}}),r._v(" "),a("el-table-column",{attrs:{prop:"orderSourceName",label:"订单来源","min-width":"70"}}),r._v(" "),"1"===r.searchForm.statisticalType?a("el-table-column",{key:"orderId",attrs:{prop:"orderId",label:"订单号","min-width":"100"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("a",{staticClass:"font-blue",attrs:{href:"javascript:void(0)",title:"查看订单详情"},on:{click:function(e){return r.onDetail(t.row)}}},[r._v(r._s(t.row.orderId)+"\n        ")])]}}],null,!1,1059135705)}):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-table-column",{key:"refundId",attrs:{prop:"refundId",label:"退单号","min-width":"110"},scopedSlots:r._u([{key:"default",fn:function(t){return[a("a",{staticClass:"font-blue",attrs:{href:"javascript:void(0)",title:"查看退单详情"},on:{click:function(e){return r.onDetail(t.row)}}},[r._v(r._s(t.row.refundId)+"\n        ")])]}}],null,!1,1732897147)}):r._e(),r._v(" "),a("el-table-column",{attrs:{prop:"guests",label:"入住人","min-width":"90"}}),r._v(" "),a("el-table-column",{attrs:{prop:"checkInDate",label:"入离日期",width:"80"},scopedSlots:r._u([{key:"default",fn:function(e){return[a("div",[r._v(r._s(r._f("dateFormat")(e.row.checkInDate)))]),r._v(" "),a("div",[r._v(r._s(r._f("dateFormat")(e.row.checkOutDate)))])]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"hotelInfos",label:"入住酒店","min-width":"150"},scopedSlots:r._u([{key:"default",fn:function(e){return[a("div",[r._v(r._s(e.row.cityName)+" "+r._s(e.row.hotelName)+" "),e.row.agreementNo?a("span",{staticClass:"mark-policy",attrs:{title:"协议酒店"}},[r._v("协")]):r._e()])]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"roomTypeName",label:"房型/早餐",width:"70"},scopedSlots:r._u([{key:"default",fn:function(e){return[a("div",[r._v(r._s(e.row.roomTypeName))]),r._v(" "),"1"===r.searchForm.statisticalType?a("div",[r._v(r._s(r.breakfastNumStr(e.row.breakfastNum)))]):r._e()]}}])}),r._v(" "),a("el-table-column",{attrs:{prop:"roomNum",label:"间夜数",width:"50"},scopedSlots:r._u([{key:"default",fn:function(e){return["1"===r.searchForm.statisticalType?a("div",[r._v(r._s(e.row.roomNum)+"间房")]):r._e(),r._v(" "),a("div",[r._v(r._s(e.row.roomDays)+"间夜")])]}}])}),r._v(" "),"1"===r.searchForm.statisticalType?a("el-table-column",{key:"total",attrs:{prop:"total",label:"销售总价",width:"55"}}):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-table-column",{key:"refundAmount",attrs:{prop:"refundAmount",label:"应退金额",width:"55"}}):r._e(),r._v(" "),"1"===r.searchForm.statisticalType?a("el-table-column",{key:"statusName1",attrs:{prop:"statusName",label:"订单状态","min-width":"60"}}):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-table-column",{key:"statusName2",attrs:{prop:"statusName",label:"退单状态","min-width":"60"}}):r._e(),r._v(" "),a("el-table-column",{attrs:{prop:"contactName",label:"联系人","min-width":"55"}}),r._v(" "),a("el-table-column",{attrs:{prop:"contactPhone",label:"联系号码","min-width":"55"}}),r._v(" "),"1"===r.searchForm.statisticalType?a("el-table-column",{key:"createUserName1",attrs:{prop:"createUserName",label:"预订员","min-width":"55"}}):r._e(),r._v(" "),"1"===r.searchForm.statisticalType?a("el-table-column",{key:"createTime1",attrs:{prop:"createTime",label:"预订时间","min-width":"120",sortable:"custom"},scopedSlots:r._u([{key:"default",fn:function(e){return[r._v("\n        "+r._s(r._f("datetimeFormat")(e.row.createTime))+"\n      ")]}}],null,!1,1342051511)}):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-table-column",{key:"createUserName2",attrs:{prop:"createUserName",label:"申请人","min-width":"55"}}):r._e(),r._v(" "),"2"===r.searchForm.statisticalType?a("el-table-column",{key:"finishTime",attrs:{prop:"finishTime",label:"退单完成时间","min-width":"120",sortable:"custom"},scopedSlots:r._u([{key:"default",fn:function(e){return[r._v("\n        "+r._s(r._f("datetimeFormat")(e.row.finishTime))+"\n      ")]}}],null,!1,1005384800)}):r._e()],1)],1)},[],!1,null,"70d91f13",null);t.default=_.exports}}]);