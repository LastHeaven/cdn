(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"1K6+":function(e,t,a){"use strict";a.r(t);var r=a("lSNA"),c=a.n(r),n=a("o0o1"),u=a.n(n),i=a("yXPU"),p=a.n(i),o=a("RIqP"),f=a.n(o),v=a("Cd74"),m=a("jxIu"),d=a("LLJ0"),y=a("meKF");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var s={name:"Modify",props:{data:{type:Object,default:function(){return{id:null,title:null,detail:null}}}},setup:function(e,t){var a=t.emit,r=Object(v.e)({$form:{},loading:!0,visible:!0,dialog:{tag:"",data:{}},delivery:!0,activeNames:["1"],form:{id:null,companyId:null,type:"AIR",position:null,policy:{km:800,cabin:["经济舱"],hours:null,dueDay:1,refund:null,priceLimit:0,violation:0,discount:10,reschedule:null,employeeLevel:null,employeeLevelName:null},status:1},options:{levelList:[{value:"普通员工",label:"普通员工"},{value:"经理级别",label:"经理级别"},{value:"主管级别",label:"主管级别"}],beforeHoursOption:[{value:"选项1",label:"1小时"},{value:"选项2",label:"2小时"},{value:"选项3",label:"3小时"},{value:"选项4",label:"4小时"}]}}),n=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.queryPositionLevelTree();case 2:t=e.sent,r.options.levelList=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),i=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:r.form.id,type:r.form.type,position:r.form.position,status:r.form.status,policy:JSON.stringify(r.form.policy)},e.next=3,y.a.save(t);case 3:e.sent.data&&(r.visible=!1,a("ok"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return n(),null!==e.data.detail&&(r.form=e.data.detail),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(r),{rules:{employeeLevel:[{required:!0,message:"请选择员工级别",trigger:"change"}],cabin:[{type:"array",required:!0,message:"请至少选择一个预订舱",trigger:"change"}],priceLimit:[{required:!0,message:"请选择最低价限制",trigger:"change"}],dueDay:[].concat(f()(m.a.notEmpty),f()(m.a.positiveNumber),f()(m.a.integer)),km:[].concat(f()(m.a.positiveNumber),f()(m.a.integer)),discount:[].concat(f()(m.a.positiveNumber),f()(m.a.integer)),refund:[].concat(f()(m.a.positiveNumber),f()(m.a.integer)),reschedule:[].concat(f()(m.a.positiveNumber),f()(m.a.integer))},submit:function(){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r.$form.validate(),e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 8:return e.next=10,i();case 10:case"end":return e.stop()}},e,null,[[0,4]])}))()},onClose:function(){r.visible=!1,a("close")}})}},b=(a("OOrr"),a("KHd+")),_=Object(b.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:t.data.title,loading:t.loading,visible:t.visible,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(e){t.visible=e},close:t.onClose}},[a("el-form",{ref:"$form",attrs:{size:"mini",model:t.form,rules:t.rules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"政策适用员工级别："}},[a("el-col",{attrs:{span:6}},[a("c-select-tree",{staticClass:"w200",attrs:{treeData:t.options.levelList,clearable:"",filterable:"",props:{value:"id",label:"levelName",children:"children"}},model:{value:t.form.position,callback:function(e){t.$set(t.form,"position",e)},expression:"form.position"}})],1),t._v(" "),a("el-col",{attrs:{span:16}},[a("span",{staticClass:"info el-icon-info"},[t._v(" 不选择表示所有人适用，每个级别只能适用一个差旅政策")])])],1),t._v(" "),a("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:"预订政策",name:"1"}},[a("el-form-item",{attrs:{label:"可预订舱等：",prop:"policy.cabin",rules:t.rules.cabin}},[a("el-checkbox-group",{model:{value:t.form.policy.cabin,callback:function(e){t.$set(t.form.policy,"cabin",e)},expression:"form.policy.cabin"}},[a("el-checkbox",{attrs:{label:"经济舱",name:"cabin"}}),t._v(" "),a("el-checkbox",{attrs:{label:"公务舱",name:"cabin"}}),t._v(" "),a("el-checkbox",{attrs:{label:"头等舱",name:"cabin"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"可预订折扣：",prop:"discount",rules:t.rules.discount}},[t._v("\n            不能高于\n            "),a("el-input-number",{attrs:{min:1,max:10,precision:1,maxlength:"3"},model:{value:t.form.policy.discount,callback:function(e){t.$set(t.form.policy,"discount",e)},expression:"form.policy.discount"}}),t._v("\n            折\n            "),a("span",{staticClass:"info el-icon-info"},[t._v(" 不填表示任何折扣都可以预订")])],1),t._v(" "),a("el-form-item",{attrs:{label:"机票提前预订天数：",prop:"policy.dueDay",rules:t.rules.dueDay}},[a("el-input-number",{attrs:{min:1,max:90,maxlength:"2"},model:{value:t.form.policy.dueDay,callback:function(e){t.$set(t.form.policy,"dueDay",e)},expression:"form.policy.dueDay"}}),t._v("\n            天\n          ")],1),t._v(" "),a("el-form-item",{attrs:{label:"限制公里数：",rules:t.rules.km,prop:"km"}},[a("el-col",{attrs:{span:3}},[a("el-input",{model:{value:t.form.policy.km,callback:function(e){t.$set(t.form.policy,"km",t._n(e))},expression:"form.policy.km"}})],1),t._v(" "),a("el-col",{attrs:{span:20}},[a("span",{staticClass:"info el-icon-info"},[t._v(" 不填，表示不限制。例800公里，表示距离超过800公里才可以预订机票")])])],1)],1),t._v(" "),a("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:" 退票和改期政策",name:"2"}},[a("el-form-item",{attrs:{label:"可退票费上限：",rules:t.rules.refund,prop:"refund"}},[a("el-input",{staticClass:"w100",attrs:{placeholder:"不限",maxlength:"10"},model:{value:t.form.policy.refund,callback:function(e){t.$set(t.form.policy,"refund",e)},expression:"form.policy.refund"}}),t._v("\n            元\n            "),a("span",{staticClass:"info el-icon-info"},[t._v(" 如果退票费超过上限则需要审批。不限则不需要处理")])],1),t._v(" "),a("el-form-item",{attrs:{label:"可改期费上限：",rules:t.rules.reschedule,prop:"reschedule"}},[a("el-input",{staticClass:"w100",attrs:{placeholder:"不限",maxlength:"10"},model:{value:t.form.policy.reschedule,callback:function(e){t.$set(t.form.policy,"reschedule",e)},expression:"form.policy.reschedule"}}),t._v("\n            元\n            "),a("span",{staticClass:"info el-icon-info"},[t._v(" 如果改期费超过上限则需要审批。不限则不需要处理")])],1)],1),t._v(" "),a("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:" 超标管控",name:"3"}},[a("el-form-item",{attrs:{label:"超标管理："}},[a("div",[a("el-radio",{attrs:{label:0},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("不可以超标 ( 如果超标显示价格，但不能预订)")])],1),t._v(" "),a("div",[a("el-radio",{staticClass:"elRadio",attrs:{label:1},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("可以超标 ，不需要审批，但需要填写超标原因，并统计在管理报告中")])],1),t._v(" "),a("div",[a("el-radio",{staticClass:"elRadio",attrs:{label:2},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("可以超标 ，需要审批，但需要填写超标原因，并统计在管理报告中")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"状态：",prop:"status"}},[a("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-radio",{attrs:{label:1}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("禁用")])],1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:t.submit}},[t._v(" 保存")]),t._v(" "),a("el-button",{attrs:{icon:"iconfont icon-close"},on:{click:t.onClose}},[t._v(" 关闭")])],1)],1)],1)},[],!1,null,"bf73c83c",null).exports,h=a("33P3");function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var O={components:{Modify:_},name:"PlaneTicket",setup:function(){var r=Object(v.e)({dialog:{tag:"",data:{}},policyList:[]}),e=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.queryList();case 2:t=e.sent,r.policyList=t.data.filter(function(e){return"AIR"===e.type}),r.policyList.forEach(function(e){e.policy=JSON.parse(e.policy)});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return e(),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(r),{getQueryList:e,onAdd:function(){r.dialog.tag="Modify",r.dialog.data={title:"新增政策",detail:null}},onModify:function(e){r.dialog.tag="Modify",r.dialog.data={title:"修改政策",detail:e}},remove:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.confirm("确认要删除这条政策吗？","提示",{type:"warning"});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 9:return e.next=11,y.a.deleteById({id:a});case 11:r.policyList.splice(t,1);case 12:case"end":return e.stop()}},e,null,[[0,5]])}))()},updateStatus:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.updateStatus({id:t,status:a});case 2:case"end":return e.stop()}},e)}))()}})}},x=(a("Sd5M"),Object(b.a)(O,function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{},[n("div",{staticClass:"margin-bottom"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:r.onAdd}},[r._v("新增")])],1),r._v(" "),n("div",{staticClass:"clearfix"},r._l(r.policyList,function(t,a){return n("el-card",{key:a,staticClass:"border-style"},[n("el-form",{ref:"form",refInFor:!0,attrs:{"label-width":"120px",size:"mini"}},[n("el-form-item",{attrs:{label:"职务级别"}},[n("span",{staticClass:"item"},[r._v(r._s(t.positionName||"不限"))])]),r._v(" "),n("el-form-item",{attrs:{label:"可预订舱等"}},[n("span",{staticClass:"item"},[r._v(r._s(t.policy?(t.policy.cabin||[]).join(","):null))])]),r._v(" "),n("el-form-item",{attrs:{label:"可预订折扣"}},[n("span",{staticClass:"item"},[r._v("不高于"+r._s(t.policy.discount)+"折")])]),r._v(" "),n("el-form-item",{attrs:{label:"提前预订天数"}},[n("span",{staticClass:"item"},[r._v(r._s(t.policy.dueDay)+"天")])]),r._v(" "),n("el-form-item",{attrs:{label:"是否可超标"}},[n("span",{staticClass:"item"},[r._v(r._s(0<t.policy.violation?"是":"否"))])]),r._v(" "),n("el-form-item",{attrs:{label:"状态"}},[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},on:{change:function(e){return r.updateStatus(t.id,e)}},model:{value:t.status,callback:function(e){r.$set(t,"status",e)},expression:"item.status"}})],1),r._v(" "),n("el-button",{attrs:{type:"text",title:"编辑"},on:{click:function(e){return r.onModify(t)}}},[n("i",{staticClass:"el-icon-edit-outline font-blue font-size18"})]),r._v(" "),n("el-button",{staticClass:"float-right",attrs:{type:"text",title:"删除"},on:{click:function(e){return r.remove(a,t.id)}}},[n("i",{staticClass:"el-icon-delete font-red font-size18"})])],1)],1)}),1),r._v(" "),n(r.dialog.tag,{tag:"component",attrs:{data:r.dialog.data},on:{ok:r.getQueryList,close:function(e){r.dialog.tag=""}}})],1)},[],!1,null,"7040ecf6",null).exports);function k(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var w={name:"TrainTicketModify",props:{data:{type:Object,default:function(){return{id:null,title:null,detail:null}}}},setup:function(e,t){var r=t.emit,n=Object(v.e)({$form:{},loading:!0,visible:!0,dialog:{tag:"",data:{}},delivery:!0,activeNames:["1"],form:{id:null,companyId:null,type:"TRAIN",position:null,policy:{gcdSeat:[],otherSeat:[],hours:null,violation:0,employeeLevel:null,employeeLevelName:null},status:1},options:{levelList:[{value:"普通员工",label:"普通员工"},{value:"经理级别",label:"经理级别"},{value:"主管级别",label:"主管级别"}],beforeHoursOption:[{value:"选项1",label:"1小时"},{value:"选项2",label:"2小时"},{value:"选项3",label:"3小时"},{value:"选项4",label:"4小时"}],gcdSeatOption:[{value:"EDZ",label:"二等座"},{value:"YDZ",label:"一等座"},{value:"SWZ",label:"商务座"},{value:"TDZ",label:"特等座"},{value:"YDW",label:"一等卧"},{value:"EDW",label:"二等卧"},{value:"GJDW",label:"高级动卧"},{value:"YRRB",label:"一人软包"},{value:"WZ",label:"无座"}],otherSeatOption:[{value:"YZ",label:"硬座"},{value:"RZ",label:"软座"},{value:"YW",label:"硬卧"},{value:"RW",label:"软卧"},{value:"BXYW",label:"包厢硬卧"},{value:"GJRW",label:"高级软卧"},{value:"YDRZ",label:"一等软座"},{value:"EDRZ",label:"二等软座"},{value:"SWZ",label:"商务座"},{value:"WZ",label:"无座"}]}}),a=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.queryPositionLevelTree();case 2:t=e.sent,n.options.levelList=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),i=function(){var e=p()(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===(t=n.form.policy).gcdSeat.length&&0===t.otherSeat.length)return h.a.warning("请至少选择一个席别"),e.abrupt("return");e.next=4;break;case 4:return a={id:n.form.id,type:n.form.type,position:n.form.position,status:n.form.status,policy:JSON.stringify(n.form.policy)},e.next=7,y.a.save(a);case 7:e.sent.data&&(n.visible=!1,r("ok"));case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return a(),null!==e.data.detail&&(n.form=e.data.detail),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?k(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(n),{rules:{employeeLevel:[{required:!0,message:"请选择员工级别",trigger:"change"}]},submit:function(){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n.$form.validate(),e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 8:return e.next=10,i();case 10:case"end":return e.stop()}},e,null,[[0,4]])}))()},onClose:function(){n.visible=!1,r("close")}})}};a("gyHC");function j(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var C={components:{TrainTicketModify:Object(b.a)(w,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modify"},[a("el-dialog",{attrs:{title:t.data.title,loading:t.loading,visible:t.visible,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(e){t.visible=e},close:t.onClose}},[a("el-form",{ref:"$form",attrs:{model:t.form,rules:t.rules,size:"mini","label-width":"165px"}},[a("el-form-item",{attrs:{label:"政策适用员工级别："}},[a("el-col",{attrs:{span:6}},[a("c-select-tree",{staticClass:"w200",attrs:{treeData:t.options.levelList,clearable:"",props:{value:"id",label:"levelName",children:"children"}},model:{value:t.form.position,callback:function(e){t.$set(t.form,"position",e)},expression:"form.position"}})],1),t._v(" "),a("el-col",{attrs:{span:16}},[a("span",{staticClass:"info el-icon-info"},[t._v(" 不选择表示所有人适用，每个级别只能适用一个差旅政策")])])],1),t._v(" "),a("el-collapse",{staticClass:"borderNone",model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:"预订政策",name:"1"}},[a("el-form-item",{attrs:{label:"G/C/D 高铁/城际/动车：",prop:"policy.gcdSeat",rules:t.rules.cabin}},[a("el-checkbox-group",{model:{value:t.form.policy.gcdSeat,callback:function(e){t.$set(t.form.policy,"gcdSeat",e)},expression:"form.policy.gcdSeat"}},t._l(t.options.gcdSeatOption,function(e){return a("el-checkbox",{key:e.value,attrs:{value:e.value,label:e.value}},[t._v(t._s(e.label)+"\n              ")])}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"其他列车：",prop:"policy.cabin",rules:t.rules.otherSeat}},[a("el-checkbox-group",{model:{value:t.form.policy.otherSeat,callback:function(e){t.$set(t.form.policy,"otherSeat",e)},expression:"form.policy.otherSeat"}},t._l(t.options.otherSeatOption,function(e){return a("el-checkbox",{key:e.value,attrs:{value:e.value,label:e.value}},[t._v(t._s(e.label)+"\n              ")])}),1)],1)],1),t._v(" "),a("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:" 超标管控",name:"3"}},[a("el-form-item",{attrs:{label:"超标管理："}},[a("div",[a("el-radio",{staticClass:"elRadio",attrs:{label:0},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("不可以超标 ( 如果超标显示价格，但不能预订)")])],1),t._v(" "),a("div",[a("el-radio",{staticClass:"elRadio",attrs:{label:1},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("可以超标 ，不需要审批，但需要填写违规原因，并统计在管理报告中")])],1),t._v(" "),a("div",[a("el-radio",{staticClass:"elRadio",attrs:{label:2},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("可以超标 ，需要审批，但需要填写违规原因，并统计在管理报告中")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"状态：",prop:"status"}},[a("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-radio",{attrs:{label:1}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("禁用")])],1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:t.submit}},[t._v(" 保存")]),t._v(" "),a("el-button",{attrs:{icon:"iconfont icon-close"},on:{click:t.onClose}},[t._v(" 关闭")])],1)],1)],1)},[],!1,null,"5952e75f",null).exports},name:"TrainTicket",setup:function(){var r=Object(v.e)({dialog:{tag:"",data:{}},policyList:[]}),e=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.queryList();case 2:t=e.sent,r.policyList=t.data.filter(function(e){return"TRAIN"===e.type}),r.policyList.forEach(function(e){e.policy=JSON.parse(e.policy)});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return e(),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?j(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(r),{getQueryList:e,onAdd:function(){r.dialog.tag="TrainTicketModify",r.dialog.data={title:"新增火车票差旅政策",detail:null}},onModify:function(e){r.dialog.tag="TrainTicketModify",r.dialog.data={title:"修改火车票差旅政策",detail:e}},remove:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.confirm("确认要删除这条政策吗？","提示",{type:"warning"});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 9:return e.next=11,y.a.deleteById({id:a});case 11:r.policyList.splice(t,1);case 12:case"end":return e.stop()}},e,null,[[0,5]])}))()},updateStatus:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.updateStatus({id:t,status:a});case 2:case"end":return e.stop()}},e)}))()},gcdSeatFilter:function(e){var t={EDZ:"二等座",YDZ:"一等座",SWZ:"商务座",TDZ:"特等座",YDW:"一等卧",EDW:"二等卧",GJDW:"高级动卧",YRRB:"一人软包",WZ:"无座"};return e.map(function(e){return t[e]||e})},otherSeatFilter:function(e){var t={YZ:"硬座",RZ:"软座",YW:"硬卧",RW:"软卧",BXYW:"包厢硬卧",GJRW:"高级软卧",YDRZ:"一等软座",EDRZ:"二等软座",SWZ:"商务座",WZ:"无座"};return e.map(function(e){return t[e]||e})}})}},L=(a("3cYP"),Object(b.a)(C,function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{},[n("div",{staticClass:"margin-bottom"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:r.onAdd}},[r._v("新增")])],1),r._v(" "),n("div",{staticClass:"clearfix"},r._l(r.policyList,function(t,a){return n("el-card",{key:a,staticClass:"border-style",attrs:{lg:6,md:8,sm:12}},[n("el-form",{ref:"form",refInFor:!0,attrs:{"label-width":"120px",size:"mini"}},[n("el-form-item",{attrs:{label:"职务级别"}},[n("span",{staticClass:"item"},[r._v(r._s(t.positionName||"不限"))])]),r._v(" "),n("el-form-item",{attrs:{label:"高铁/城际/动车"}},[n("span",{staticClass:"item"},[r._v(r._s(t.policy?r.gcdSeatFilter(t.policy.gcdSeat||[]).join(","):null))])]),r._v(" "),n("el-form-item",{attrs:{label:"其他列车"}},[n("span",{staticClass:"item"},[r._v(r._s(t.policy?r.otherSeatFilter(t.policy.otherSeat||[]).join(","):null))])]),r._v(" "),n("el-form-item",{attrs:{label:"是否可超标"}},[n("span",{staticClass:"item"},[r._v(r._s(0<t.policy.violation?"是":"否"))])]),r._v(" "),n("el-form-item",{attrs:{label:"状态"}},[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},on:{change:function(e){return r.updateStatus(t.id,e)}},model:{value:t.status,callback:function(e){r.$set(t,"status",e)},expression:"item.status"}})],1),r._v(" "),n("el-button",{attrs:{type:"text",title:"编辑"},on:{click:function(e){return r.onModify(t)}}},[n("i",{staticClass:"el-icon-edit-outline font-blue font-size18"})]),r._v(" "),n("el-button",{staticClass:"float-right",attrs:{type:"text",title:"删除"},on:{click:function(e){return r.remove(a,t.id)}}},[n("i",{staticClass:"el-icon-delete font-red font-size18"})])],1)],1)}),1),r._v(" "),n(r.dialog.tag,{tag:"component",attrs:{data:r.dialog.data},on:{ok:r.getQueryList,close:function(e){r.dialog.tag=""}}})],1)},[],!1,null,"8b8fcb8e",null).exports);function P(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var N={name:"TrainTicketModify",props:{data:{type:Object,default:function(){return{id:null,title:null,detail:null}}}},setup:function(e,t){function a(){r("close")}var r=t.emit,n=Object(v.e)({$form:{},loading:!1,delivery:!0,activeNames:["1","2"],form:{id:null,companyId:null,type:"HOTEL",position:null,policy:{cityLimitList:[{level:1,amount:null},{level:2,amount:null},{level:3,amount:null},{level:99,amount:null}],bookRule:0,violation:0,employeeLevel:null,employeeLevelName:null},status:1},options:{levelList:[{value:"普通员工",label:"普通员工"},{value:"经理级别",label:"经理级别"},{value:"主管级别",label:"主管级别"}]}}),i=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.queryPositionLevelTree();case 2:t=e.sent,n.options.levelList=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),o=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:n.form.id,type:n.form.type,position:n.form.position,status:n.form.status,policy:JSON.stringify(n.form.policy)},e.next=3,y.a.save(t);case 3:e.sent.data&&(r("ok"),a());case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return i(),null!==e.data.detail&&(e.data.cityLimitList||(e.data.cityLimitList=[{level:1,amount:null},{level:2,amount:null},{level:3,amount:null},{level:99,amount:null}]),n.form=e.data.detail),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?P(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(n),{rules:{employeeLevel:[{required:!0,message:"请选择员工级别",trigger:"change"}],cityAmount:[].concat(f()(m.a.notEmpty),f()(m.a.positiveNumber),f()(m.a.integer))},submit:function(){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n.$form.validate(),e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 8:return e.next=10,o();case 10:case"end":return e.stop()}},e,null,[[0,4]])}))()},onClose:function(){a()},levelFilter:function(e){return{1:"一线",2:"二线",3:"三线",4:"四线",5:"五线",6:"六线",7:"七线",8:"八线",9:"九线",10:"十线",99:"其他"}[e]||""}})}},S=(a("LhRm"),Object(b.a)(N,function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"modify"},[r("el-form",{ref:"$form",attrs:{size:"mini",model:a.form,rules:a.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"政策适用员工级别：","label-width":"165px"}},[r("el-col",{attrs:{span:6}},[r("c-select-tree",{attrs:{treeData:a.options.levelList,clearable:"",props:{value:"id",label:"levelName",children:"children"}},model:{value:a.form.position,callback:function(e){a.$set(a.form,"position",e)},expression:"form.position"}})],1),a._v(" "),r("el-col",{attrs:{span:18}},[r("span",{staticClass:"info el-icon-info"},[a._v(" 不选择表示所有人适用，每个级别只能适用一个差旅政策")])])],1),a._v(" "),r("el-collapse",{model:{value:a.activeNames,callback:function(e){a.activeNames=e},expression:"activeNames"}},[r("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:"预订政策",name:"1"}},[r("div",{staticClass:"padding-lr"},[r("el-table",{staticClass:"el-easy-ui-table w350",attrs:{data:a.form.policy.cityLimitList,border:""}},[r("el-table-column",{attrs:{label:"城市分类",type:"index",width:"150"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n                "+a._s(a.levelFilter(e.row.level))+"城市\n              ")]}}])}),a._v(" "),r("el-table-column",{attrs:{label:"差旅标准(元)","min-width":"55",prop:"passengerName"},scopedSlots:a._u([{key:"default",fn:function(t){return[r("el-form-item",{attrs:{rules:a.rules.cityAmount,"label-width":"0"}},[r("el-input",{attrs:{clearable:"",maxlength:"10"},model:{value:t.row.amount,callback:function(e){a.$set(t.row,"amount",e)},expression:"scope.row.amount"}})],1)]}}])})],1)],1)]),a._v(" "),r("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:" 超标管控",name:"2"}},[r("el-form-item",{attrs:{label:"预订规则："}},[r("el-radio-group",{model:{value:a.form.policy.bookRule,callback:function(e){a.$set(a.form.policy,"bookRule",e)},expression:"form.policy.bookRule"}},[r("el-radio",{attrs:{label:0}},[a._v("按订单（若一个订单中有不同职级，则按最高职差标级判断是否超标）")]),r("br")],1)],1),a._v(" "),r("el-form-item",{attrs:{label:"超标管理："}},[r("div",[r("el-radio",{attrs:{label:0},model:{value:a.form.policy.violation,callback:function(e){a.$set(a.form.policy,"violation",e)},expression:"form.policy.violation"}},[a._v("不可以超标 ( 如果超标显示价格，但不能预订)")])],1),a._v(" "),r("div",[r("el-radio",{attrs:{label:1},model:{value:a.form.policy.violation,callback:function(e){a.$set(a.form.policy,"violation",e)},expression:"form.policy.violation"}},[a._v("可以超标 ，不需要审批，但需要填写违规原因，并统计在管理报告中")])],1),a._v(" "),r("div",[r("el-radio",{attrs:{label:2},model:{value:a.form.policy.violation,callback:function(e){a.$set(a.form.policy,"violation",e)},expression:"form.policy.violation"}},[a._v("可以超标 ，需要审批，但需要填写违规原因，并统计在管理报告中")])],1)]),a._v(" "),r("el-form-item",{attrs:{label:"状态：",prop:"status"}},[r("el-radio-group",{model:{value:a.form.status,callback:function(e){a.$set(a.form,"status",e)},expression:"form.status"}},[r("el-radio",{attrs:{label:1}},[a._v("启用")]),a._v(" "),r("el-radio",{attrs:{label:0}},[a._v("禁用")])],1)],1)],1)],1)],1),a._v(" "),r("div",{staticClass:"padding-top text-center"},[r("el-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:a.submit}},[a._v(" 保存")]),a._v(" "),r("el-button",{attrs:{icon:"iconfont icon-close"},on:{click:a.onClose}},[a._v(" 关闭")])],1)],1)},[],!1,null,"85d9fcb6",null).exports),T=a("II3V"),D={queryList:T.a.makeGet("/api/tmc/cityLevel/queryList"),queryUnClassifyList:T.a.makeGet("/api/tmc/cityLevel/queryUnClassifyList"),save:T.a.makeJPost("/api/tmc/cityLevel/save")};function E(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var M={name:"CityTransfer",props:{data:{type:Object,default:function(){return{title:String,level:String}}}},setup:function(e,t){var a=t.emit,i=Object(v.e)({visible:!0,searchForm:{level:"",province:"",cityName:""},form:{cities:[]},options:{cities:[]}}),r=function(){var e=p()(u.a.mark(function e(){var a,t,r,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.next=3,D.queryUnClassifyList();case 3:return(t=e.sent).data&&t.data.forEach(function(e,t){a.push({cityEnName:e.cityEnName,provinceName:e.provinceName,provinceEnName:e.provinceEnName,label:e.cityName,key:e.cityId})}),e.next=7,D.queryList({level:i.searchForm.level});case 7:(r=e.sent).data&&(n=[],r.data.forEach(function(e,t){"-1"!==e.companyId&&a.push({cityEnName:e.cityEnName,provinceName:e.provinceName,provinceEnName:e.provinceEnName,label:e.cityName+" √",key:e.cityId}),n.push(e.cityId)}),i.form.cities=n),i.options.cities=a;case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),n=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={level:i.searchForm.level,cityIdList:i.form.cities},e.next=3,D.save(t);case 3:e.sent.data&&(i.visible=!1,a("ok"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return i.searchForm.level=e.data.level,r(),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?E(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(i),{onClose:function(){a("close")},filterMethod:function(e,t){return t&&(-1<t.label.indexOf(e)||-1<t.cityEnName.indexOf(e)||-1<t.provinceName.indexOf(e)||-1<t.provinceEnName.indexOf(e))},submit:function(){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.next=7;break;case 3:return e.prev=3,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 7:return e.next=9,n();case 9:case"end":return e.stop()}},e,null,[[0,3]])}))()}})}};function $(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var R={components:{CityTransfer:Object(b.a)(M,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"$form",attrs:{inline:"","label-width":"80px",model:t.form,size:"mini"}}),t._v(" "),a("div",[a("el-transfer",{staticClass:"transfer-1",attrs:{"button-texts":["删除","添加"],filterable:"","filter-placeholder":"城市、省份过滤","filter-method":t.filterMethod,titles:["备选城市","已选城市"],data:t.options.cities},model:{value:t.form.cities,callback:function(e){t.$set(t.form,"cities",e)},expression:"form.cities"}})],1),t._v(" "),a("div",{staticClass:"padding-top text-center"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:t.submit}},[t._v(" 保存")]),t._v(" "),a("el-button",{attrs:{icon:"iconfont icon-close"},on:{click:t.onClose}},[t._v(" 关闭")])],1)],1)},[],!1,null,null,null).exports,HotelModify:S},name:"Hotel",setup:function(){var i=Object(v.e)({hotelModify:{visible:!1,title:"",data:{}},cityTransfer:{visible:!1,title:"",data:{}},policyList:[],levelCityList:{level1CityName:[],level2CityName:[],level3CityName:[],level99CityName:[]}}),e=function(){var e=p()(u.a.mark(function e(){var t,a,r,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.queryList();case 2:return t=e.sent,i.policyList=t.data.filter(function(e){return"HOTEL"===e.type}),i.policyList.forEach(function(e){e.policy=JSON.parse(e.policy)}),e.next=7,D.queryList({level:"1"});case 7:return(a=e.sent).data&&(i.levelCityList.level1CityName=a.data.map(function(e){return e.cityName})),e.next=11,D.queryList({level:"2"});case 11:return(r=e.sent).data&&(i.levelCityList.level2CityName=r.data.map(function(e){return e.cityName})),e.next=15,D.queryList({level:"3"});case 15:(n=e.sent).data&&(i.levelCityList.level3CityName=n.data.map(function(e){return e.cityName}));case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return e(),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?$(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(i),{getQueryList:e,onAdd:function(){i.hotelModify.visible=!0,i.hotelModify.title="新增酒店差旅政策",i.hotelModify.data={detail:null}},onModify:function(e){i.hotelModify.visible=!0,i.hotelModify.title="修改酒店差旅政策",i.hotelModify.data={detail:e}},remove:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.confirm("确认要删除这条政策吗？","提示",{type:"warning"});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 9:return e.next=11,y.a.deleteById({id:a});case 11:i.policyList.splice(t,1);case 12:case"end":return e.stop()}},e,null,[[0,5]])}))()},updateStatus:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.updateStatus({id:t,status:a});case 2:case"end":return e.stop()}},e)}))()},levelFilter:function(e){return{1:"一线城市",2:"二线城市",3:"三线城市",4:"四线城市",5:"五线城市",6:"六线城市",7:"七线城市",8:"八线城市",9:"九线城市",10:"十线城市",99:"其他城市"}[e]||""},onShowCities:function(e){i.cityTransfer.visible=!0,i.cityTransfer.title=this.levelFilter(e),i.cityTransfer.data={level:e,title:i.cityTransfer.title+"设置"}}})}},I=(a("qEDq"),Object(b.a)(R,function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{},[n("div",{staticClass:"margin-bottom"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:r.onAdd}},[r._v("新增")])],1),r._v(" "),n("div",{staticClass:"clearfix"},r._l(r.policyList,function(t,a){return n("el-card",{key:a,staticClass:"border-style",attrs:{shadow:"always"}},[n("el-form",{ref:"form",refInFor:!0,attrs:{"label-width":"80px",size:"mini"}},[n("el-form-item",{attrs:{label:"职务级别"}},[n("span",{staticClass:"item"},[r._v(r._s(t.positionName||"不限"))])]),r._v(" "),n("el-form-item",{attrs:{label:"酒店标准"}},[n("table",[n("tbody",r._l(t.policy.cityLimitList,function(e,t){return n("tr",{key:t},[n("th",{staticClass:"w80"},[r._v(r._s(r.levelFilter(e.level)))]),r._v(" "),n("td",{staticClass:"w100"},[r._v(r._s(e.amount)+"元")])])}),0)])]),r._v(" "),n("el-form-item",{attrs:{label:"超标管控"}},[n("span",{staticClass:"item"},[r._v("员工预订超标部分个人承担")])]),r._v(" "),n("el-form-item",{attrs:{label:"状态"}},[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},on:{change:function(e){return r.updateStatus(t.id,e)}},model:{value:t.status,callback:function(e){r.$set(t,"status",e)},expression:"item.status"}})],1),r._v(" "),n("el-button",{attrs:{type:"text",title:"编辑"},on:{click:function(e){return r.onModify(t)}}},[n("i",{staticClass:"el-icon-edit-outline font-blue font-size18"})]),r._v(" "),n("el-button",{staticClass:"float-right",attrs:{type:"text",title:"删除"},on:{click:function(e){return r.remove(a,t.id)}}},[n("i",{staticClass:"el-icon-delete font-red font-size18"})])],1)],1)}),1),r._v(" "),n("div",[n("el-card",[n("table",{staticClass:"easy-ui-table text-center"},[n("thead",[n("tr",[n("th",{staticClass:"w80"},[r._v("城市分类")]),r._v(" "),n("th",{staticClass:"w120"},[r._v("适用城市")])])]),r._v(" "),n("tbody",[n("tr",[n("td",[r._v("一线城市  "),n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return r.onShowCities("1")}}},[r._v("修改")])]),r._v(" "),n("td",{attrs:{align:"left"}},[r._v("\n              "+r._s(r.levelCityList.level1CityName.join("、"))+"\n            ")])]),r._v(" "),n("tr",[n("td",[r._v("二线城市\n              "),n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return r.onShowCities("2")}}},[r._v("修改")])]),r._v(" "),n("td",{attrs:{align:"left"}},[r._v("\n              "+r._s(r.levelCityList.level2CityName.join("、"))+"\n            ")])]),r._v(" "),n("tr",[n("td",[r._v("三线城市\n              "),n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return r.onShowCities("3")}}},[r._v("修改")])]),r._v(" "),n("td",{attrs:{align:"left"}},[r._v("\n              "+r._s(r.levelCityList.level3CityName.join("、"))+"\n            ")])]),r._v(" "),n("tr",[n("td",[r._v("其它")]),r._v(" "),n("td",{attrs:{align:"left"}},[r._v("\n              其他城市\n            ")])])])])])],1),r._v(" "),n("el-dialog",{attrs:{title:r.hotelModify.title,visible:r.hotelModify.visible,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(e){return r.$set(r.hotelModify,"visible",e)}}},[r.hotelModify.visible?n("hotel-modify",{attrs:{data:r.hotelModify.data},on:{close:function(e){r.hotelModify.visible=!1},ok:r.getQueryList}}):r._e()],1),r._v(" "),n("el-dialog",{attrs:{title:r.cityTransfer.title,visible:r.cityTransfer.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){return r.$set(r.cityTransfer,"visible",e)}}},[r.cityTransfer.visible?n("city-transfer",{attrs:{data:r.cityTransfer.data},on:{close:function(e){r.cityTransfer.visible=!1}}}):r._e()],1)],1)},[],!1,null,"8cab9d48",null).exports),A=a("eFjv");function q(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var z={name:"Modify",props:{data:{type:Object,default:function(){return{id:null,title:null,detail:null}}}},setup:function(e,t){function a(){r("close")}var r=t.emit,n=Object(v.e)({$form:{},loading:!1,delivery:!0,activeNames:["1","2"],form:{id:null,companyId:null,type:"CAR",position:null,policy:{bookRule:0,violation:0,employeeLevel:null,employeeLevelName:null,carServiceType:[],carLevel:[]},status:1},options:{carServiceType:[],carLevel:[],levelList:[]}}),i=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.queryPositionLevelTree();case 2:t=e.sent,n.options.levelList=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),o=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.getDict({type:"CAR_SERVICE_TYPE"});case 2:t=e.sent,n.options.carServiceType=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.getDict({type:"CAR_LEVEL"});case 2:t=e.sent,n.options.carLevel=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),s=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:n.form.id,type:n.form.type,position:n.form.position,status:n.form.status,policy:JSON.stringify(n.form.policy)},e.next=3,y.a.save(t);case 3:e.sent.data&&(r("ok"),a());case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return i(),o(),l(),i(),null!==e.data.detail&&Object.assign(n.form,e.data.detail),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?q(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):q(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(n),{rules:{employeeLevel:[{required:!0,message:"请选择员工级别",trigger:"change"}],cityAmount:[].concat(f()(m.a.notEmpty),f()(m.a.positiveNumber),f()(m.a.integer))},submit:function(){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n.$form.validate(),e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 8:return e.next=10,s();case 10:case"end":return e.stop()}},e,null,[[0,4]])}))()},onClose:function(){a()},levelFilter:function(e){return{1:"一线",2:"二线",3:"三线",4:"四线",5:"五线",6:"六线",7:"七线",8:"八线",9:"九线",10:"十线",99:"其他"}[e]||""}})}};a("bQgv");function Z(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var W={components:{Modify:Object(b.a)(z,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modify"},[a("el-form",{ref:"$form",attrs:{size:"mini",model:t.form,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"政策适用员工级别：","label-width":"165px"}},[a("el-col",{attrs:{span:6}},[a("c-select-tree",{attrs:{treeData:t.options.levelList,clearable:"",props:{value:"id",label:"levelName",children:"children"}},model:{value:t.form.position,callback:function(e){t.$set(t.form,"position",e)},expression:"form.position"}})],1),t._v(" "),a("el-col",{attrs:{span:18}},[a("span",{staticClass:"info el-icon-info"},[t._v(" 不选择表示所有人适用，每个级别只能适用一个差旅政策")])])],1),t._v(" "),a("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:"预订政策",name:"1"}},[a("el-form-item",{attrs:{label:"可用车型："}},[a("el-checkbox-group",{model:{value:t.form.policy.carLevel,callback:function(e){t.$set(t.form.policy,"carLevel",e)},expression:"form.policy.carLevel"}},t._l(t.options.carLevel,function(e){return a("el-checkbox",{key:e.key,attrs:{label:e.key}},[t._v(t._s(e.value))])}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"产品类型："}},[a("el-checkbox-group",{model:{value:t.form.policy.carServiceType,callback:function(e){t.$set(t.form.policy,"carServiceType",e)},expression:"form.policy.carServiceType"}},t._l(t.options.carServiceType,function(e){return a("el-checkbox",{key:e.key,attrs:{label:e.key}},[t._v(t._s(e.value))])}),1)],1)],1),t._v(" "),a("el-collapse-item",{staticClass:"collapse-theme1",attrs:{title:" 超标管控",name:"2"}},[a("el-form-item",{attrs:{label:"超标管理："}},[a("div",[a("el-radio",{attrs:{label:0},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("不可以超标 ( 如果违规显示价格，但不能预订)")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:1},model:{value:t.form.policy.violation,callback:function(e){t.$set(t.form.policy,"violation",e)},expression:"form.policy.violation"}},[t._v("可以超标 ，不需要审批，但需要填写超标原因，并统计在管理报告中")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"状态：",prop:"status"}},[a("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-radio",{attrs:{label:1}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("禁用")])],1)],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"padding-top text-center"},[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:t.submit}},[t._v(" 保存")]),t._v(" "),a("el-button",{attrs:{icon:"iconfont icon-close"},on:{click:t.onClose}},[t._v(" 关闭")])],1)],1)},[],!1,null,"51307e39",null).exports},name:"Car",setup:function(){var r=Object(v.e)({carModify:{visible:!1,title:"",data:{}},cityTransfer:{visible:!1,title:"",data:{}},policyList:[],options:{carServiceType:[],carLevel:[]}});r.carServiceTypeMap=Object(v.a)(function(){return r.options.carServiceType.toMap(function(e){return e.key},function(e){return e.value})});var e=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.queryList();case 2:t=e.sent,r.policyList=t.data.filter(function(e){return"CAR"===e.type}),r.policyList.forEach(function(e){e.policy=JSON.parse(e.policy)});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),t=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.getDict({type:"CAR_SERVICE_TYPE"});case 2:t=e.sent,r.options.carServiceType=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),a=function(){var e=p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.getDict({type:"CAR_LEVEL"});case 2:t=e.sent,r.options.carLevel=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return e(),t(),a(),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Z(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(r),{getQueryList:e,getCarServiceTypes:function(e){return console.log(e),(e||[]).map(function(e){return r.carServiceTypeMap[e]||""}).join(",")},getCarLevels:function(e){try{console.log(JSON.stringify(r.options.carLevel));var t=r.options.carLevel.toMap(function(e){return e.key},function(e){return e.value});return console.log(t),e.map(function(e){return t[e]||""}).join(",")}catch(e){}},onAdd:function(){r.carModify.visible=!0,r.carModify.title="新增用车差旅政策",r.carModify.data={detail:null}},onModify:function(e){r.carModify.visible=!0,r.carModify.title="修改用车差旅政策",r.carModify.data={detail:e}},remove:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.confirm("确认要删除这条政策吗？","提示",{type:"warning"});case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 9:return e.next=11,y.a.deleteById({id:a});case 11:r.policyList.splice(t,1);case 12:case"end":return e.stop()}},e,null,[[0,5]])}))()},updateStatus:function(t,a){return p()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.updateStatus({id:t,status:a});case 2:case"end":return e.stop()}},e)}))()}})}},Y=(a("6xqt"),Object(b.a)(W,function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{},[n("div",{staticClass:"margin-bottom"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:r.onAdd}},[r._v("新增")])],1),r._v(" "),n("div",{staticClass:"clearfix"},r._l(r.policyList,function(t,a){return n("el-card",{key:a,staticClass:"border-style",attrs:{shadow:"always"}},[n("el-form",{ref:"form",refInFor:!0,attrs:{"label-width":"90px",size:"mini"}},[n("el-form-item",{attrs:{label:"职务级别"}},[n("span",{staticClass:"item"},[r._v(r._s(t.positionName||"不限"))])]),r._v(" "),n("el-form-item",{attrs:{label:"可用车型"}},[n("span",{staticClass:"item"},[r._v(r._s(r.getCarLevels(t.policy.carLevel)))])]),r._v(" "),n("el-form-item",{attrs:{label:"产品类型"}},[n("span",{staticClass:"item"},[r._v(r._s(r.getCarServiceTypes(t.policy.carServiceType)))])]),r._v(" "),n("el-form-item",{attrs:{label:"是否可超标"}},[n("span",{staticClass:"item"},[r._v(r._s(0<t.policy.violation?"是":"否"))])]),r._v(" "),n("el-form-item",{attrs:{label:"状态"}},[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},on:{change:function(e){return r.updateStatus(t.id,e)}},model:{value:t.status,callback:function(e){r.$set(t,"status",e)},expression:"item.status"}})],1),r._v(" "),n("el-button",{attrs:{type:"text",title:"编辑"},on:{click:function(e){return r.onModify(t)}}},[n("i",{staticClass:"el-icon-edit-outline font-blue font-size18"})]),r._v(" "),n("el-button",{staticClass:"float-right",attrs:{type:"text",title:"删除"},on:{click:function(e){return r.remove(a,t.id)}}},[n("i",{staticClass:"el-icon-delete font-red font-size18"})])],1)],1)}),1),r._v(" "),n("el-dialog",{attrs:{title:r.carModify.title,visible:r.carModify.visible,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(e){return r.$set(r.carModify,"visible",e)}}},[r.carModify.visible?n("modify",{attrs:{data:r.carModify.data},on:{close:function(e){r.carModify.visible=!1},ok:r.getQueryList}}):r._e()],1)],1)},[],!1,null,"d2054498",null).exports),F=a("YY8R");function H(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}var J={components:{PlaneTicket:x,TrainTicket:L,Hotel:I,Car:Y},name:"TripPolicy",setup:function(){var r=Object(v.e)({form:{notice:"",type:null,id:null},activeName:"first",delivery:!0,centerDialogVisible:!1,add:!1,activeNames:["1"],airNotice:"",noticeMap:{AIR:{notice:null},TRAIN:{notice:null},HOTEL:{notice:null},CAR:{notice:null}}});return function(){var e=p()(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.queryNotice();case 2:t=e.sent,a=t.data,Object.fillInEmpty(a,"CAR",function(){return{notice:null}}),Object.assign(r.noticeMap,t.data);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()(),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?H(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(v.g)(r),{loginImg:F.a.LOGIN_LOGO,save:function(a){return p()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.form.type=a,r.form.notice=r.noticeMap[a].notice,r.form.id=r.noticeMap[a].id,e.next=5,y.a.saveNotice(r.form);case 5:t=e.sent,r.noticeMap[a].id=t.id;case 7:case"end":return e.stop()}},e)}))()}})}},G=(a("fQ0f"),Object(b.a)(J,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{attrs:{model:t.form}},[a("el-tabs",{staticClass:"tab-pane",model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{staticClass:"tabItem",attrs:{label:"国内机票差旅政策",name:"first"}},[a("div",[a("planeTicket"),t._v(" "),a("el-row",[a("el-col",{staticClass:"marginTop",attrs:{span:16}},[a("h1",{staticClass:"statement"},[t._v("政策说明 ")]),t._v("（显示在差旅预订首页提示员工）\n              "),a("el-form-item",[a("el-input",{staticClass:"elTextarea",attrs:{type:"textarea",rows:4,placeholder:"例：国内机票只能预订500公里以上行程，提前５天预订"},model:{value:t.noticeMap.AIR.notice,callback:function(e){t.$set(t.noticeMap.AIR,"notice",e)},expression:"noticeMap.AIR.notice"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:function(e){return t.save("AIR")}}},[t._v(" 保存")])],1)],1)],1)],1)]),t._v(" "),a("el-tab-pane",{staticClass:"tabItem",attrs:{label:"火车票差旅政策",name:"third"}},[a("div",[a("trainTicket"),t._v(" "),a("el-row",[a("el-col",{staticClass:"marginTop",attrs:{span:16}},[a("h1",{staticClass:"statement"},[t._v("政策说明 ")]),t._v("（显示在差旅预订首页提示员工）\n              "),a("el-form-item",[a("el-input",{staticClass:"elTextarea",attrs:{type:"textarea",rows:4,placeholder:"例： 火车票提前预订时间、退改规定以12306为准"},model:{value:t.noticeMap.TRAIN.notice,callback:function(e){t.$set(t.noticeMap.TRAIN,"notice",e)},expression:"noticeMap.TRAIN.notice"}})],1),t._v(" "),a("el-form-item",[a("easy-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:function(e){return t.save("TRAIN")}}},[t._v(" 保存")])],1)],1)],1)],1)]),t._v(" "),a("el-tab-pane",{staticClass:"tabItem",attrs:{label:"酒店差旅政策",name:"second"}},[a("div",[a("hotel"),t._v(" "),a("el-row",[a("el-col",{staticClass:"marginTop",attrs:{span:16}},[a("h1",{staticClass:"statement"},[t._v("政策说明 ")]),t._v("（显示在差旅预订首页提示员工）\n              "),a("el-form-item",[a("el-input",{staticClass:"elTextarea",attrs:{type:"textarea",rows:4,placeholder:"例： 员工超标部分费用由自己承担"},model:{value:t.noticeMap.HOTEL.notice,callback:function(e){t.$set(t.noticeMap.HOTEL,"notice",e)},expression:"noticeMap.HOTEL.notice"}})],1),t._v(" "),a("el-form-item",[a("easy-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:function(e){return t.save("HOTEL")}}},[t._v(" 保存")])],1)],1)],1)],1)]),t._v(" "),a("el-tab-pane",{staticClass:"tabItem",attrs:{label:"用车差旅政策",name:"car"}},[a("div",[a("car"),t._v(" "),a("el-row",[a("el-col",{staticClass:"marginTop",attrs:{span:16}},[a("h1",{staticClass:"statement"},[t._v("政策说明 ")]),t._v("（显示在差旅预订首页提示员工）\n              "),a("el-form-item",[a("el-input",{staticClass:"elTextarea",attrs:{type:"textarea",rows:4,placeholder:"例： 员工超标部分费用由自己承担"},model:{value:t.noticeMap.HOTEL.car,callback:function(e){t.$set(t.noticeMap.HOTEL,"car",e)},expression:"noticeMap.HOTEL.car"}})],1),t._v(" "),a("el-form-item",[a("easy-button",{attrs:{type:"primary",icon:"iconfont icon-save"},on:{click:function(e){return t.save("CAR")}}},[t._v(" 保存")])],1)],1)],1)],1)])],1)],1)],1)},[],!1,null,"4e27da51",null));t.default=G.exports},"3cYP":function(e,t,a){"use strict";var r=a("MYZe");a.n(r).a},"6xqt":function(e,t,a){"use strict";var r=a("c4Oy");a.n(r).a},LhRm:function(e,t,a){"use strict";var r=a("XczP");a.n(r).a},MYZe:function(e,t,a){},OOrr:function(e,t,a){"use strict";var r=a("by0l");a.n(r).a},Sd5M:function(e,t,a){"use strict";var r=a("rvpG");a.n(r).a},SpzA:function(e,t,a){},XczP:function(e,t,a){},bQgv:function(e,t,a){"use strict";var r=a("SpzA");a.n(r).a},by0l:function(e,t,a){},c4Oy:function(e,t,a){},fQ0f:function(e,t,a){"use strict";var r=a("xD7e");a.n(r).a},gyHC:function(e,t,a){"use strict";var r=a("tKzm");a.n(r).a},mMxj:function(e,t,a){},meKF:function(e,t,a){"use strict";var r=a("II3V");t.a={queryList:r.a.makeGet("/api/tmc/policy/queryList"),queryNotice:r.a.makeGet("/api/tmc/policy/getNotice"),save:r.a.makePost("/api/tmc/policy/save"),saveNotice:r.a.makePost("/api/tmc/policy/saveNotice"),deleteById:r.a.makePost("/api/tmc/policy/deleteById"),updateStatus:r.a.makePost("/api/tmc/policy/updateStatus")}},qEDq:function(e,t,a){"use strict";var r=a("mMxj");a.n(r).a},rvpG:function(e,t,a){},tKzm:function(e,t,a){},xD7e:function(e,t,a){}}]);