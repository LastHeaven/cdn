(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"1SN4":function(e,t,a){"use strict";var r=a("lwsE"),i=a.n(r),n=a("II3V"),s=a("tOq/");t.a=new function e(){i()(this,e),this.submit=n.a.makeJPost("/api/air/order/submit",{successW:!1,clearCaches:["/api/air/order/queryPage"]}),this.queryPage=n.a.makeGet("/api/air/order/queryPage",{expire:s.a._2S,extra:{sidx:"create_time",sord:"desc"}}),this.getInsurance=n.a.makeGet("/api/air/order/getInsurance",{expire:s.a._20S}),this.detail=n.a.makeGet("/api/air/order/detail",{failedW:!1}),this.cancel=n.a.makePost("/api/air/order/cancel",{clearCaches:["/api/air/order/queryPage"]}),this.queryIssueBillDetail=n.a.makeGet("/api/air/order/queryIssueBillDetail"),this.queryOrderStatusNum=n.a.makeGet("/api/air/order/queryOrderStatusNum")}},"4Ba0":function(e,t,a){"use strict";var r=a("KeVy");a.n(r).a},D6ud:function(e,t,a){"use strict";a.r(t);var r=a("lSNA"),i=a.n(r),n=a("o0o1"),g=a.n(n),s=a("yXPU"),h=a.n(s),o=a("RIqP"),y=a.n(o),b=a("Cd74"),_=a("1m11"),x=a("33P3"),P=a("fyny"),C=a("xGbm"),T=a("jxIu"),k=a("1SN4"),O=a("JHpf"),w=a("Q5Tz"),N=a("gV3c"),j=a("IUeo"),S=a("Lmx9"),F=a("GxGS"),L=a("sOS3"),R=a("+n12");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}function I(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach(function(e){i()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var l={name:"OrderDetail",setup:function(){var e=Object(j.a)(),t=e.costCenterId,a=e.isTongYe,r=e.userInfo,i=Object(N.a)(),n=i.route,s=i.router,o=Object(F.a)().preference,c=Object(L.a)().serviceFee,l=Object(S.a)("air").getViolationPolicyList,v=Object(b.e)({$form:{},loading:!1,showPassengerPop:!1,preference:o,serviceFee:c,costCenterId:t,isTongYe:a,userInfo:r,form:{onBusiness:"1",departDate:"",arriveDate:"",gp:"",journeyType:"OW",flightList:[],passengerList:[],contactName:"",contactPhone:"",flightClass:"N",contactEmail:"",insuranceRela:{},costCenterRela:{},violationRela:{},travelApprovalNo:"",orderType:""},options:{insuranceList:[],costCenter:[],violationReason:["陪同领导或客户","航空公司偏好","机场选择","改签或退票因素","起飞或到达时间不合适","经批准可不选择最低价","其它"]}});v.cacheId=Object(b.a)(function(){return n.query.t});var u={contactName:T.a.notEmpty,contactPhone:[].concat(y()(T.a.mobileR),y()(T.a.mobile)),contactEmail:T.a.email,required:T.a.required,notEmpty:T.a.notEmpty};v.transInsuranceList=Object(b.a)(function(){var r=v.onBusiness?c.busiInsuranceType:c.persInsuranceType,i=v.onBusiness?c.busiInsurance:c.persInsurance;return v.options.insuranceList.map(function(e,t){var a=e.id+"";return{detail:e,type:i===a?r:"3",disabled:"1"===r&&i===a}}).sort(function(e,t){return e.type>t.type?1:-1})}),v.onBusiness=Object(b.a)(function(){return"1"===v.form.onBusiness}),Object(b.h)(function(){return v.userInfo},function(e){Object(R.e)(v.form.contactPhone)&&(v.form.contactPhone=e.mobile||""),Object(R.e)(v.form.contactName)&&(v.form.contactName=e.realName||e.nickName||""),Object(R.e)(v.form.contactEmail)&&(v.form.contactEmail=e.email||"")}),Object(b.h)(function(){return v.transInsuranceList},function(e){var t=[];e.forEach(function(e){"1"!==e.type&&"2"!==e.type||t.push(e.detail.id)}),Object.keys(v.form.costCenterRela).forEach(function(e){v.form.insuranceRela[e]=Object.assign([],t)})}),Object(b.h)(function(){return v.form.passengerList},function(e){var t=e.map(function(e){return{key:e.uKey,name:e.detail.name,costCenterId:2===o.airCostCenter?e.detail.costCenterId:v.costCenterId}}),a=v.form.costCenterRela,r=v.form.insuranceRela,i={},n={},s=[];v.transInsuranceList.forEach(function(e){"1"!==e.type&&"2"!==e.type||s.push(e.detail.id)}),t.forEach(function(e){i[e.key]=a[e.key]||e.costCenterId||"",n[e.key]=r[e.key]||Object.assign([],s)}),v.form.costCenterRela=i,v.form.insuranceRela=n}),v.minAvNum=Object(b.a)(function(){var e=v.form.flightList||[];return Math.min.apply(Math,y()(e.map(function(e){return e.avNum})))}),v.roundTrip=Object(b.a)(function(){var e=v.form.flightList||[];return(e[e.length-1]||{}).roundTrip?1:0}),v.bookFlightList=Object(b.a)(function(){var e=[];if(v.roundTrip&&2===v.form.flightList.length){var t=v.form.flightList[0],a=v.form.flightList[1];e=[{logo:t.logo,airlineSN:t.airlineSN,title:t.dCityName+"-"+t.aCityName+"-"+a.aCityName,printPrice:+t.printPrice+ +a.printPrice,salePrice:+t.salePrice+ +a.salePrice,childPrintPrice:+t.childPrintPrice+ +a.childPrintPrice,childSalePrice:+t.childSalePrice+ +a.childSalePrice,oilFee:+t.oilFee+ +a.oilFee,tax:+t.tax+ +a.tax,childTax:+t.childTax+ +a.childTax,childOilFee:+t.childOilFee+ +a.childOilFee,customerProtocol:t.customerProtocol,protocolPriceFlag:t.protocolPriceFlag,gpPriceFlag:t.gpPriceFlag,productTag:t.productTag}]}else e=v.form.flightList.map(function(e){return Object.assign(e,{title:e.dCityName+"至"+e.aCityName})});return e}),v.servicePriceMap=Object(b.a)(function(){var t=v.onBusiness?"1":"0";return(v.serviceFee.amountList.filter(function(e){return e.type===t&&"AIR"===e.product})||[]).toMap(function(e){return e.productType},function(e){return e.onlineAmount})}),v.servicePrice=Object(b.a)(function(){return(v.form.flightList||[]).reduce(function(e,t){return e+v.servicePriceMap[t.productTag]||0},0)}),v.hasFreeBaggage=Object(b.a)(function(){return(v.form.flightList||[]).some(function(e){return(e.freeBaggage+"").startsWith("0")})}),v.transFlightList=Object(b.a)(function(){var s=new Date;return(v.form.flightList||[]).map(function(e){var t,a,r=C.a.parseDate(e.departureDateTime),i=C.a.parseDate(e.arriveDateTime);t=r.getFullYear()!==s.getFullYear()?C.a.getFormatDate(r,"yyyy-MM-dd hh:mm"):C.a.getFormatDate(r,"MM-dd hh:mm"),a=r.getFullYear()!==i.getFullYear()?C.a.getFormatDate(i,"yyyy-MM-dd hh:mm"):C.a.getFormatDate(r,"MM-dd")===C.a.getFormatDate(i,"MM-dd")?C.a.getFormatDate(i,"hh:mm"):C.a.getFormatDate(i,"MM-dd hh:mm");var n=C.a.getFormatDate(r,"yyyy-MM-dd 周w hh:mm")+"-"+C.a.getFormatDate(i,"hh:mm");return Object.assign({},e,{title:e.dCityName+"-"+e.aCityName,flight:e.airline+e.flightNo,model:e.dev,logo:e.logo,carrierLogo:e.carrierLogo,hasMealStr:e.hasMeal?"有餐食":"无餐食",departureDateTimeStr:t,arriveDateTimeStr:a,flightTimeStr:e.flightTimeStr,departureYear:r.getFullYear(),dCityName:e.dCityName,aCityName:e.aCityName,rangeTimeStr:n,departureTimeStr:C.a.getFormatDate(r,"hh:mm"),departureDateStr:C.a.getFormatDate(r,"yyyy-MM-dd 周w"),arriveTimeStr:C.a.getFormatDate(i,"hh:mm"),arriveDateStr:C.a.getFormatDate(i,"MM月dd日 周w"),dPortSN:(e.dPortName||"").replace("国际机场","").replace("机场",""),aPortSN:(e.aPortName||"").replace("国际机场","").replace("机场","")})})}),v.transTravelerList=Object(b.a)(function(){var l={F:"女",M:"男"},u=v.form.flightList.map(function(e){return C.a.getFormatDate(e.departureDateTime||new Date,"yyyy-MM-dd")}),d=v.options.costCenter.reduce(function(e,t){return e[t.id]=t.name,e},{});return v.form.passengerList.map(function(e){var t="",a="",r=C.a.parseDate(e.detail.birthDate||"1990/01/01"),i=u[0],n=u[u.length-1];r.setFullYear(r.getFullYear()+12);var s=C.a.getFormatDate(r,"yyyy-MM-dd"),o=!1;n<s?(a=_.a.child,t="儿童"):(a=_.a.adult,t="成人",i<s&&(o=!0));var c=v.form.costCenterRela[e.uKey];return Object.assign({birthDate:C.a.getFormatDate(e.detail.birthDate,"yyyy-MM-dd"),sexStr:l[e.detail.sex]||"",ageTypeStr:t,costCenter:c,costCenterStr:d[c]},e,{detail:Object.assign({},e.detail,{cardNo:e.detail.cardNo||"",ageType:a,showAgeWarn:o,name:e.detail.name||e.detail.firstName+"/"+e.detail.lastName})})})}),v.travelerNum=Object(b.a)(function(){var t=0,a=0;return v.transTravelerList.forEach(function(e){switch(e.detail.ageType){case _.a.adult:t++;break;case _.a.child:a++;break;default:t++}}),{adult:t,child:a}}),v.priceList=Object(b.a)(function(){var s=v.travelerNum.adult,o=v.travelerNum.child;return v.bookFlightList.map(function(e){var r=1;v.roundTrip&&(r=2);var i=[];i.push({feeType:"机票-成人",price:e.showPrice,quantity:s}),v.isTongYe&&e.saleDiscount<0&&i.push({feeType:"代理费",price:e.saleDiscount,quantity:s}),i.push({feeType:"机票-儿童",price:e.childSalePrice,quantity:o});var t=(+(e.oilFee||0)+(e.tax||0))*s+(+(e.childOilFee||0)+(e.childTax||0))*o;if(0<t&&i.push({feeType:"机建/燃油",price:t,quantity:1}),v.roundTrip)0<v.servicePrice&&i.push({feeType:"服务费",price:v.servicePrice*(s+o),quantity:1});else{var a=v.servicePriceMap[e.productTag]||0;0<a&&i.push({feeType:"服务费",price:a*(s+o),quantity:1})}var n=Object.values(v.form.insuranceRela);return v.transInsuranceList.forEach(function(t,e){var a=n.filter(function(e){return-1<e.findIndex(function(e){return e===t.detail.id})}).length*r;0<a&&i.push({feeType:t.detail.name,price:t.detail.price,quantity:a})}),i=i.filter(function(e){return 0<e.quantity}),{title:e.title,list:i,total:P.a.toFixed2(i.reduce(function(e,t){return e+t.price*t.quantity},0))}})}),v.totalPrice=Object(b.a)(function(){return v.priceList.reduce(function(e,t){return e+t.total},0)}),v.violationTravelerMap=Object(b.a)(function(){if(!v.onBusiness)return{};var n=l(v.form.flightList),s=n.find(function(e){return!e.level});return v.form.passengerList.filter(function(e){return"colleague"===e.key}).map(function(t){var e,a=n.find(function(e){return e.level===t.detail.level})||s,r=!1,i=[];return a&&(r=a.isViolation,i=a.list,e=a.violation),{uKey:t.uKey,isViolation:r,violation:e,list:i}}).filter(function(e){return e.isViolation}).reduce(function(e,t){return e[t.uKey]=t,e},{})}),Object(b.h)(function(){return v.violationTravelerMap},function(e){var t=v.form.violationRela,a={};Object.keys(e).forEach(function(e){a[e]=t[e]||{option:"",reason:""}}),v.form.violationRela=a}),v.showCostCenter=Object(b.a)(function(){return v.onBusiness&&!v.isTongYe&&0!==o.airRequiredCostCenter}),v.costCenterRules=Object(b.a)(function(){return 2===o.airRequiredCostCenter?T.a.notEmpty:[]});var d=function(){var e=h()(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.getInsurance();case 2:t=e.sent,v.options.insuranceList=t.data;case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),p=function(){var e=h()(g.a.mark(function e(){var t,a,r,i;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get({key:v.cacheId});case 2:if(t=e.sent,a=t.data){e.next=8;break}return e.next=7,s.replace("/home");case 7:return e.abrupt("return");case 8:r=Object.keys(v.form),i=JSON.parse(a),Object.assign(v.form,Object(R.h)(i,r.filter(function(e){return-1===["violationRela","costCenterRela","insuranceRela","contactName","contactPhone","contactEmail","flightClass"].indexOf(e)}))),v.form.travelApprovalNo=i.spNo||"",v.form.orderType="1"===i.gp?"2":"";case 13:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),m=function(){var e=h()(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.list();case 2:t=e.sent,v.options.costCenter=t.data||[];case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(b.h)(function(){return v.showCostCenter},function(){m()});var f=function(){var e=h()(g.a.mark(function e(){var t,m,f,a,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={OW:1,RT:2,TS:3},m=v.form.flightList,f=v.form.insuranceRela,a=I({orderSource:_.b,priceSource:m.some(function(e){return"QUNAR"===e.priceSource})?"QUNAR":"IBE"},Object(R.h)(v.form,["contactName","contactPhone","flightClass","travelApprovalNo","orderType"]),{flightWay:t[v.form.journeyType]||1,onBusiness:v.onBusiness?1:0,passengerList:v.transTravelerList.map(function(e){var t=e.detail,a=e.uKey,r=f[a].map(function(e){return{id:e,quality:m.length}}),i=0,n=0,s=0,o=0,c=0,l=0;t.ageType===_.a.child?m.forEach(function(e){n+=100*e.childPrintPrice,s+=100*e.childSalePrice,i+=100*e.childOilFee,o+=100*e.childTax,c+=100*(e.lowestPrintPrice||0),l+=100*(e.originalPrintPrice||e.childPrintPrice)}):m.forEach(function(e){n+=100*e.printPrice,s+=100*e.salePrice,i+=100*e.oilFee,o+=100*e.tax,c+=100*(e.lowestPrintPrice||0),l+=100*(e.originalPrintPrice||e.printPrice)});var u={};if("colleague"===e.key){var d=v.form.violationRela[e.uKey];d&&(u.violationReason="其它"===d.option?d.reason:d.option)}var p=t.cardList.find(function(e){return e.id===t.cardId});return Object.assign({},Object(R.h)(t,["ageType","birthDate"]),u,{cardType:p.cardType,cardNo:p.cardNo,employeeId:"colleague"===e.key?t.id:"",passengerName:t.name,passengerMobile:t.mobile||"",email:t.email||"",oilFee:i,printPrice:n,salePrice:s,lowestPrintPrice:c,originalPrintPrice:l,serviceFee:100*v.servicePrice,tax:o,gender:t.sex,insuranceList:r,costCenter:v.form.costCenterRela[e.uKey]})}),flightList:m.map(function(e){return Object.assign({},Object(R.h)(e,["airlineSN","aCity","aCityName","aPort","aPortName","aTerminal","airline","cabin","cabinClass","cabinName","cabinClassName","carrierAirline","dCity","dCityName","dPort","dPortName","dTerminal","discount","productTag"]),{onTimeRate:e.onTimeRate?e.onTimeRatePercent:e.onTimeRate,tax:100*e.tax,oilFee:100*e.oilFee,childTax:100*e.childTax,childOilFee:100*e.childOilFee,childPrintPrice:100*e.childPrintPrice,childSalePrice:100*e.childSalePrice,salePrice:100*e.salePrice,showPrice:100*e.showPrice,saleDiscount:100*e.saleDiscount,printPrice:100*e.printPrice,hasMeal:e.hasMeal?1:0,flight:e.airline+e.flightNo,takeOffTime:e.departureDateTime,arrivalTime:e.arriveDateTime,carrierFlight:(e.carrierAirline||"")+(e.carrierFlightNo||"")||null,model:e.dev,mileage:e.tpm,changePolicy:e.rebookRuleText,refundPolicy:e.refundRuleText,baggageAllowance:e.baggage,customerProtocol:e.customerProtocol,protocolPriceFlag:e.protocolPriceFlag,showProtocolPrice:e.showProtocolPrice,gpPriceFlag:e.gpPriceFlag,originalPrintPrice:100*(e.originalPrintPrice||e.printPrice),lowestPrintPrice:100*(e.lowestPrintPrice||0),stopCity:e.stopCity,stopTime:e.stopTime,priceSource:"QUNAR"===e.priceSource?"QUNAR":"IBE",vendor:"QUNAR"!==e.priceSource?null:{vppr:e.printPrice,barePrice:e.salePrice,price:e.salePrice,basePrice:e.basePrice,domain:e.domain,policyType:e.policyType,policyId:e.policyId,prtag:e.prtag,wrapperId:e.wrapperId,businessExt:e.businessExt}})}),roundTrip:v.roundTrip,total:100*v.totalPrice,serviceFee:v.servicePrice*(v.travelerNum.adult+v.travelerNum.child)*100}),e.next=6,k.a.submit(a);case 6:if(!(r=e.sent).data.success){e.next=18;break}if(x.a.success("提交成功"),1===r.data.orderId.toString().split(",").length)return e.next=12,s.replace("/air/order-detail?id=".concat(r.data.orderId));e.next=14;break;case 12:e.next=16;break;case 14:return e.next=16,s.replace("/u-center/order/air");case 16:e.next=19;break;case 18:x.a.error(r.data.errorMsg);case 19:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return function(){var e=h()(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v.loading=!0,e.prev=1,e.next=4,Promise.all([d(),p()]);case 4:return e.prev=4,v.loading=!1,e.finish(4);case 7:case"end":return e.stop()}},e,null,[[1,,4,7]])}));return function(){return e.apply(this,arguments)}}()(),I({},Object(b.g)(v),{rules:u,onAddPassenger:function(){v.showPassengerPop=!0},handleDeletePassenger:function(e){v.form.passengerList.splice(e,1)},onBack:function(){s.back()},onSubmit:function(){return h()(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===(t=v.form.passengerList.length))return x.a.warning("请选择乘机人"),e.abrupt("return");e.next=4;break;case 4:if(9<t)return x.a.warning("乘机人不能超过9人"),e.abrupt("return");e.next=7;break;case 7:if(t>v.minAvNum)return x.a.warning("余票不足"),e.abrupt("return");e.next=10;break;case 10:if(v.transTravelerList.filter(function(e){return e.detail.ageType===_.a.child}).length===t)return x.a.alert("儿童需有成人陪同，请添加同行成人乘客","提示"),e.abrupt("return");e.next=14;break;case 14:return e.prev=14,e.next=17,v.$form.validate();case 17:e.next=22;break;case 19:return e.prev=19,e.t0=e.catch(14),e.abrupt("return");case 22:if(Object.values(v.violationTravelerMap).some(function(e){return"2"===e.violation.toString()}))return e.prev=23,e.next=26,x.a.confirm("根据公司差旅政策，对于超标订单需要领导审批才可支付，您是否提交审批？",{confirmButtonText:"确 认",cancelButtonText:"暂不提交",type:"message"});e.next=31;break;case 26:e.next=31;break;case 28:return e.prev=28,e.t1=e.catch(23),e.abrupt("return");case 31:return e.next=33,f();case 33:case"end":return e.stop()}},e,null,[[14,19],[23,28]])}))()}})}},u=(a("4Ba0"),a("KHd+")),d=Object(u.a)(l,function(){var r=this,e=r.$createElement,i=r._self._c||e;return i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],ref:"$form",staticClass:"air-content padding-top air-book",attrs:{"label-width":"80px",model:r.form,rules:r.rules,size:"mini"}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:17}},[i("div",{staticClass:"bg-white z-2 margin-bottom"},[r.hasFreeBaggage?i("div",{staticClass:"bg-orange padding-tb-xs padding-lr-sm light text-sm"},[r._v("\n          行李额：无免费托运行李\n        ")]):r._e(),r._v(" "),i("div",{staticClass:"padding border-bottom flex justify-between align-center"},[i("div",{staticClass:"text-lg"},[r._v("乘机人")]),r._v(" "),i("div",{},[i("c-select-passenger",{attrs:{check:r.onBusiness&&!r.isTongYe,type:"air","flight-list":r.form.flightList,visible:r.showPassengerPop,"on-business":r.onBusiness},on:{"update:visible":function(e){r.showPassengerPop=e}},model:{value:r.form.passengerList,callback:function(e){r.$set(r.form,"passengerList",e)},expression:"form.passengerList"}},[i("el-button",{staticClass:"margin-sm-reverse padding-sm",attrs:{type:"text"}},[i("i",{staticClass:"iconfont icon-roundadd"}),r._v("\n                添加旅客\n              ")])],1)],1)]),r._v(" "),0<r.form.passengerList.length?r._l(r.form.passengerList,function(t,a){return i("div",{key:t.id,staticClass:"passenger-item"},[i("div",{staticClass:"padding-tb flex align-center"},[i("div",{staticClass:"w100 text-center"},[i("div",{staticClass:"text-center"},[i("div",{staticClass:"mark-num"},[r._v(r._s(a+1))])])]),r._v(" "),i("div",{staticClass:"flex-sub"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"乘客姓名"}},[i("span",{staticClass:"margin-right"},[r._v(r._s(r.transTravelerList[a].detail.name))]),r._v(" "),"成人"!==r.transTravelerList[a].ageTypeStr?i("el-tag",{attrs:{size:"mini"}},[r._v(r._s(r.transTravelerList[a].ageTypeStr))]):r._e()],1),r._v(" "),i("el-form-item",{attrs:{prop:"passengerList["+a+"].detail.cardId",rules:r.rules.required}},[i("template",{slot:"label"},[i("el-select",{staticClass:"more-content-select",model:{value:t.detail.cardId,callback:function(e){r.$set(t.detail,"cardId",e)},expression:"passenger.detail.cardId"}},r._l(t.detail.cardList,function(e){return i("el-option",{key:e.id,attrs:{label:e.cardTypeName,value:e.id}},[i("span",{staticClass:"padding-right",staticStyle:{float:"left"}},[r._v(r._s(e.cardTypeName))]),r._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[r._v(r._s(e.cardNo))])])}),1)],1),r._v(" "),i("el-select",{staticClass:"more-content-select w-full",model:{value:t.detail.cardId,callback:function(e){r.$set(t.detail,"cardId",e)},expression:"passenger.detail.cardId"}},r._l(t.detail.cardList,function(e){return i("el-option",{key:e.id,attrs:{label:e.cardNo,value:e.id}},[i("span",{staticClass:"padding-right",staticStyle:{float:"left"}},[r._v(r._s(e.cardTypeName))]),r._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[r._v(r._s(e.cardNo))])])}),1)],2),r._v(" "),r.onBusiness&&"colleague"===t.key?i("el-form-item",{attrs:{label:"部门"}},[r._v(r._s(t.detail.departName))]):r._e()],1),r._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"手机号码"}},[r._v(r._s(t.detail.mobile))]),r._v(" "),i("el-form-item",{attrs:{label:"邮箱号码"}},[r._v(r._s(t.detail.email))]),r._v(" "),r.showCostCenter?i("el-form-item",{attrs:{label:"成本中心",prop:"costCenterRela."+t.uKey,rules:r.costCenterRules}},[i("el-select",{model:{value:r.form.costCenterRela[t.uKey],callback:function(e){r.$set(r.form.costCenterRela,t.uKey,e)},expression:"form.costCenterRela[passenger.uKey]"}},r._l(r.options.costCenter,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1):r._e()],1)],1),r._v(" "),i("el-form-item",{attrs:{label:"保险"}},[r.form.insuranceRela[t.uKey]?i("el-checkbox-group",{model:{value:r.form.insuranceRela[t.uKey],callback:function(e){r.$set(r.form.insuranceRela,t.uKey,e)},expression:"form.insuranceRela[passenger.uKey]"}},[r._l(r.transInsuranceList,function(e){return[i("el-checkbox",{key:e.detail.id,attrs:{disabled:e.disabled,label:e.detail.id}},[i("el-popover",{attrs:{trigger:"hover"}},[i("div",{staticClass:"padding-sm",staticStyle:{width:"300px","max-height":"200px",overflow:"auto"}},[i("div",{domProps:{innerHTML:r._s(e.detail.desc)}})]),r._v(" "),i("span",{staticClass:"text-help",attrs:{slot:"reference"},slot:"reference"},[r._v("\n                            "+r._s(e.detail.name)+"\n                            "),i("i",{staticClass:"iconfont icon-info_fill"}),r._v("\n                            ¥"+r._s(e.detail.price)+"\n                          ")])])],1)]})],2):r._e()],1),r._v(" "),r.onBusiness&&!r.isTongYe?[i("el-form-item",{attrs:{label:"差旅政策"}},[r.violationTravelerMap[t.uKey]?[i("el-popover",{attrs:{title:"超标项",width:"400",trigger:"hover"}},[r._l(r.violationTravelerMap[t.uKey].list,function(e,t){return i("div",{key:t},[r._v(r._s(t+1)+"."+r._s(e.msg))])}),r._v(" "),i("span",{staticClass:"text-red text-help",attrs:{slot:"reference"},slot:"reference"},[r._v("超标")])],2)]:[i("span",{staticClass:"text-green"},[r._v("符合政策")])]],2),r._v(" "),r.violationTravelerMap[t.uKey]&&r.form.violationRela[t.uKey]?[i("div",{staticClass:"w250 inline-block",staticStyle:{"vertical-align":"top"}},[i("el-form-item",{attrs:{label:"超标原因",prop:"violationRela["+t.uKey+"].option",rules:r.rules.notEmpty}},[i("el-select",{model:{value:r.form.violationRela[t.uKey].option,callback:function(e){r.$set(r.form.violationRela[t.uKey],"option",e)},expression:"form.violationRela[passenger.uKey].option"}},r._l(r.options.violationReason,function(e){return i("el-option",{key:e,attrs:{value:e}})}),1)],1)],1),r._v(" "),i("div",{staticClass:"w300 inline-block",staticStyle:{"vertical-align":"top"}},["其它"===r.form.violationRela[t.uKey].option?i("el-form-item",{attrs:{"label-width":"0",prop:"violationRela["+t.uKey+"].reason",rules:r.rules.notEmpty}},[i("el-input",{attrs:{placeholder:"请填写超标原因"},model:{value:r.form.violationRela[t.uKey].reason,callback:function(e){r.$set(r.form.violationRela[t.uKey],"reason",e)},expression:"form.violationRela[passenger.uKey].reason"}})],1):r._e()],1)]:r._e()]:r._e()],2),r._v(" "),i("c-pop-button",{attrs:{pMsg:"确认要删除吗？",type:"text",title:"删除"},on:{click:function(e){return r.handleDeletePassenger(a)}}},[i("span",{staticClass:"font-orange text-xxl padding"},[i("i",{staticClass:"iconfont icon-delete"})])])],1)])}):i("div",{staticStyle:{"text-align":"center","line-height":"200px",height:"200px"}},[i("el-button",{staticClass:"margin-sm-reverse padding-sm text-sl",attrs:{type:"text"},on:{click:r.onAddPassenger}},[i("i",{staticClass:"el-icon-circle-plus"},[r._v("添加旅客")])])],1)],2),r._v(" "),i("div",{staticClass:"bg-white z-2 margin-bottom"},[i("div",{staticClass:"padding border-bottom"},[i("div",{staticClass:"text-lg"},[r._v("联系人")])]),r._v(" "),i("div",{staticClass:"padding"},[i("el-row",{staticClass:"margin-bottom-sm"},[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"姓名",prop:"contactName"}},[i("el-input",{model:{value:r.form.contactName,callback:function(e){r.$set(r.form,"contactName",e)},expression:"form.contactName"}})],1)],1),r._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"手机",prop:"contactPhone"}},[i("el-input",{model:{value:r.form.contactPhone,callback:function(e){r.$set(r.form,"contactPhone",e)},expression:"form.contactPhone"}})],1)],1),r._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"邮箱",prop:"contactEmail"}},[i("el-input",{model:{value:r.form.contactEmail,callback:function(e){r.$set(r.form,"contactEmail",e)},expression:"form.contactEmail"}})],1)],1)],1)],1)]),r._v(" "),i("div",{staticClass:"padding text-center margin-bottom clearfix"},[i("el-button",{staticClass:"float-left",attrs:{type:"text"},on:{click:r.onBack}},[r._v("<<返回重选")]),r._v(" "),i("easy-button",{attrs:{type:"primary",size:"lg"},on:{click:r.onSubmit}},[r._v("提交订单")])],1)]),r._v(" "),i("el-col",{attrs:{span:7}},[r._l(r.transFlightList,function(e,t){return i("div",{key:t,staticClass:"bg-flight-item light margin-bottom-sm padding z-2"},[i("div",{staticClass:"text-black"},[i("div",{staticClass:"margin-bottom-sm"},[i("img",{staticStyle:{width:"16px",height:"16px","vertical-align":"sub"},attrs:{src:e.logo}}),r._v(" "),i("span",{staticClass:"text-bold"},[r._v(r._s(e.airlineSN))]),r._v(" "),i("span",[r._v(r._s(e.airline)+r._s(e.flightNo))])]),r._v(" "),i("div",{staticClass:"margin-bottom"},[i("span",{staticClass:"text-bold"},[r._v(r._s(e.departureDateStr))]),r._v("/"+r._s(e.dCityName)+"-"+r._s(e.aCityName)+" "+r._s(e.cabinName)+"\n            "),10===Number(e.discount)?[r._v("/全价")]:[r._v("/"+r._s(Number(e.discount))+"折")]],2),r._v(" "),i("div",{staticClass:"flex align-center margin-bottom padding-bottom border-bottom"},[i("div",{staticClass:"text-right"},[i("div",{staticClass:"text-xxl text-bold"},[r._v(r._s(e.departureTimeStr))]),r._v(" "),i("div",[r._v(r._s(e.dPortSN)+r._s(e.dTerminal))])]),r._v(" "),i("div",{staticClass:"padding-sm flex-sub"},[i("div",{staticClass:"air-arrow-right"},[i("div",{staticClass:"label text-gray text-center"},[r._v(r._s(e.flightTimeStr))]),r._v(" "),i("div",{staticClass:"label-bottom text-gray text-center text-cut"},[i("span",[r._v(r._s(e.stopCity))])])])]),r._v(" "),i("div",{staticClass:"text-left"},[i("div",{staticClass:"text-xxl text-bold"},[r._v(r._s(e.arriveTimeStr))]),r._v(" "),i("div",[r._v(r._s(e.aPortSN)+r._s(e.aTerminal))])])]),r._v(" "),i("div",[i("el-popover",{attrs:{width:"400",trigger:"hover"}},[i("table",{staticClass:"flight-tip-table"},[i("tbody",[i("tr",[i("th",{attrs:{width:"80"}},[r._v("退票条件")]),r._v(" "),i("td",[r._v(r._s(e.refundRuleText))])]),r._v(" "),i("tr",[i("th",{attrs:{width:"80"}},[r._v("改签条件")]),r._v(" "),i("td",[r._v(r._s(e.rebookRuleText))])]),r._v(" "),i("tr",[i("th",{attrs:{width:"80"}},[r._v("行李额")]),r._v(" "),i("td",[r._v(r._s(e.baggage||"以航司规定为准"))])])])]),r._v(" "),i("span",{staticClass:"text-blue margin-right",staticStyle:{cursor:"help"},attrs:{slot:"reference"},slot:"reference"},[r._v("退改签&行李额说明")])]),r._v(" "),i("span",{staticClass:"margin-right"},[r._v("税费 ¥"+r._s(e.tax))]),r._v(" "),i("span",{staticClass:"margin-right"},[r._v("票价 ¥"+r._s(e.salePrice))])],1)])])}),r._v(" "),i("div",{staticClass:"bg-flight-item light text-black margin-bottom-sm padding z-2"},[i("div",{staticClass:"text-black"},[i("div",{staticClass:"flex justify-between align-center margin-bottom"},[i("div",{staticClass:"text-xxl text-bold"},[r._v("应付金额")]),r._v(" "),i("div",{staticClass:"text-orange text-bold"},[i("span",{staticClass:"text-xl"},[r._v("¥")]),i("span",{staticStyle:{"font-size":"30px"}},[r._v(r._s(r.totalPrice))])])]),r._v(" "),r._l(r.priceList,function(e,t){return i("div",{key:t},[i("div",{staticClass:"margin-bottom-sm"},[i("div",{staticClass:"flex padding-bottom-xs margin-bottom-sm justify-between align-center price-line-bottom margin-bottom-xs"},[i("div",[r._v(r._s(e.title))]),r._v(" "),i("div",[r._v("¥ "+r._s(e.total))])]),r._v(" "),r._l(e.list,function(e,t){return i("div",{key:t,staticClass:"flex margin-bottom-xs align-center"},[i("div",[r._v(r._s(e.feeType))]),r._v(" "),i("div",{staticClass:"flex-sub dashed-line margin-lr"}),r._v(" "),i("div",[i("span",[r._v("¥ "+r._s(e.price))]),r._v(" "),1<e.quantity?i("span",[r._v(" x"+r._s(e.quantity))]):r._e()])])})],2)])})],2)])],2)],1)],1)},[],!1,null,"5489acc8",null);t.default=d.exports},GxGS:function(e,t,a){"use strict";var r=a("o0o1"),i=a.n(r),n=a("yXPU"),s=a.n(n),o=a("Cd74"),c=a("9aTJ");t.a=function(){var a=Object(o.e)({airFilterTakeOffTime:0,airLimitTakeOffTime:0,airShowGp:0,airLimitMessage:"",airRequiredCostCenter:1,airCostCenter:1}),r=!1,e=function(){var e=s()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=5;break}return e.next=3,c.a.queryByCompanyId();case 3:(t=e.sent).data&&(Object.assign(a,t.data),null!==a.airRequiredCostCenter&&void 0!==a.airRequiredCostCenter||(a.airRequiredCostCenter=1),r=!0);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return e(),{preference:a,loadPreferenceSetting:e}}},JHpf:function(e,t,a){"use strict";var r=a("lwsE"),i=a.n(r),n=a("II3V");t.a=new function e(){i()(this,e),this.put=n.a.makePost("/api/cache/put",{successW:!1}),this.get=n.a.makeGet("/api/cache/get",{expire:6e4})}},KeVy:function(e,t,a){},fyny:function(e,t,a){"use strict";t.a={toFixed2:function(e){return""===e||null==e?"":+Number(e).toFixed(2)},fixed2Money:function(e){if(null==e)return"";var t=Number(String(e).replace(/,/g,"")).toFixed(2).split(".");return t[0]=t[0].replace(/(?=((?!\b)\d{3})+$)/g,","),t.join(".")}}},sOS3:function(e,t,a){"use strict";var r=a("o0o1"),i=a.n(r),n=a("yXPU"),s=a.n(n),o=a("lwsE"),c=a.n(o),l=a("II3V"),u=new function e(){c()(this,e),this.get=l.a.makeGet("/api/serviceFee/get",{failedW:!1,expire:1e4})},d=a("+n12"),p=a("Cd74");t.a=function(){var a=!1,r=Object(p.e)({busiInsuranceType:null,busiInsurance:null,persInsuranceType:null,persInsurance:null,amountList:[]});return function(){var e=s()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=6;break}return e.next=3,u.get();case 3:(t=e.sent).data&&(Object.assign(r,Object(d.h)(t.data,Object.keys(r))),r.amountList=r.amountList||[]),a=!0;case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()(),{serviceFee:r}}}}]);