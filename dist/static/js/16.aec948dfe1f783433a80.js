(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"1SN4":function(t,e,a){"use strict";var i=a("lwsE"),r=a.n(i),s=a("II3V"),n=a("tOq/");e.a=new function t(){r()(this,t),this.submit=s.a.makeJPost("/api/air/order/submit",{successW:!1,clearCaches:["/api/air/order/queryPage"]}),this.queryPage=s.a.makeGet("/api/air/order/queryPage",{expire:n.a._2S,extra:{sidx:"create_time",sord:"desc"}}),this.getInsurance=s.a.makeGet("/api/air/order/getInsurance",{expire:n.a._20S}),this.detail=s.a.makeGet("/api/air/order/detail",{failedW:!1}),this.cancel=s.a.makePost("/api/air/order/cancel",{clearCaches:["/api/air/order/queryPage"]}),this.queryIssueBillDetail=s.a.makeGet("/api/air/order/queryIssueBillDetail"),this.queryOrderStatusNum=s.a.makeGet("/api/air/order/queryOrderStatusNum")}},"6q8y":function(t,e,a){"use strict";a.d(e,"a",function(){return i}),a.d(e,"c",function(){return r}),a.d(e,"b",function(){return s});var i="/air/order-detail",r="/train/order-detail",s="/hotel/order-detail"},"7I9z":function(t,e,a){},Ik1q:function(t,e,a){},JMPG:function(t,e,a){"use strict";a.r(e);var i=a("o0o1"),l=a.n(i),r=a("yXPU"),c=a.n(r),s=a("lSNA"),u=a.n(s),m=a("1m11"),g=a("6q8y"),p=a("fyny"),v=a("eyQo"),f=a("CPkA"),n=a("kz0y"),b=a("xGbm"),_=a("+n12"),h=a("uK3i"),y=a("Cd74"),x=a("YY8R");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}var d={name:"RefundDetailDialog",props:{data:{type:Object,default:function(){return{id:""}}}},setup:function(t,e){e.emit;var a=Object(y.e)({loading:!1,visible:!0,detail:{orderId:"",refundId:"",customerStatus:"",passengerList:[],flightList:[],refundLogList:[],refundAmount:0,customerStatusName:""}});a.refundId=Object(y.a)(function(){return t.data.id}),a.statusClass=Object(y.a)(function(){return"已完成"===a.detail.customerStatusName?"text-green":""}),a.totalPrice=Object(y.a)(function(){return p.a.toFixed2((a.detail.refundAmount||0)/100)}),a.showMoney=Object(y.a)(function(){return 60===a.detail.status}),a.transFlightList=Object(y.a)(function(){var s=x.a.STATIC_PATH,n=new Date;return a.detail.flightList.map(function(t){var e,a,i=b.a.parseDate(t.takeOffTime)||n,r=b.a.parseDate(t.arrivalTime)||n;return e=i.getFullYear()!==n.getFullYear()?b.a.getFormatDate(i,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(i,"MM-dd hh:mm"),a=i.getFullYear()!==r.getFullYear()?b.a.getFormatDate(r,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(i,"MM-dd")===b.a.getFormatDate(r,"MM-dd")?b.a.getFormatDate(r,"hh:mm"):b.a.getFormatDate(r,"MM-dd hh:mm"),Object.assign({},t,{logo:"".concat(s,"/static/images/air/logo/").concat(t.airline,".png"),departureDateTimeStr:e,arriveDateTimeStr:a,dPortSN:(t.dPortName||"").replace("国际机场","").replace("机场","")})})}),a.transPassengers=Object(y.a)(function(){return a.detail.passengerList.map(function(t){return t.passengerName}).join(",")}),a.transLogList=Object(y.a)(function(){var i=new Date;return a.detail.refundLogList.map(function(t){var e="",a=b.a.parseDate(t.operateTime);return e=i.getFullYear()===a.getFullYear()?b.a.getFormatDate(a,"MM-dd hh:mm"):b.a.getFormatDate(a,"yyyy-MM-dd hh:mm"),{actionMsg:t.actionMsg,operateTimeStr:e}})});return function(){var t=c()(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.loading=!0,t.prev=1,t.next=4,h.a.detail({refundId:a.refundId});case 4:null!==(e=t.sent).data&&Object.assign(a.detail,Object(_.h)(e.data,Object.keys(a.detail)));case 6:return t.prev=6,a.loading=!1,t.finish(6);case 9:case"end":return t.stop()}},t,null,[[1,,6,9]])}));return function(){return t.apply(this,arguments)}}()(),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach(function(t){u()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(y.g)(a),{onBack:function(){a.visible=!1}})}},C=(a("L2Qx"),a("KHd+")),w=Object(C.a)(d,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("el-dialog",{attrs:{"close-on-click-modal":!1,title:"退票详情",visible:a.visible},on:{close:function(t){return a.$emit("close")},"update:visible":function(t){a.visible=t}}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"padding-lr",staticStyle:{"min-height":"400px","overflow-y":"auto"}},[i("div",{staticClass:"padding",staticStyle:{position:"relative"}},[i("div",{staticClass:"bg-white padding border-radius-xs z-2"},[a._l(a.transFlightList,function(t,e){return i("div",{key:e},[i("div",{staticClass:"flex align-center text-black text-xl margin-bottom-sm"},[i("div",{staticClass:"bg-img margin-right-xs",staticStyle:{width:"1em",height:"1em"},style:"background-image: url("+t.logo+")"}),a._v(" "),i("div",{staticClass:"text-bold"},[a._v(a._s(t.dCityName))]),a._v(" "),i("div",{staticClass:"iconfont icon-turn_right margin-lr-xs"}),a._v(" "),i("div",{staticClass:"text-bold"},[a._v(a._s(t.aCityName))])]),a._v(" "),i("div",{staticClass:"margin-bottom"},[i("div",{staticClass:"margin-bottom-xs"},[a._v(a._s(t.departureDateTimeStr)+" 至 "+a._s(t.arriveDateTimeStr))]),a._v(" "),i("div",[a._v(a._s(t.flight)+" / "+a._s(t.dPortSN)+a._s(t.dTerminal)+"出发")])])])}),a._v(" "),i("div",{staticClass:"flex align-start"},[i("div",{staticClass:"round-icon bg-grey margin-right-sm"},[i("span",{staticClass:"iconfont icon-peoplefill"})]),a._v(" "),i("div",{staticClass:"flex-sub text-lg"},[i("span",[a._v(a._s(a.transPassengers))])])])],2)]),a._v(" "),i("div",{staticClass:"padding",staticStyle:{position:"relative"}},[i("div",{staticClass:"margin-bottom flex justify-between align-center"},[i("div",[i("div",{staticClass:"text-xxl text-bold",class:a.statusClass},[a._v(a._s(a.detail.customerStatusName))]),a._v(" "),i("div",{staticClass:"text-gray"},[a._v("退票单号："+a._s(a.detail.refundId))])]),a._v(" "),i("div",{staticClass:"text-blue"},[a.showMoney?[i("span",{staticClass:"margin-right-xs"},[a._v("¥")]),a._v(" "),i("span",{staticClass:"text-xxl text-bold"},[a._v(a._s(a.totalPrice))])]:a._e()],2)]),a._v(" "),i("div",{staticClass:"timeline green text-black"},a._l(a.transLogList,function(t,e){return i("div",{key:e,staticClass:"timeline-item"},[i("div",{staticClass:"padding-bottom"},[i("div",{staticClass:"text-bold margin-bottom-xs text-lg"},[a._v(a._s(t.actionMsg))]),a._v(" "),i("div",{staticClass:"text-gray"},[a._v(a._s(t.operateTimeStr))])])])}),0)])]),a._v(" "),i("div",{staticClass:"padding text-center"},[i("el-button",{on:{click:a.onBack}},[a._v("关闭")])],1)])},[],!1,null,"223babe2",null).exports,O=a("lwsE"),D=a.n(O),k=a("II3V"),P=new function t(){D()(this,t),this.submitChangeApply=k.a.makeJPost("/api/air/change/submitChangeApply",{successW:!1}),this.detail=k.a.makeGet("/api/air/change/detail"),this.query4UserList=k.a.makeGet("/api/air/change/query4UserList"),this.cancel=k.a.makePost("/api/air/change/cancel")},j=a("33P3");function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}var N={name:"ReBookDetailDialog",props:{data:{type:Object,default:function(){return{id:""}}}},setup:function(t,e){var a=e.emit,r=Object(y.e)({visible:!0,loading:!1,showOld:!1,flight:{},form:{contactName:"",contactPhone:""},showPriceDetail:!1,detail:{changeId:"",orderId:"",status:"",passengerList:[],flightList:[],changeLogList:[],amount:0}});r.changeId=Object(y.a)(function(){return t.data.id}),r.showOper=Object(y.a)(function(){return-1<[10,20,30,50].indexOf(r.detail.status)}),r.canPay=Object(y.a)(function(){return 20===r.detail.status}),r.canCancel=Object(y.a)(function(){return 10===r.detail.status||20===r.detail.status}),r.totalPrice=Object(y.a)(function(){return p.a.toFixed2((r.detail.amount||0)/100)}),r.showMoney=Object(y.a)(function(){return 20<=r.detail.status&&r.detail.status<=50}),r.statusClass=Object(y.a)(function(){return 50===r.detail.status?"text-green":""}),r.statusStr=Object(y.a)(function(){var t=r.detail.status;return 10===t?"待确认":20===t?"待支付":20<t&&t<40?"改签中":50===t?"改签完成":60===t?"已拒绝":70===t?"已取消":"改签中"}),r.transLogList=Object(y.a)(function(){var i=new Date;return r.detail.changeLogList.map(function(t){var e="",a=b.a.parseDate(t.operateTime);return e=i.getFullYear()===a.getFullYear()?b.a.getFormatDate(a,"MM-dd hh:mm"):b.a.getFormatDate(a,"yyyy-MM-dd hh:mm"),{actionMsg:t.actionMsg,operateTimeStr:e}})}),r.transFlightList=Object(y.a)(function(){var c=x.a.STATIC_PATH,d=new Date;return r.detail.flightList.map(function(t){var e,a,i,r,s=b.a.parseDate(t.takeOffTime)||d,n=b.a.parseDate(t.newTakeOffTime)||d,o=b.a.parseDate(t.arrivalTime)||d,l=b.a.parseDate(t.newArrivalTime)||d;return e=s.getFullYear()!==d.getFullYear()?b.a.getFormatDate(s,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(s,"MM-dd hh:mm"),a=n.getFullYear()!==d.getFullYear()?b.a.getFormatDate(n,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(n,"MM-dd hh:mm"),i=s.getFullYear()!==o.getFullYear()?b.a.getFormatDate(o,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(s,"MM-dd")===b.a.getFormatDate(o,"MM-dd")?b.a.getFormatDate(o,"hh:mm"):b.a.getFormatDate(o,"MM-dd hh:mm"),r=n.getFullYear()!==l.getFullYear()?b.a.getFormatDate(l,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(n,"MM-dd")===b.a.getFormatDate(l,"MM-dd")?b.a.getFormatDate(l,"hh:mm"):b.a.getFormatDate(l,"MM-dd hh:mm"),Object.assign({},t,{logo:"".concat(c,"/static/images/air/logo/").concat(t.airline,".png"),newLogo:"".concat(c,"/static/images/air/logo/").concat(t.newAirline,".png"),departureDateTimeStr:e,newDepartureDateTimeStr:a,arriveDateTimeStr:i,newArriveDateTimeStr:r,dPortSN:(t.dPortName||"").replace("国际机场","").replace("机场",""),newDPortSN:(t.newDPortName||"").replace("国际机场","").replace("机场","")})})}),r.transPassengers=Object(y.a)(function(){return r.detail.passengerList.map(function(t){return t.passengerName}).join(",")});var i=function(){var t=c()(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r.loading=!0,t.prev=1,t.next=4,P.detail({changeId:r.changeId});case 4:null!==(e=t.sent).data&&Object.assign(r.detail,Object(_.h)(e.data,Object.keys(r.detail)));case 6:return t.prev=6,r.loading=!1,t.finish(6);case 9:case"end":return t.stop()}},t,null,[[1,,6,9]])}));return function(){return t.apply(this,arguments)}}();return i(),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach(function(t){u()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(y.g)(r),{toggleShowOld:function(){r.showOld=!r.showOld},onCancel:function(){return c()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.a.confirm("确认要取消吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"再考虑下",type:"warning"});case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:return t.prev=8,t.next=11,P.cancel({changeId:r.changeId});case 11:a("ok");case 12:return t.prev=12,t.next=15,i();case 15:return t.finish(12);case 16:case"end":return t.stop()}},t,null,[[0,5],[8,,12,16]])}))()},onPay:function(){window.open("#/main/pay?id=".concat(r.changeId,"&redirect=").concat(encodeURIComponent("".concat(g.a,"?id=").concat(r.detail.orderId))))}})}},F=(a("gX5R"),Object(C.a)(N,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("el-dialog",{attrs:{"close-on-click-modal":!1,title:"改签详情",visible:a.visible},on:{close:function(t){return a.$emit("close")},"update:visible":function(t){a.visible=t}}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"padding-lr",staticStyle:{"min-height":"400px","overflow-y":"auto"}},[i("div",{staticClass:"padding"},[a.showOld?i("div",{staticClass:"new-flight bg-white padding border-radius-xs z-2 margin-bottom"},[i("div",{staticClass:"new-flight-mark bg-grey padding-lr-sm padding-tb-xs text-sm"},[a._v("\n          旧航班\n        ")]),a._v(" "),a._l(a.transFlightList,function(t,e){return i("div",{key:e},[i("div",{staticClass:"flex align-center text-black text-xl margin-bottom-sm"},[i("div",{staticClass:"bg-img margin-right-xs",staticStyle:{width:"1em",height:"1em"},style:"background-image: url("+t.logo+")"}),a._v(" "),i("div",{staticClass:"text-bold"},[a._v(a._s(t.dCityName))]),a._v(" "),i("div",{staticClass:"iconfont icon-turn_right margin-lr-xs"}),a._v(" "),i("div",{staticClass:"text-bold"},[a._v(a._s(t.aCityName))])]),a._v(" "),i("div",[i("div",{staticClass:"margin-bottom-xs"},[a._v(a._s(t.departureDateTimeStr)+" 至 "+a._s(t.arriveDateTimeStr))]),a._v(" "),i("div",[a._v(a._s(t.cabinClassName)+" / "+a._s(t.flight)+" / "+a._s(t.dPortSN)+"出发")])])])})],2):a._e(),a._v(" "),i("div",{staticClass:"new-flight bg-white padding-top padding-lr border-radius-xs z-2"},[i("div",{staticClass:"new-flight-mark bg-blue padding-lr-sm padding-tb-xs text-sm"},[a._v("\n          新航班\n        ")]),a._v(" "),a._l(a.transFlightList,function(t,e){return i("div",{key:e},[i("div",{staticClass:"flex align-center text-black text-xl margin-bottom-sm"},[i("div",{staticClass:"bg-img margin-right-xs",staticStyle:{width:"1em",height:"1em"},style:"background-image: url("+t.newLogo+")"}),a._v(" "),i("div",{staticClass:"text-bold"},[a._v(a._s(t.newDCityName))]),a._v(" "),i("div",{staticClass:"iconfont icon-turn_right margin-lr-xs"}),a._v(" "),i("div",{staticClass:"text-bold"},[a._v(a._s(t.newACityName))])]),a._v(" "),i("div",{staticClass:"margin-bottom"},[i("div",{staticClass:"margin-bottom-xs"},[a._v(a._s(t.newDepartureDateTimeStr)+" 至 "+a._s(t.newArriveDateTimeStr))]),a._v(" "),i("div",[a._v(a._s(t.newCabinClassName)+" / "+a._s(t.newFlight)+" / "+a._s(t.newDPortSN)+a._s(t.newDTerminal)+"出发")])])])}),a._v(" "),i("div",{staticClass:"flex align-start"},[i("div",{staticClass:"round-icon bg-grey margin-right-sm"},[i("span",{staticClass:"iconfont icon-peoplefill"})]),a._v(" "),i("div",{staticClass:"flex-sub text-lg"},[i("span",[a._v(a._s(a.transPassengers))])])]),a._v(" "),i("div",{staticClass:"padding text-center cursor-pointer",on:{click:a.toggleShowOld}},[i("span",{staticClass:"iconfont",class:a.showOld?"icon-fold":"icon-unfold"})])],2)]),a._v(" "),i("div",{staticClass:"bg-white padding"},[i("div",{staticClass:"margin-bottom flex align-center justify-between"},[i("div",[i("div",{staticClass:"text-xxl text-bold",class:a.statusClass},[a._v(a._s(a.statusStr))]),a._v(" "),i("div",{staticClass:"text-gray"},[a._v("改签单号："+a._s(a.detail.changeId))])]),a._v(" "),i("div",{staticClass:"text-blue"},[a.showMoney?[i("span",{staticClass:"margin-right-xs"},[a._v("¥")]),a._v(" "),i("span",{staticClass:"text-xxl text-bold"},[a._v(a._s(a.totalPrice))])]:a._e()],2)]),a._v(" "),i("div",{staticClass:"timeline green text-black"},a._l(a.transLogList,function(t,e){return i("div",{key:e,staticClass:"timeline-item"},[i("div",{staticClass:"padding-bottom"},[i("div",{staticClass:"text-bold margin-bottom-xs text-lg"},[a._v(a._s(t.actionMsg))]),a._v(" "),i("div",{staticClass:"text-gray"},[a._v(a._s(t.operateTimeStr))])])])}),0)])]),a._v(" "),i("div",{staticClass:"padding text-center"},[i("el-button",{on:{click:function(t){a.visible=!1}}},[a._v("关闭")]),a._v(" "),a.showOper?[a.canCancel?i("easy-button",{attrs:{plain:""},on:{click:a.onCancel}},[a._v("取消改签单")]):a._e(),a._v(" "),a.canPay?i("el-button",{attrs:{type:"warning"},on:{click:a.onPay}},[a._v("支付")]):a._e()]:a._e()],2)])},[],!1,null,"625566d8",null).exports),L=a("9HTM"),T=a("gV3c"),M=a("1SN4"),I=a("eFjv");function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach(function(t){u()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var A={name:"Detail",components:{RefundDialog:n.a,RefundDetailDialog:w,RebookDetailDialog:F},setup:function(){var t=Object(T.a)(),e=t.route,a=t.router,d=Object(y.e)({loading:!1,showErr:!1,detail:{orderId:"",orderStatus:null,orderStatusName:"",onBusiness:0,flightList:[],insuranceList:[],passengerList:[],total:0,contactName:"",contactPhone:"",contactEmail:"",serviceFee:"",oilFee:0,tax:0,isIndustry:0,roundTrip:!1},refundList:[],rebookList:[],options:{cardType:[]},dialog:{tag:"",dataL:null},cityCodeMap:{},showChangeDialog:!1});d.id=Object(y.a)(function(){return e.query.id}),d.onBusiness=Object(y.a)(function(){return d.detail.onBusiness}),d.roundTrip=Object(y.a)(function(){return d.detail.roundTrip}),d.hasFreeBaggage=Object(y.a)(function(){return(d.detail.flightList||[]).some(function(t){return-1<(t.baggageAllowance+"").indexOf("免费托运行李额0KG")})}),d.bookFlightList=Object(y.a)(function(){var t=[];if(d.roundTrip&&2===d.detail.flightList.length){var e=d.detail.flightList[0],a=d.detail.flightList[1];t=[{logo:e.logo,airlineSN:e.airlineSN,title:e.dCityName+"-"+e.aCityName+"-"+a.aCityName,printPrice:+e.printPrice+ +a.printPrice,salePrice:+e.salePrice+ +a.salePrice,showPrice:+e.showPrice+ +a.showPrice,saleDiscount:+e.saleDiscount+ +a.saleDiscount,childPrintPrice:+e.childPrintPrice+ +a.childPrintPrice,childSalePrice:+e.childSalePrice+ +a.childSalePrice,oilFee:+e.oilFee+ +a.oilFee,tax:+e.tax+ +a.tax,childTax:+e.childTax+ +a.childTax,childOilFee:+e.childOilFee+ +a.childOilFee,customerProtocol:e.customerProtocol,protocolPriceFlag:e.protocolPriceFlag,gpPriceFlag:e.gpPriceFlag,showProtocolPrice:e.showProtocolPrice}]}else t=d.detail.flightList.map(function(t){return Object.assign(t,{title:t.dCityName+"至"+t.aCityName})});return t}),d.transTravelerList=Object(y.a)(function(){var t,e=d.detail.passengerList||[],a={},i={F:"女",M:"男"},r=(t={},u()(t,m.a.adult,"成人"),u()(t,m.a.child,"儿童"),u()(t,m.a.baby,"婴儿"),t);d.options.cardType.forEach(function(t){a[t.code]=t.cname});var s=d.detail.insuranceList.reduce(function(t,e){return t[e.passengerName+e.cardNo+e.type+e.supplier+e.name]=e,t},{}),n=Object.values(s);return e.map(function(e){return{detail:Object.assign({},e,{sexStr:i[e.gender]||"",cardTypeStr:a[e.cardType]||"",name:e.passengerName,ageTypeStr:r[e.ageType]}),insuranceList:n.filter(function(t){return t.passengerName===e.passengerName&&t.cardNo===e.cardNo})}})}),d.totalPrice=Object(y.a)(function(){return(d.detail.total||0)/100}),d.travelerNum=Object(y.a)(function(){var e=0,a=0,i=0,r=0,s=0,n=0,o=0,l=0;return d.transTravelerList.forEach(function(t){switch(t.detail.ageType){case m.a.adult:e++,i=t.detail.salePrice,s=t.detail.oilFee,n=t.detail.tax;break;case m.a.child:r=t.detail.salePrice,o=t.detail.oilFee,l=t.detail.tax,a++;break;default:e++}}),{adult:e,child:a,salePrice:i,childSalePrice:r,oilFee:s,tax:n,childOilFee:o,childTax:l}}),d.showInsuranceList=Object(y.a)(function(){var i={};return d.detail.insuranceList.forEach(function(t){var e="".concat(t.type,"-").concat(t.name,"-").concat(t.supplier);i[e]||(i[e]=Object.assign({remark:t.remark||"",desc:t.desc||"",count:0,price:t.price/100,travelers:[],cardNos:new Set},Object(_.h)(t,["type","name","supplier"]))),i[e].count+=t.quality;var a=t.cardNo+t.passengerName;i[e].cardNos.has(a)||(i[e].cardNos.add(a),i[e].travelers.push(t.passengerName))}),Object.values(i)}),d.priceList=Object(y.a)(function(){var s=p.a.toFixed2,t=d.detail,n=d.travelerNum.adult,o=d.travelerNum.child,l=t.serviceFee/100/d.bookFlightList.length;return d.bookFlightList.map(function(t,e){var a=1;d.roundTrip&&(a=2);var i=[];i.push({feeType:"机票-成人",price:(t.showPrice||t.salePrice)/100,quantity:n}),1===d.detail.isIndustry&&t.saleDiscount<0&&i.push({feeType:"代理费",price:t.saleDiscount/100,quantity:n}),i.push({feeType:"机票-儿童",price:t.childSalePrice/100,quantity:o});var r=((+(t.oilFee||0)+(t.tax||0))*n+(+(t.childOilFee||0)+(t.childTax||0))*o)/100;return 0<r&&i.push({feeType:"机建/燃油",price:r,quantity:1}),0<l&&i.push({feeType:"服务费",price:l,quantity:1}),d.showInsuranceList.forEach(function(t,e){i.push({feeType:t.name,price:t.price,quantity:t.travelers.length*a})}),i=i.filter(function(t){return 0<t.quantity}),E({},Object(_.h)(t,["title","issueBillId"]),{list:i,total:s(i.reduce(function(t,e){return t+e.price*e.quantity},0))})})}),d.transFlightList=Object(y.a)(function(){var l=x.a.STATIC_PATH,c=new Date;return(d.detail.flightList||[]).map(function(t){var e,a,i=b.a.parseDate(t.takeOffTime)||c,r=b.a.parseDate(t.arrivalTime)||c,s=(r.getTime()-i.getTime())/60/1e3;e=i.getFullYear()!==c.getFullYear()?b.a.getFormatDate(i,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(i,"MM-dd hh:mm"),a=i.getFullYear()!==r.getFullYear()?b.a.getFormatDate(r,"yyyy-MM-dd hh:mm"):b.a.getFormatDate(i,"MM-dd")===b.a.getFormatDate(r,"MM-dd")?b.a.getFormatDate(r,"hh:mm"):b.a.getFormatDate(r,"MM-dd hh:mm");var n="";60<s&&(n+=Math.floor(s/60)+"时",n+=s%60+"分");var o=b.a.getFormatDate(i,"yyyy-MM-dd 周w hh:mm")+"-"+b.a.getFormatDate(r,"hh:mm");return Object.assign({},t,{title:t.dCityName+"-"+t.aCityName,logo:"".concat(l,"/static/images/air/logo/").concat(t.airline,".png"),carrierLogo:"".concat(l,"/static/images/air/logo/").concat(t.carrierAirline,".png"),hasMealStr:t.hasMeal?"有餐食":"无餐食",departureDateTimeStr:e,arriveDateTimeStr:a,flightTimeStr:n,departureYear:i.getFullYear(),dCityName:(d.cityCodeMap[t.dCity]||{name:""}).name,aCityName:(d.cityCodeMap[t.aCity]||{name:""}).name,rangeTimeStr:o,departureTimeStr:b.a.getFormatDate(i,"hh:mm"),departureDateStr:b.a.getFormatDate(i,"MM月dd日 周w"),arriveTimeStr:b.a.getFormatDate(r,"hh:mm"),arriveDateStr:b.a.getFormatDate(r,"MM月dd日 周w"),dPortSN:(t.dPortName||"").replace("国际机场","").replace("机场",""),aPortSN:(t.aPortName||"").replace("国际机场","").replace("机场","")})})}),d.showBtm=Object(y.a)(function(){return!("0"===e.query.btm)}),d.showOper=Object(y.a)(function(){var t=b.a.parseDate((d.detail.flightList[0]||{takeOffTime:new Date}).takeOffTime);return!(31536e6<=Date.now()-t.getTime())&&-1<[0,10,20,30,40,60].indexOf(d.detail.orderStatus)}),d.canCancel=Object(y.a)(function(){return-1<[0,10,20,30].indexOf(d.detail.orderStatus)}),d.canPay=Object(y.a)(function(){return-1<[30].indexOf(d.detail.orderStatus)}),d.canRe=Object(y.a)(function(){return 60===d.detail.orderStatus}),d.transRefundList=Object(y.a)(function(){var s=p.a.toFixed2;return d.refundList.map(function(t){var e=t.customerStatusName,a="text-orange";"已完成"===t.customerStatusName&&(a="text-green");var i=JSON.parse(t.flights||"[]"),r=JSON.parse(t.passengers||"[]");return Object.assign({},t,{statusName:e,className:a,flightList:i,passengerNames:r.map(function(t){return t.passengerName}).join(","),showAmount:60===t.status,amountStr:s((t.refundAmount||0)/100)})})}),d.transRebookList=Object(y.a)(function(){var n=p.a.toFixed2;return d.rebookList.map(function(t){var e,a="text-orange",i=t.status;e=10===i?"改签待确认":20===i?"改签待支付":20<i&&i<40?"改签中":50===i?(a="text-green","改签完成"):60===i?"改签已拒绝":70===i?"改签已取消":"改签改签中";var r=JSON.parse(t.flights||"[]"),s=JSON.parse(t.passengers||"[]");return Object.assign({},t,{className:a,statusName:e,flightList:r,passengerNames:s.map(function(t){return t.passengerName}).join(","),showAmount:20<=t.status&&t.status<=50,amountStr:n((t.amount||0)/100)})})});function i(){r(),s(),n()}var r=function(){var t=c()(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return d.loading=!0,d.showErr=!1,t.prev=2,t.next=5,M.a.detail({orderId:d.id});case 5:e=t.sent,Object.assign(d.detail,Object(_.h)(e.data,Object.keys(d.detail))),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),console.error(t.t0),d.showErr=!0;case 13:return t.prev=13,d.loading=!1,t.finish(13);case 16:case"end":return t.stop()}},t,null,[[2,9,13,16]])}));return function(){return t.apply(this,arguments)}}(),s=function(){var t=c()(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.query4UserList({orderId:d.id});case 2:e=t.sent,d.refundList=e.data||[];case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),n=function(){var t=c()(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.query4UserList({orderId:d.id});case 2:e=t.sent,d.rebookList=e.data||[];case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),o=function(){var t=c()(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([L.a.get(),I.a.getDicts({types:"SYS_ID_CARD"})]);case 2:e=t.sent,d.cityCodeMap=e[0].codeMap,d.options.cardType=e[1].data.SYS_ID_CARD;case 5:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();Object(y.h)(function(){return d.id},function(){i()});return Object(y.c)(function(){v.a.$off(f.a.ORDER_DETAIL_REFRESH,i),v.a.$off(f.a.AIR_ORDER_DETAIL_REFRESH,i)}),o(),v.a.$on(f.a.ORDER_DETAIL_REFRESH,i),v.a.$on(f.a.AIR_ORDER_DETAIL_REFRESH,i),E({miniAppImg:"./static/images/wx_miniapp.jpg",PHONE_CALL:m.c},Object(y.g)(d),{refresh:i,onPay:function(){return c()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:window.open("#/main/pay?id=".concat(d.id,"&redirect=").concat(encodeURIComponent("".concat(g.a,"?id=").concat(d.id))));case 1:case"end":return t.stop()}},t)}))()},onCancel:function(){return c()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.a.confirm("确认要取消该订单吗？","提示",{confirmButtonText:"取消订单",cancelButtonText:"再考虑一下",type:"warning"});case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return");case 8:return t.prev=8,t.next=11,M.a.cancel({orderId:d.id});case 11:return t.prev=11,i(),t.finish(11);case 14:case"end":return t.stop()}},t,null,[[0,5],[8,,11,14]])}))()},onRebook:function(){d.showChangeDialog=!0},onRefund:function(){d.dialog.tag="RefundDialog",d.dialog.data={priceList:d.priceList}},onRefundDetail:function(t){d.dialog.tag="RefundDetailDialog",d.dialog.data={id:t}},onRebookDetail:function(t){d.dialog.tag="RebookDetailDialog",d.dialog.data={id:t}},onPayRebook:function(t){window.open("#/main/pay?id=".concat(t,"&redirect=").concat(encodeURIComponent("".concat(g.a,"?id=").concat(d.id))))},onBack:function(){a.back()}})}},B=(a("wLtC"),Object(C.a)(A,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],ref:"form",staticClass:"air-content padding-top air-book",attrs:{"label-width":"80px",size:"mini"}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:17}},[i("div",{staticClass:"bg-white z-2 margin-bottom"},[i("div",{staticClass:"padding border-bottom flex justify-between align-center"},[i("div",{staticClass:"text-lg"},[a._v("\n            订单号："+a._s(a.detail.orderId)+"\n          ")]),a._v(" "),i("div",{staticClass:"text-xxl text-bold",class:"已出票"===a.detail.orderStatusName?"text-green":"text-orange"},[a._v(a._s(a.detail.orderStatusName))])])]),a._v(" "),a._l(a.transRebookList,function(e,t){return i("div",{key:"rebook"+t,staticClass:"border-radius-xs bg-white margin-bottom-sm z-2"},[i("div",{staticClass:"flex align-center justify-between padding"},[i("div",{staticClass:"flex-sub"},[i("div",{staticClass:"text-xl margin-bottom-sm"},[i("span",{staticClass:"margin-right-sm",class:e.className},[a._v(a._s(e.statusName))]),a._v(" "),e.showAmount?i("span",{staticClass:"text-blue"},[a._v("¥"+a._s(e.amountStr))]):a._e()]),a._v(" "),i("div",{staticClass:"flex align-start margin-bottom-sm"},[i("div",{staticClass:"round-icon bg-grey margin-right-sm"},[i("span",{staticClass:"iconfont icon-planefill"})]),a._v(" "),i("div",{staticClass:"flex flex-sub text-lg"},[a._l(e.flightList,function(t,e){return[i("div",{key:e,staticClass:"margin-right"},[i("span",[a._v(a._s(t.dCityName))]),a._v(" "),i("span",{staticClass:"iconfont icon-turn_right"}),a._v(" "),i("span",[a._v(a._s(t.aCityName))])])]})],2)]),a._v(" "),i("div",{staticClass:"flex align-start"},[i("div",{staticClass:"round-icon bg-grey margin-right-sm"},[i("span",{staticClass:"iconfont icon-peoplefill"})]),a._v(" "),i("div",{staticClass:"flex-sub text-lg"},[i("span",[a._v(a._s(e.passengerNames))])])])]),a._v(" "),i("div",[i("div",[i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return a.onRebookDetail(e.changeId)}}},[a._v("查看")])],1),a._v(" "),20===e.status?i("div",{staticClass:"margin-top-xs"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return a.onPayRebook(e.changeId)}}},[a._v("支付")])],1):a._e()])])])}),a._v(" "),a._l(a.transRefundList,function(e,t){return i("div",{key:"refund"+t,staticClass:"border-radius-xs bg-white margin-bottom-sm z-2"},[i("div",{staticClass:"flex align-center justify-between padding"},[i("div",{staticClass:"flex-sub"},[i("div",{staticClass:"text-xl margin-bottom-sm"},[i("span",{staticClass:"margin-right-sm",class:e.className},[a._v(a._s(e.statusName))]),a._v(" "),e.showAmount?i("span",{staticClass:"text-blue"},[a._v("¥"+a._s(e.amountStr))]):a._e()]),a._v(" "),i("div",{staticClass:"flex align-start margin-bottom-sm"},[i("div",{staticClass:"round-icon bg-grey margin-right-sm"},[i("span",{staticClass:"iconfont icon-planefill"})]),a._v(" "),i("div",{staticClass:"flex flex-sub text-lg"},[a._l(e.flightList,function(t,e){return[i("div",{key:e,staticClass:"margin-right"},[i("span",[a._v(a._s(t.dCityName))]),a._v(" "),i("span",{staticClass:"iconfont icon-turn_right"}),a._v(" "),i("span",[a._v(a._s(t.aCityName))])])]})],2)]),a._v(" "),i("div",{staticClass:"flex align-start"},[i("div",{staticClass:"round-icon bg-grey margin-right-sm"},[i("span",{staticClass:"iconfont icon-peoplefill"})]),a._v(" "),i("div",{staticClass:"flex-sub text-lg"},[i("span",[a._v(a._s(e.passengerNames))])])])]),a._v(" "),i("div",[i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return a.onRefundDetail(e.refundId)}}},[a._v("查看")])],1)])])}),a._v(" "),i("div",{staticClass:"bg-white z-2 margin-bottom"},[a.hasFreeBaggage?i("div",{staticClass:"bg-orange padding-tb-xs padding-lr-sm light text-sm"},[a._v("\n          行李额：无免费托运行李\n        ")]):a._e(),a._v(" "),i("div",{staticClass:"padding border-bottom flex justify-between align-center"},[i("div",{staticClass:"text-lg"},[a._v("乘机人")])]),a._v(" "),a._l(a.transTravelerList,function(t,e){return i("div",{key:t.id,staticClass:"passenger-item"},[i("div",{staticClass:"padding flex align-center"},[i("div",{staticClass:"w120 text-center"},[i("div",{staticClass:"text-center"},[i("div",{staticClass:"mark-num"},[a._v(a._s(e+1))])])]),a._v(" "),i("div",{staticClass:"flex-sub"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[60===a.detail.orderStatus?i("el-form-item",{attrs:{label:"票号"}},[i("span",[a._v(a._s(t.detail.ticketNoAll))])]):a._e()],1),a._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"乘客姓名"}},[i("span",{staticClass:"margin-right"},[a._v(a._s(t.detail.name))]),a._v(" "),"成人"!==t.detail.ageTypeStr?i("el-tag",{attrs:{size:"mini"}},[a._v(a._s(t.detail.ageTypeStr))]):a._e()],1),a._v(" "),i("el-form-item",{attrs:{label:"证件"}},[i("span",[a._v(a._s(t.detail.cardTypeStr))]),a._v(" "),i("span",[a._v(a._s(t.detail.cardNo))])]),a._v(" "),a.onBusiness?i("el-form-item",{attrs:{label:"成本中心"}},[a._v("\n                      "+a._s(t.detail.costCenterName||"")+"\n                    ")]):a._e()],1),a._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"手机号码"}},[a._v(a._s(t.detail.passengerMobile))]),a._v(" "),i("el-form-item",{attrs:{label:"邮箱号码"}},[a._v(a._s(t.detail.email))])],1)],1),a._v(" "),i("el-form-item",{attrs:{label:"保险"}},a._l(t.insuranceList,function(t,e){return i("div",{key:e},[i("el-popover",{attrs:{trigger:"hover"}},[i("div",{staticClass:"padding-sm",staticStyle:{width:"300px","max-height":"200px",overflow:"auto"}},[i("div",{domProps:{innerHTML:a._s(t.desc)}})]),a._v(" "),i("span",{staticClass:"text-help",attrs:{slot:"reference"},slot:"reference"},[a._v("\n                            "+a._s(t.name)+"\n                            "),i("i",{staticClass:"iconfont icon-info"}),a._v("\n                            ¥"+a._s(t.price/100)+"\n                          ")])])],1)}),0)],1)])])})],2),a._v(" "),i("div",{staticClass:"bg-white z-2 margin-bottom"},[i("div",{staticClass:"padding border-bottom"},[i("div",{staticClass:"text-lg"},[a._v("联系人")])]),a._v(" "),i("div",{staticClass:"padding"},[i("el-row",{staticClass:"margin-bottom-sm"},[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"姓名",prop:"contactName"}},[a._v("\n                "+a._s(a.detail.contactName)+"\n              ")])],1),a._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"手机",prop:"contactPhone"}},[a._v("\n                "+a._s(a.detail.contactPhone)+"\n              ")])],1),a._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"邮箱",prop:"contactEmail"}},[a._v("\n                "+a._s(a.detail.contactEmail)+"\n              ")])],1)],1)],1)]),a._v(" "),a.showBtm?i("div",{staticClass:"padding text-center margin-bottom"},[i("el-button",{on:{click:a.onBack}},[a._v("返回")]),a._v(" "),a.showOper?[a.canPay?i("easy-button",{attrs:{type:"primary"},on:{click:a.onPay}},[a._v("去支付")]):a._e(),a._v(" "),a.canCancel?i("easy-button",{attrs:{type:""},on:{click:a.onCancel}},[a._v("取消订单")]):a._e(),a._v(" "),a.canRe?[i("easy-button",{attrs:{type:"primary"},on:{click:a.onRebook}},[a._v("申请改签")]),a._v(" "),i("easy-button",{attrs:{type:"primary"},on:{click:a.onRefund}},[a._v("申请退票")])]:a._e()]:a._e()],2):a._e()],2),a._v(" "),i("el-col",{attrs:{span:7}},[a._l(a.transFlightList,function(t,e){return i("div",{key:e,staticClass:"bg-flight-item light margin-bottom-sm padding z-2"},[i("div",{staticClass:"text-black"},[i("div",{staticClass:"margin-bottom-sm"},[i("img",{staticStyle:{width:"16px",height:"16px","vertical-align":"sub"},attrs:{src:t.logo}}),a._v(" "),i("span",{staticClass:"text-bold"},[a._v(a._s(t.airlineSN))]),a._v(" "),i("span",[a._v(a._s(t.flight))])]),a._v(" "),i("div",{staticClass:"margin-bottom"},[a._v("\n            "+a._s(t.departureDateStr)+"/"+a._s(t.dCityName)+"-"+a._s(t.aCityName)+" "+a._s(t.cabinClassName)+"\n            "),10===Number(t.discount)?[a._v("/全价")]:[a._v("/"+a._s(Number(t.discount))+"折")]],2),a._v(" "),i("div",{staticClass:"flex align-center margin-bottom padding-bottom border-bottom"},[i("div",{staticClass:"text-right"},[i("div",{staticClass:"text-xxl text-bold"},[a._v(a._s(t.departureTimeStr))]),a._v(" "),i("div",[a._v(a._s(t.dPortSN)+a._s(t.dTerminal))])]),a._v(" "),i("div",{staticClass:"padding-sm flex-sub"},[i("div",{staticClass:"air-arrow-right"},[i("div",{staticClass:"label text-gray text-center"},[a._v(a._s(t.flightTimeStr))]),a._v(" "),i("div",{staticClass:"label-bottom text-gray text-center text-cut"},[i("span",[a._v(a._s(t.stopCity))])])])]),a._v(" "),i("div",{staticClass:"text-left"},[i("div",{staticClass:"text-xxl text-bold"},[a._v(a._s(t.arriveTimeStr))]),a._v(" "),i("div",[a._v(a._s(t.aPortSN)+a._s(t.aTerminal))])])]),a._v(" "),i("div",[i("el-popover",{attrs:{width:"400",trigger:"hover"}},[i("table",{staticClass:"flight-tip-table w-full"},[i("tbody",[i("tr",[i("th",{attrs:{width:"80"}},[a._v("退票条件")]),a._v(" "),i("td",[a._v(a._s(t.refundPolicy))])]),a._v(" "),i("tr",[i("th",{attrs:{width:"80"}},[a._v("改签条件")]),a._v(" "),i("td",[a._v(a._s(t.changePolicy))])]),a._v(" "),i("tr",[i("th",{attrs:{width:"80"}},[a._v("行李额")]),a._v(" "),i("td",[a._v(a._s(t.baggageAllowance||"以航司规定为准"))])])])]),a._v(" "),i("span",{staticClass:"text-blue margin-right",staticStyle:{cursor:"help"},attrs:{slot:"reference"},slot:"reference"},[a._v("退改签&行李额说明")])])],1)])])}),a._v(" "),i("div",{staticClass:"bg-flight-item light text-black margin-bottom-sm padding z-2"},[i("div",{staticClass:"text-black"},[i("div",{staticClass:"flex justify-between align-center margin-bottom"},[i("div",{staticClass:"text-xxl text-bold"},[a._v("应付金额")]),a._v(" "),i("div",{staticClass:"text-orange text-bold"},[i("span",{staticClass:"text-xl"},[a._v("¥")]),i("span",{staticStyle:{"font-size":"30px"}},[a._v(a._s(a.totalPrice))])])]),a._v(" "),a._l(a.priceList,function(t,e){return i("div",{key:e},[i("div",{staticClass:"margin-bottom-sm"},[i("div",{staticClass:"flex padding-bottom-xs margin-bottom-sm justify-between align-center price-line-bottom margin-bottom-xs"},[i("div",[a._v(a._s(t.title))]),a._v(" "),i("div",[a._v("¥ "+a._s(t.total))])]),a._v(" "),a._l(t.list,function(t,e){return i("div",{key:e,staticClass:"flex margin-bottom-xs align-center"},[i("div",[a._v(a._s(t.feeType))]),a._v(" "),i("div",{staticClass:"flex-sub dashed-line margin-lr"}),a._v(" "),i("div",[i("span",[a._v("¥ "+a._s(t.price))]),a._v(" "),1<t.quantity?i("span",[a._v(" x"+a._s(t.quantity))]):a._e()])])})],2)])})],2)])],2)],1),a._v(" "),i(a.dialog.tag,{tag:"component",attrs:{data:a.dialog.data},on:{ok:a.refresh,close:function(t){a.dialog.tag=""}}}),a._v(" "),i("el-dialog",{attrs:{visible:a.showChangeDialog,width:"400px",title:"申请改签"},on:{"update:visible":function(t){a.showChangeDialog=t}}},[i("div",{staticClass:"margin-bottom"},[a._v("改签请在三和小程序提交操作或拨打联系电话"+a._s(a.PHONE_CALL)+"。")]),a._v(" "),i("div",{staticClass:"text-center"},[i("img",{attrs:{src:a.miniAppImg,alt:"三和商旅微信小程序"}})])])],1)},[],!1,null,"35648335",null));e.default=B.exports},L2Qx:function(t,e,a){"use strict";var i=a("7I9z");a.n(i).a},PUeJ:function(t,e,a){},fyny:function(t,e,a){"use strict";e.a={toFixed2:function(t){return""===t||null==t?"":+Number(t).toFixed(2)},fixed2Money:function(t){if(null==t)return"";var e=Number(String(t).replace(/,/g,"")).toFixed(2).split(".");return e[0]=e[0].replace(/(?=((?!\b)\d{3})+$)/g,","),e.join(".")}}},gX5R:function(t,e,a){"use strict";var i=a("PUeJ");a.n(i).a},kz0y:function(t,e,a){"use strict";var i=a("lSNA"),o=a.n(i),r=a("o0o1"),l=a.n(r),s=a("yXPU"),c=a.n(s),d=a("1m11"),u=a("jxIu"),m=a("+n12"),g=a("1SN4"),p=a("uK3i"),v=a("33P3"),f=a("Cd74");function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}var n={name:"RefundDialog",props:{data:{type:Object,default:function(){return{priceList:[]}}}},setup:function(t,e){var a=e.emit,i=e.refs,r=Object(f.e)({$step0Form:{},$step1Form:{},loading:!1,step:0,visible:!0,form:{orderSource:d.b,issueBillId:"",refundType:"1",contactName:"",contactPhone:"",psgIdList:[]},issueDetail:{passengerList:[],flightList:[],contactName:"",contactPhone:""}});r.transPassengerList=Object(f.a)(function(){return r.issueDetail.passengerList.map(function(t){return Object.assign({},t,{disabled:t.passengerStatus+""!="20"})})});var s,n=function(){var t=c()(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.queryIssueBillDetail({issueBillId:r.form.issueBillId});case 2:null!==(e=t.sent).data&&(Object.assign(r.issueDetail,Object(m.h)(e.data,Object.keys(r.issueDetail))),r.form.contactName=r.issueDetail.contactName,r.form.contactPhone=r.issueDetail.contactPhone);case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return s=t.data.priceList[0]||{issueBillId:""},r.form.issueBillId=s.issueBillId,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach(function(t){o()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(f.g)(r),{loadIssue:n,rules:{notEmpty:u.a.notEmpty},onBack:function(){r.step--},goStep1:function(){return c()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.b)();case 2:return t.prev=2,t.next=5,i.$step0Form.validate();case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(2),console.error(t.t0),t.abrupt("return");case 11:return r.step=1,r.form.psgIdList=[],t.next=15,n();case 15:case"end":return t.stop()}},t,null,[[2,7]])}))()},onSubmit:function(){return c()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===r.form.psgIdList.length)return t.next=3,v.a.alert("请选择要退票的乘客","提示");t.next=4;break;case 3:return t.abrupt("return");case 4:return t.prev=4,t.next=7,i.$step1Form.validate();case 7:t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(4),console.error(t.t0),t.abrupt("return");case 13:return t.prev=13,t.next=16,v.a.confirm("确认要提交退票申请吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"暂不提交",type:"warning"});case 16:t.next=21;break;case 18:return t.prev=18,t.t1=t.catch(13),t.abrupt("return");case 21:return t.next=23,p.a.submitRefundApply(r.form);case 23:return r.visible=!1,a("ok"),t.next=27,v.a.alert("退票单已提交成功，请等待客服确认！","提示");case 27:case"end":return t.stop()}},t,null,[[4,9],[13,18]])}))()}})}},_=a("KHd+"),h=Object(_.a)(n,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("el-dialog",{attrs:{"close-on-click-modal":!1,title:"申请退票",visible:a.visible},on:{close:function(t){return a.$emit("close")},"update:visible":function(t){a.visible=t}}},[i("div",{staticClass:"padding-lr"},[i("el-steps",{attrs:{active:a.step,"finish-status":"success",simple:""}},[i("el-step",{attrs:{title:"选择行程&原因"}}),a._v(" "),i("el-step",{attrs:{title:"选择人员"}})],1),a._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"padding-lr",staticStyle:{height:"400px","overflow-y":"auto"}},[[i("el-form",{ref:"$step0Form",staticClass:"padding-tb",attrs:{size:"mini",model:a.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"选择行程",prop:"issueBillId",rules:a.rules.notEmpty}},a._l(a.data.priceList,function(t,e){return i("div",{key:e},[i("el-radio",{attrs:{label:t.issueBillId},model:{value:a.form.issueBillId,callback:function(t){a.$set(a.form,"issueBillId",t)},expression:"form.issueBillId"}},[a._v(a._s(t.title))])],1)}),0),a._v(" "),i("el-form-item",{attrs:{label:"退票原因",prop:"refundType",rules:a.rules.notEmpty}},[i("div",[i("el-radio",{attrs:{label:"1"},model:{value:a.form.refundType,callback:function(t){a.$set(a.form,"refundType",t)},expression:"form.refundType"}},[i("el-tooltip",{attrs:{effect:"dark",placement:"right",content:"按航空公司退改规则收费"}},[i("span",[a._v("自愿退票")])])],1)],1),a._v(" "),i("div",[i("el-radio",{attrs:{label:"0"},model:{value:a.form.refundType,callback:function(t){a.$set(a.form,"refundType",t)},expression:"form.refundType"}},[i("el-tooltip",{attrs:{effect:"dark",placement:"right",content:"需等待航空公司审核"}},[i("span",[a._v("非自愿退票")])])],1)],1)])],1)],a._v(" "),1===a.step?[i("el-form",{ref:"$step1Form",staticClass:"padding-tb",attrs:{size:"mini",model:a.form}},[i("div",{staticClass:"margin-bottom"},[i("div",{staticClass:"text-lg text-bold margin-bottom-sm"},[a._v("\n              选择乘客\n            ")]),a._v(" "),i("el-form-item",{attrs:{label:"",prop:"psgIdList"}},[i("el-checkbox-group",{model:{value:a.form.psgIdList,callback:function(t){a.$set(a.form,"psgIdList",t)},expression:"form.psgIdList"}},a._l(a.transPassengerList,function(t,e){return i("div",{key:e},[i("el-checkbox",{attrs:{disabled:t.disabled,label:t.id}},[i("span",{staticClass:"margin-right"},[a._v(a._s(t.passengerName))]),a._v(" "),i("el-tag",{attrs:{size:"mini"}},[a._v(a._s(t.passengerStatusName))])],1)],1)}),0)],1)],1),a._v(" "),i("div",{staticClass:"text-lg text-bold margin-bottom-sm"},[a._v("\n            联系人信息\n          ")]),a._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"姓名",prop:"contactName",rules:a.rules.notEmpty}},[i("el-input",{staticClass:"w200",attrs:{placeholder:"联系人姓名"},model:{value:a.form.contactName,callback:function(t){a.$set(a.form,"contactName",t)},expression:"form.contactName"}})],1),a._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"电话",prop:"contactPhone",rules:a.rules.notEmpty}},[i("el-input",{staticClass:"w200",attrs:{placeholder:"联系人电话"},model:{value:a.form.contactPhone,callback:function(t){a.$set(a.form,"contactPhone",t)},expression:"form.contactPhone"}})],1)],1)]:a._e()],2)],1),a._v(" "),i("div",{staticClass:"padding text-center"},[0<a.step?i("el-button",{on:{click:a.onBack}},[a._v("上一步")]):a._e(),a._v(" "),0===a.step?i("el-button",{attrs:{type:"primary"},on:{click:a.goStep1}},[a._v("下一步")]):a._e(),a._v(" "),1===a.step?i("easy-button",{attrs:{type:"primary"},on:{click:a.onSubmit}},[a._v("提交申请")]):a._e()],1)])},[],!1,null,null,null);e.a=h.exports},uK3i:function(t,e,a){"use strict";var i=a("lwsE"),r=a.n(i),s=a("II3V");e.a=new function t(){r()(this,t),this.submitRefundApply=s.a.makeJPost("/api/air/refund/submitRefundApply",{successW:!1}),this.detail=s.a.makeGet("/api/air/refund/detail"),this.query4UserList=s.a.makeGet("/api/air/refund/query4UserList")}},wLtC:function(t,e,a){"use strict";var i=a("Ik1q");a.n(i).a}}]);