(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{qHNr:function(e,t,a){"use strict";a.r(t);var n=a("lSNA"),c=a.n(n),r=a("o0o1"),i=a.n(r),o=a("yXPU"),s=a.n(o),l=a("rQJO"),u=a("/6IM"),d=a("Cd74"),p=a("eFjv"),f=a("MCOr");function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}var y={name:"UsualPassenger",components:{SDialogAdd:l.a,SDialogEdit:u.a},setup:function(){var e={keywords:""},t=Object.assign({page:1,pageSize:10},e),o=Object(d.e)({loading:!1,searchForm:e,query:t,options:{cardType:[],travelerType:[]},tableData:{records:0,page:1,rows:[]},dialog:{tag:"",data:{id:null}}});o.optionMap=Object(d.a)(function(){return{cardType:o.options.cardType.reduce(function(e,t){return e[t.code]=t.cname,e},{})}}),o.transTableData=Object(d.a)(function(){var a={},n={},r={F:"女",M:"男"};return o.options.cardType.forEach(function(e){a[e.code]=e.cname}),o.options.travelerType.forEach(function(e){n[e.code]=e.cname}),Object.assign({},o.tableData,{rows:o.tableData.rows.map(function(e){var t="";return e.firstName&&e.lastName&&(t=e.firstName+"/"+e.lastName),Object.assign({},e,{name:e.name||t,sexStr:r[e.sex]||"",cardNo:e.cardNo||"",cardTypeStr:a[e.cardType]||"",ageTypeStr:n[e.ageType],cardList:e.cardList.map(function(e){return Object.assign({},e,{cardTypeStr:a[e.cardType]||"",cardNo:e.cardNo||""})})})})})});function n(){o.query.page=1,r()}function a(){Object.assign(o.query,o.searchForm),n()}var r=function(){var e=s()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.loading=!0,e.prev=1,e.next=4,f.a.queryPage(o.query);case 4:t=e.sent,o.tableData=t.data;case 6:return e.prev=6,o.loading=!1,e.finish(6);case 9:case"end":return e.stop()}},e,null,[[1,,6,9]])}));return function(){return e.apply(this,arguments)}}();return a(),p.a.getDicts({types:"SYS_ID_CARD,TOUR_TRAVELER_TYPE"}).then(function(e){o.options.cardType=e.data.SYS_ID_CARD,o.options.travelerType=e.data.TOUR_TRAVELER_TYPE}),function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach(function(e){c()(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},Object(d.g)(o),{firstPage:n,onSearch:a,handleSizeChange:function(e){o.query.pageSize=e},handleSortChange:function(e){var t=e.sidx,a=e.sord;o.query.sidx=t,o.query.sord=a,n()},handleCurrentChange:function(e){o.query.page=e,r()},handleDelete:function(t){return s()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.delete({id:t.id});case 2:return e.next=4,r();case 4:case"end":return e.stop()}},e)}))()},handleEdit:function(t){return s()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o.dialog.tag="SDialogEdit",o.dialog.data={id:t.id,title:"修改常旅客",detail:t};case 2:case"end":return e.stop()}},e)}))()},handleAdd:function(){return s()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o.dialog.tag="SDialogAdd",o.dialog.data={title:"新增常旅客"};case 2:case"end":return e.stop()}},e)}))()}})}},h=a("KHd+"),b=Object(h.a)(y,function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("el-card",[n("el-form",{attrs:{model:a.searchForm,inline:"",size:"mini",onkeydown:"if(event.keyCode==13){return false;}"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")?null:a.onSearch(e)}}},[n("el-form-item",{attrs:{label:"姓名"}},[n("el-input",{staticClass:"w150",attrs:{clearable:""},model:{value:a.searchForm.keywords,callback:function(e){a.$set(a.searchForm,"keywords",e)},expression:"searchForm.keywords"}})],1),a._v(" "),n("el-form-item",[n("el-button",{attrs:{icon:"el-icon-search",loading:a.loading,type:"primary"},on:{click:a.onSearch}},[a._v("查询")]),a._v(" "),n("el-button",{attrs:{icon:"el-icon-plus",loading:a.loading,type:"primary"},on:{click:a.handleAdd}},[a._v("新增")])],1)],1),a._v(" "),n("c-page-table",{attrs:{"page-size":a.query.pageSize,data:a.transTableData,loading:a.loading},on:{"size-change":a.handleSizeChange,"sort-change":a.handleSortChange,"current-change":a.handleCurrentChange}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"40"}}),a._v(" "),n("el-table-column",{attrs:{label:"操作",width:"90"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("a",{attrs:{href:"javascript:void(0)",title:"编辑"},on:{click:function(e){return a.handleEdit(t.row)}}},[a._v("编辑")]),a._v(" "),n("c-pop-button",{attrs:{size:"small",type:"text",pMsg:"确认要删除吗？"},on:{click:function(e){return a.handleDelete(t.row)}}},[a._v("删除\n        ")])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"150"},scopedSlots:a._u([{key:"default",fn:function(e){return[n("span",[a._v(a._s(e.row.name))]),a._v(" "),n("el-tag",{attrs:{size:"mini"}},[a._v(a._s(e.row.sexStr))])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"contactPhone",label:"手机",width:"120"}}),a._v(" "),n("el-table-column",{attrs:{label:"证件号","min-width":"180"},scopedSlots:a._u([{key:"default",fn:function(e){return[0<e.row.cardList.length?a._l(e.row.cardList,function(e){return n("div",{key:e.id},[a._v(a._s(e.cardTypeStr)+a._s(e.cardNo))])}):[n("span",{},[a._v("无证件信息")])]]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"ageTypeStr",label:"类型",width:"60"}})],1),a._v(" "),n(a.dialog.tag,{tag:"component",attrs:{data:a.dialog.data},on:{ok:a.firstPage,close:function(e){a.dialog.tag=""}}})],1)},[],!1,null,null,null);t.default=b.exports}}]);